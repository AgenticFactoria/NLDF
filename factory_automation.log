2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:233] - üè≠ Starting Multi-Line Factory Automation System
2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:234] -    Topic Root: yangzhi
2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:235] -    Max Orders Per Cycle: 2
2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:236] -    Production Lines: line1, line2, line3
2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:237] -    Total AGVs: 6 (2 per line)
2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:56] - Initializing Line Commanders for all production lines...
2025-07-26 21:55:47,221 - __main__ - INFO - [main.py:60] - Creating Line Commander for line1...
2025-07-26 21:55:47,221 - shared_order_manager - INFO - [shared_order_manager.py:38] - SharedOrderManager initialized
2025-07-26 21:55:47,226 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for station_status
2025-07-26 21:55:47,226 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for agv_status
2025-07-26 21:55:47,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for conveyor_status
2025-07-26 21:55:47,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for warehouse_status
2025-07-26 21:55:47,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for alerts
2025-07-26 21:55:47,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for orders
2025-07-26 21:55:47,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for responses
2025-07-26 21:55:47,227 - __main__ - INFO - [main.py:65] - ‚úÖ Line Commander for line1 created successfully
2025-07-26 21:55:47,227 - __main__ - INFO - [main.py:60] - Creating Line Commander for line2...
2025-07-26 21:55:47,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for station_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for agv_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for conveyor_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for warehouse_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for alerts
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for orders
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for responses
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:65] - ‚úÖ Line Commander for line2 created successfully
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:60] - Creating Line Commander for line3...
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for station_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for agv_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for conveyor_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for warehouse_status
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for alerts
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for orders
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for responses
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:65] - ‚úÖ Line Commander for line3 created successfully
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:71] - üéâ All 3 Line Commanders initialized successfully
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:77] - Starting operations for all production lines...
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:84] - Starting operations for line1...
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:90] - ‚úÖ line1 operations started
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:84] - Starting operations for line2...
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:90] - ‚úÖ line2 operations started
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:84] - Starting operations for line3...
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:90] - ‚úÖ line3 operations started
2025-07-26 21:55:47,228 - __main__ - INFO - [main.py:96] - üöÄ All 3 production lines are now operational!
2025-07-26 21:55:47,228 - src.line_commander - INFO - [line_commander.py:295] - Starting Line Commander for line1
2025-07-26 21:55:47,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:93] - Starting MQTT listener manager...
2025-07-26 21:55:47,228 - src.utils.mqtt_client - INFO - [mqtt_client.py:62] - Connecting to MQTT Broker at supos-ce-instance4.supos.app:1883...
2025-07-26 21:55:47,350 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/station/+/status
2025-07-26 21:55:47,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:112] - Subscribed to station status: yangzhi/line1/station/+/status
2025-07-26 21:55:47,350 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/agv/+/status
2025-07-26 21:55:47,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:117] - Subscribed to AGV status: yangzhi/line1/agv/+/status
2025-07-26 21:55:47,350 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/conveyor/+/status
2025-07-26 21:55:47,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:122] - Subscribed to conveyor status: yangzhi/line1/conveyor/+/status
2025-07-26 21:55:47,350 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/warehouse/RawMaterial/status
2025-07-26 21:55:47,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:127] - Subscribed to Rawmaterial warehouse status: yangzhi/warehouse/RawMaterial/status
2025-07-26 21:55:47,350 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/alerts
2025-07-26 21:55:47,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:132] - Subscribed to alerts: yangzhi/line1/alerts
2025-07-26 21:55:47,351 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/orders/status
2025-07-26 21:55:47,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:137] - Subscribed to orders: yangzhi/orders/status
2025-07-26 21:55:47,351 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/response/line1
2025-07-26 21:55:47,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:142] - Subscribed to responses: yangzhi/response/line1
2025-07-26 21:55:47,351 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/kpi/status
2025-07-26 21:55:47,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:147] - Subscribed to KPI: yangzhi/kpi/status
2025-07-26 21:55:47,351 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/result/status
2025-07-26 21:55:47,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:152] - Subscribed to results: yangzhi/result/status
2025-07-26 21:55:47,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:100] - MQTT listener manager started successfully
2025-07-26 21:55:47,351 - src.line_commander - INFO - [line_commander.py:295] - Starting Line Commander for line2
2025-07-26 21:55:47,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:93] - Starting MQTT listener manager...
2025-07-26 21:55:47,351 - src.utils.mqtt_client - INFO - [mqtt_client.py:62] - Connecting to MQTT Broker at supos-ce-instance4.supos.app:1883...
2025-07-26 21:55:47,462 - src.utils.mqtt_client - INFO - [mqtt_client.py:31] - Successfully connected to MQTT Broker at supos-ce-instance4.supos.app:1883
2025-07-26 21:55:47,911 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line2/station/+/status
2025-07-26 21:55:47,912 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:112] - Subscribed to station status: yangzhi/line2/station/+/status
2025-07-26 21:55:47,912 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line2/agv/+/status
2025-07-26 21:55:47,912 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:117] - Subscribed to AGV status: yangzhi/line2/agv/+/status
2025-07-26 21:55:47,912 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line2/conveyor/+/status
2025-07-26 21:55:47,912 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:122] - Subscribed to conveyor status: yangzhi/line2/conveyor/+/status
2025-07-26 21:55:47,912 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/warehouse/RawMaterial/status
2025-07-26 21:55:47,913 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:127] - Subscribed to Rawmaterial warehouse status: yangzhi/warehouse/RawMaterial/status
2025-07-26 21:55:47,913 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line2/alerts
2025-07-26 21:55:47,913 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:132] - Subscribed to alerts: yangzhi/line2/alerts
2025-07-26 21:55:47,913 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/orders/status
2025-07-26 21:55:47,913 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:137] - Subscribed to orders: yangzhi/orders/status
2025-07-26 21:55:47,913 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/response/line2
2025-07-26 21:55:47,913 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:142] - Subscribed to responses: yangzhi/response/line2
2025-07-26 21:55:47,913 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/kpi/status
2025-07-26 21:55:47,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:147] - Subscribed to KPI: yangzhi/kpi/status
2025-07-26 21:55:47,914 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/result/status
2025-07-26 21:55:47,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:152] - Subscribed to results: yangzhi/result/status
2025-07-26 21:55:47,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:100] - MQTT listener manager started successfully
2025-07-26 21:55:47,914 - src.line_commander - INFO - [line_commander.py:295] - Starting Line Commander for line3
2025-07-26 21:55:47,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:93] - Starting MQTT listener manager...
2025-07-26 21:55:47,914 - src.utils.mqtt_client - INFO - [mqtt_client.py:62] - Connecting to MQTT Broker at supos-ce-instance4.supos.app:1883...
2025-07-26 21:55:48,025 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/station/+/status
2025-07-26 21:55:48,025 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:112] - Subscribed to station status: yangzhi/line3/station/+/status
2025-07-26 21:55:48,026 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/agv/+/status
2025-07-26 21:55:48,026 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:117] - Subscribed to AGV status: yangzhi/line3/agv/+/status
2025-07-26 21:55:48,026 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/conveyor/+/status
2025-07-26 21:55:48,026 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:122] - Subscribed to conveyor status: yangzhi/line3/conveyor/+/status
2025-07-26 21:55:48,026 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/warehouse/RawMaterial/status
2025-07-26 21:55:48,026 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:127] - Subscribed to Rawmaterial warehouse status: yangzhi/warehouse/RawMaterial/status
2025-07-26 21:55:48,026 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/alerts
2025-07-26 21:55:48,026 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:132] - Subscribed to alerts: yangzhi/line3/alerts
2025-07-26 21:55:48,027 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/orders/status
2025-07-26 21:55:48,027 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:137] - Subscribed to orders: yangzhi/orders/status
2025-07-26 21:55:48,027 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/response/line3
2025-07-26 21:55:48,027 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:142] - Subscribed to responses: yangzhi/response/line3
2025-07-26 21:55:48,027 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/kpi/status
2025-07-26 21:55:48,027 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:147] - Subscribed to KPI: yangzhi/kpi/status
2025-07-26 21:55:48,027 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/result/status
2025-07-26 21:55:48,027 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:152] - Subscribed to results: yangzhi/result/status
2025-07-26 21:55:48,027 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:100] - MQTT listener manager started successfully
2025-07-26 21:55:48,028 - __main__ - INFO - [main.py:102] - Starting line monitoring...
2025-07-26 21:55:48,028 - src.line_commander - INFO - [line_commander.py:331] - Starting reactive decision processor for line1...
2025-07-26 21:55:48,028 - src.line_commander - INFO - [line_commander.py:331] - Starting reactive decision processor for line2...
2025-07-26 21:55:48,028 - src.line_commander - INFO - [line_commander.py:331] - Starting reactive decision processor for line3...
2025-07-26 21:55:48,327 - src.utils.mqtt_client - INFO - [mqtt_client.py:31] - Successfully connected to MQTT Broker at supos-ce-instance4.supos.app:1883
2025-07-26 21:55:48,429 - src.utils.mqtt_client - INFO - [mqtt_client.py:31] - Successfully connected to MQTT Broker at supos-ce-instance4.supos.app:1883
2025-07-26 21:55:57,437 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_b99df2b2', 'created_at': 20.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 620.0}
2025-07-26 21:55:57,438 - order - INFO - [order.py:245] - Created order order_b99df2b2 with 1 products
2025-07-26 21:55:57,438 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_b99df2b2', 'created_at': 20.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 620.0}
2025-07-26 21:55:57,438 - order - INFO - [order.py:339] - Assigned 1 products from order order_b99df2b2 to line1
2025-07-26 21:55:57,439 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_b99df2b2 with 1 products to line1
2025-07-26 21:55:57,439 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 3, 'completed_orders': 0, 'active_orders': 3, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:55:57,649 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 3, 'completed_orders': 0, 'active_orders': 3, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:55:57,650 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7eb00005', 'created_at': 20.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 21:55:57,650 - order - INFO - [order.py:245] - Created order order_7eb00005 with 1 products
2025-07-26 21:55:57,650 - order - INFO - [order.py:339] - Assigned 1 products from order order_7eb00005 to line2
2025-07-26 21:55:57,650 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_7eb00005 with 1 products to line2
2025-07-26 21:55:57,771 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 4, 'completed_orders': 0, 'active_orders': 4, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:55:57,974 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_b99df2b2', 'created_at': 20.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 620.0}
2025-07-26 21:55:57,975 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 3, 'completed_orders': 0, 'active_orders': 3, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:55:58,030 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:55:58,030 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2']
2025-07-26 21:55:58,031 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:55:58,032 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: []
2025-07-26 21:55:58,032 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:55:58,032 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2']
2025-07-26 21:55:58,286 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7eb00005', 'created_at': 20.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 21:55:58,288 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7eb00005', 'created_at': 20.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 21:55:58,288 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 4, 'completed_orders': 0, 'active_orders': 4, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:55:58,288 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 4, 'completed_orders': 0, 'active_orders': 4, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:02,046 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:02,940 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
Both AGVs are available and there are no required actions at this time‚Äîno finished products waiting, no raw material ready, no critical battery level, and all stations/conveyors are idle. As per decision priorities and the current status, there is no command required for either AGV at this moment.'
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 318
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs are available and there are no required actions at this time‚Äîno finished products waiting, no raw material ready, no critical battery level, and all stations/conveyors ar...'
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 4, Finished products: 0
2025-07-26 21:56:02,941 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:02,941 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: []
2025-07-26 21:56:03,733 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240628_agv1", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}}
]

Explanation:
Both AGV_1 and AGV_2 are available and all batteries are at normal level, with all stations idle and no finished or P3 buffer products to handle. According to the workflow and decision logic, the highest action needed is to start a new production cycle by sending an AGV to pick up the raw material. The action needed is for raw material (next: prod_2_f60057dd). The first required step is to MOVE an available AGV (here, AGV_1) to P0 (RawMaterial warehouse). If there were two actions needed, both AGVs would be assigned simultaneously, but only one is required per the request.'
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 702
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240628_agv1", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}}
]

Explanation:
Both AGV_1 and AGV_2 are available and all batteries are at normal level, wit...'
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240628_agv1", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}}
]'
2025-07-26 21:56:03,737 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:03,737 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:03,737 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:03,737 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538163.737738}
2025-07-26 21:56:03,738 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1 - move for AGV_1
2025-07-26 21:56:03,839 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:03,840 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2']
2025-07-26 21:56:04,263 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:05,056 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:56:05,312 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
Both AGVs are available, but there are currently no actions required according to the status provided: no products to move, load, or unload; no battery emergencies; no raw materials available for pick-up. As such, no commands are needed at this time.'
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 270
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs are available, but there are currently no actions required according to the status provided: no products to move, load, or unload; no battery emergencies; no raw material...'
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:56:05,314 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 4, Finished products: 0
2025-07-26 21:56:05,315 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:05,315 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: []
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240624_agv1_startmoveP0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

**Explanation:**  
Both AGVs are available, but only 1 action is needed per request. The high-priority action is to start a new production with available raw materials. The next raw material to be processed is prod_2_f60057dd. According to the workflow, the AGV must first move to the raw material warehouse (P0) before sending any load command. Therefore, AGV_1 is sent to P0 to prepare for loading the specified product. AGV_2 remains available for future commands or actions.'
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 597
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240624_agv1_startmoveP0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

**Explanation:**  
Both AGVs are available, but only 1 action is needed per reque...'
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240624_agv1_startmoveP0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]'
2025-07-26 21:56:06,044 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:06,044 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:06,045 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:06,045 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_agv1_startmoveP0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538166.045088}
2025-07-26 21:56:06,045 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_agv1_startmoveP0 - move for AGV_1
2025-07-26 21:56:06,146 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:06,147 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2']
2025-07-26 21:56:06,566 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:06,667 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}}]

Explanation:  
Both AGVs are available with no battery or emergency needs, and no finished or P3 products needing transport. The highest decision priority is to start processing raw materials for the next product (prod_2_f60057dd). The correct first step is to MOVE an available AGV (AGV_1 in this case) to the RawMaterial warehouse (P0) to prepare for loading. Only one command is needed per the request, so AGV_1 is dispatched for raw material collection as required by the process sequence.'
2025-07-26 21:56:06,668 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:06,668 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 599
2025-07-26 21:56:06,668 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}}]

Explanation:  
Both AGVs are available with no battery or emergency needs, and no finished or ...'
2025-07-26 21:56:06,668 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:06,668 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}}]'
2025-07-26 21:56:06,668 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:06,668 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:06,669 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:06,669 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538166.669098}
2025-07-26 21:56:06,669 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1 - move for AGV_1
2025-07-26 21:56:06,770 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:06,771 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2']
2025-07-26 21:56:07,310 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:07,430 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
Both AGVs are available, but there are no production, transfer, or charging actions required at present‚Äîthere are no products to move or process, no raw materials to collect, no battery charging needed, and all equipment is idle. Therefore, no commands are issued at this time.'
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 297
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs are available, but there are no production, transfer, or charging actions required at present‚Äîthere are no products to move or process, no raw materials to collect, no ba...'
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 4, Finished products: 0
2025-07-26 21:56:07,431 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:07,431 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: []
2025-07-26 21:56:07,737 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_994b0dda', 'created_at': 30.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 630.0}
2025-07-26 21:56:07,737 - order - INFO - [order.py:245] - Created order order_994b0dda with 1 products
2025-07-26 21:56:07,737 - order - INFO - [order.py:339] - Assigned 1 products from order order_994b0dda to line3
2025-07-26 21:56:07,737 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_994b0dda with 1 products to line3
2025-07-26 21:56:07,737 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 5, 'completed_orders': 0, 'active_orders': 5, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:07,764 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_994b0dda', 'created_at': 30.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 630.0}
2025-07-26 21:56:07,764 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 5, 'completed_orders': 0, 'active_orders': 5, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:07,768 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_994b0dda', 'created_at': 30.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 630.0}
2025-07-26 21:56:07,768 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 5, 'completed_orders': 0, 'active_orders': 5, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:07,802 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_640057ad', 'created_at': 30.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 350.0}
2025-07-26 21:56:07,803 - order - INFO - [order.py:245] - Created order order_640057ad with 1 products
2025-07-26 21:56:07,803 - order - INFO - [order.py:339] - Assigned 1 products from order order_640057ad to line1
2025-07-26 21:56:07,803 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_640057ad with 1 products to line1
2025-07-26 21:56:07,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:09,184 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:56:09,249 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_640057ad', 'created_at': 30.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 350.0}
2025-07-26 21:56:09,249 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:09,888 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_640057ad', 'created_at': 30.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 350.0}
2025-07-26 21:56:09,889 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:10,232 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:12,488 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 35.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.49, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.9, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:12,489 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 35.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.49, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.9, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:13,378 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 35.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.49, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.9, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:15,248 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:17,051 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
Currently, there are no pending actions required for either AGV (no charging, finished products, P3 upper_buffer, or raw materials). All stations and conveyors are idle. According to the decision logic, no commands are needed at this time, so no action is taken.'
2025-07-26 21:56:17,051 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:17,051 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 282
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
Currently, there are no pending actions required for either AGV (no charging, finished products, P3 upper_buffer, or raw materials). All stations and conveyors are idle. According ...'
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:56:17,052 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 4, Finished products: 0
2025-07-26 21:56:17,052 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:17,053 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2']
2025-07-26 21:56:17,379 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 35.949999, 'command_id': 'flow_20240628_agv1', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 21:56:17,380 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 21:56:17,574 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e7d3a3cf', 'created_at': 40.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1720.0}
2025-07-26 21:56:17,574 - order - INFO - [order.py:245] - Created order order_e7d3a3cf with 3 products
2025-07-26 21:56:17,574 - order - INFO - [order.py:339] - Assigned 3 products from order order_e7d3a3cf to line2
2025-07-26 21:56:17,574 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_e7d3a3cf with 3 products to line2
2025-07-26 21:56:17,694 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e7d3a3cf', 'created_at': 40.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1720.0}
2025-07-26 21:56:17,696 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.24, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 7, 'completed_orders': 0, 'active_orders': 7, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:17,696 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e7d3a3cf', 'created_at': 40.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1720.0}
2025-07-26 21:56:17,697 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.24, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 7, 'completed_orders': 0, 'active_orders': 7, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:17,814 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_29ad708a', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1870.0}
2025-07-26 21:56:17,814 - order - INFO - [order.py:245] - Created order order_29ad708a with 3 products
2025-07-26 21:56:17,815 - order - INFO - [order.py:339] - Assigned 3 products from order order_29ad708a to line3
2025-07-26 21:56:17,815 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_29ad708a with 3 products to line3
2025-07-26 21:56:17,815 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.24, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:17,918 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_29ad708a', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1870.0}
2025-07-26 21:56:17,919 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.24, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:18,201 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.24, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 7, 'completed_orders': 0, 'active_orders': 7, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:18,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_29ad708a', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1870.0}
2025-07-26 21:56:18,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.24, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:18,621 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 41.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 3.88, 'first_pass_rate': 0.0, 'total_production_cost': 3.58, 'material_costs': 0.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.33, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:19,217 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 41.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 3.88, 'first_pass_rate': 0.0, 'total_production_cost': 3.58, 'material_costs': 0.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.33, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:20,001 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 41.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 3.88, 'first_pass_rate': 0.0, 'total_production_cost': 3.58, 'material_costs': 0.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.33, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:21,923 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 41.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.82, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.0, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:21,924 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 41.949999, 'command_id': 'flow_20240624_agv1_startmoveP0', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 21:56:21,924 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_agv1_startmoveP0 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 21:56:22,293 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 41.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.82, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.0, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:22,624 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 41.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.82, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.0, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:22,625 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 41.949999, 'command_id': 'flow_20240628_agv1', 'response': 'Successfully arrived at path point P0, remaining battery: 45.4%'}
2025-07-26 21:56:22,625 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1 response: Successfully arrived at path point P0, remaining battery: 45.4%
2025-07-26 21:56:23,437 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:24,917 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]

Explanation:  
There is one raw material available (prod_2_f60057dd). According to the decision priorities, raw material pickup is a high priority. Since both AGVs are available and no other urgent tasks are present, AGV_1 is instructed to move to the RawMaterial warehouse (P0) to begin the process. The next command after this move completes will be to load the specific product_id ("prod_2_f60057dd").'
2025-07-26 21:56:24,918 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:24,918 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 515
2025-07-26 21:56:24,918 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]

Explanation:  
There is one raw material available (prod_2_f60057dd). According to the de...'
2025-07-26 21:56:24,918 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:24,918 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]'
2025-07-26 21:56:24,918 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:24,918 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:24,918 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:24,919 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538184.918783}
2025-07-26 21:56:24,919 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P0 - move for AGV_1
2025-07-26 21:56:25,020 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:25,020 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2']
2025-07-26 21:56:26,276 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:26,491 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2", "action":"move", "target":"AGV_2", "params":{"target_point":"P0"}}]

Explanation:  
AGV_1 is currently moving and not at the required point, making it unavailable for a new command. AGV_2 is available (startup status). The action needed is to start a new production cycle by picking up raw materials (prod_2_f60057dd). According to priority, the correct command is to MOVE AGV_2 to the RawMaterial warehouse (P0) to prepare for loading the specific raw material. Only one command per available AGV, so AGV_2 is sent for this task.'
2025-07-26 21:56:26,491 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:26,491 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 567
2025-07-26 21:56:26,491 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2", "action":"move", "target":"AGV_2", "params":{"target_point":"P0"}}]

Explanation:  
AGV_1 is currently moving and not at the required point, making it unavailable ...'
2025-07-26 21:56:26,492 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:26,492 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2", "action":"move", "target":"AGV_2", "params":{"target_point":"P0"}}]'
2025-07-26 21:56:26,492 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:26,492 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:26,492 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:26,492 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753538186.492468}
2025-07-26 21:56:26,492 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2 - move for AGV_2
2025-07-26 21:56:26,594 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:26,594 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2']
2025-07-26 21:56:27,760 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:27,764 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_20240618_move_AGV2_P0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:  
Both AGVs are available and multiple raw materials are ready for pickup. According to the workflow and decision logic, moving each AGV to the RawMaterial warehouse (P0) is the correct first action. Upon completion of these moves, each AGV can be commanded to load one of the available raw materials by specifying the relevant product IDs. This maximizes throughput and prepares the line for starting new production batches.'
2025-07-26 21:56:27,764 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:27,765 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 664
2025-07-26 21:56:27,765 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_20240618_move_AGV2_P0","action":"move","target":"AGV_2","params":...'
2025-07-26 21:56:27,765 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:27,765 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_20240618_move_AGV2_P0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 21:56:27,765 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:56:27,765 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line3
2025-07-26 21:56:27,765 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line3
2025-07-26 21:56:27,765 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538187.765431}
2025-07-26 21:56:27,765 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P0 - move for AGV_1
2025-07-26 21:56:27,867 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV2_P0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753538187.86704}
2025-07-26 21:56:27,867 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV2_P0 - move for AGV_2
2025-07-26 21:56:27,969 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:27,969 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2']
2025-07-26 21:56:28,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_2a874516', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 690.0}
2025-07-26 21:56:28,155 - order - INFO - [order.py:245] - Created order order_2a874516 with 2 products
2025-07-26 21:56:28,156 - order - INFO - [order.py:339] - Assigned 2 products from order order_2a874516 to line1
2025-07-26 21:56:28,156 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_2a874516 with 2 products to line1
2025-07-26 21:56:28,582 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_2a874516', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 690.0}
2025-07-26 21:56:28,882 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:29,107 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_2a874516', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 690.0}
2025-07-26 21:56:29,633 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is currently idle and already at P0 (RawMaterial warehouse) with no current load, making it available to load raw material. According to the workflow, the next action is to load the specific raw material for the next production order (prod_2_f60057dd). Only one command is required and AGV_1 is optimally positioned for it, so the LOAD command is issued for prod_2_f60057dd. AGV_2 remains available for parallel or future tasks.'
2025-07-26 21:56:29,633 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:29,633 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 571
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is currently idle and already at P0 (RawMaterial warehous...'
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]'
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:29,634 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:29,634 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:29,634 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_f60057dd'}, 'timestamp': 1753538189.634355}
2025-07-26 21:56:29,634 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_loadprod2f60057dd","action":"load","target":"AGV_1","params":{"product_id":"prod_2_f60057dd"}}]

**Explanation:**  
AGV_1 is now at P0 and ready to load raw material. The next logical step is to issue a load command for the available raw material, specifying the required product_id ("prod_2_f60057dd") per the instructions. AGV_2 remains idle as only one action is allowed per request and no higher-priority tasks exist.'
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 451
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_loadprod2f60057dd","action":"load","target":"AGV_1","params":{"product_id":"prod_2_f60057dd"}}]

**Explanation:**  
AGV_1 is now at P0 and ready to load raw material. The...'
2025-07-26 21:56:29,634 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:29,635 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_loadprod2f60057dd","action":"load","target":"AGV_1","params":{"product_id":"prod_2_f60057dd"}}]'
2025-07-26 21:56:29,635 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:29,635 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:29,635 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:29,635 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_loadprod2f60057dd', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_f60057dd'}, 'timestamp': 1753538189.63521}
2025-07-26 21:56:29,635 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_loadprod2f60057dd - load for AGV_1
2025-07-26 21:56:29,735 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:29,736 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2']
2025-07-26 21:56:29,736 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:29,736 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1']
2025-07-26 21:56:30,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.88, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.85, 'total_orders': 9, 'completed_orders': 0, 'active_orders': 9, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:30,156 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.88, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.85, 'total_orders': 9, 'completed_orders': 0, 'active_orders': 9, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:30,156 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.88, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.85, 'total_orders': 9, 'completed_orders': 0, 'active_orders': 9, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:30,384 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]

Explanation:  
There is an action needed: raw materials are available for pickup, and both AGVs are available. Following the decision logic (priority 4), the next step is to move one of the AGVs to the RawMaterial warehouse (P0). Only one action is needed, so AGV_1 is commanded to move to P0, making it ready to load the specified product on the next step. No other higher-priority actions apply at this time.'
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 521
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]

Explanation:  
There is an action needed: raw materials are available for pickup, and bot...'
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]'
2025-07-26 21:56:30,387 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:30,387 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:30,387 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:30,387 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538190.38748}
2025-07-26 21:56:30,387 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P0 - move for AGV_1
2025-07-26 21:56:30,489 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:30,490 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2']
2025-07-26 21:56:32,253 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:32,254 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_44cb8dbc', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1570.0}
2025-07-26 21:56:32,254 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_44cb8dbc', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1570.0}
2025-07-26 21:56:32,255 - order - INFO - [order.py:245] - Created order order_44cb8dbc with 4 products
2025-07-26 21:56:32,255 - order - INFO - [order.py:339] - Assigned 4 products from order order_44cb8dbc to line2
2025-07-26 21:56:32,256 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_44cb8dbc with 4 products to line2
2025-07-26 21:56:32,257 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:32,257 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.88, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.85, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is idle, has no load, and is already positioned at P0 (RawMaterial warehouse), which is optimal for the next required action: loading raw material. Per decision priority, raw materials are the next process, and the specific product to load is prod_2_f60057dd. Therefore, the issued command is for AGV_1 to load prod_2_f60057dd. Only one command is sent as required. AGV_2 remains available for further needed actions.'
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 560
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is idle, has no load, and is already positioned at P0 (Ra...'
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]'
2025-07-26 21:56:32,260 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:32,260 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:32,260 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:32,260 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_f60057dd'}, 'timestamp': 1753538192.260711}
2025-07-26 21:56:32,260 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_moveP1_agv1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

**Explanation:**  
AGV_1 is already at P0 and has just loaded the raw material with product_id "prod_2_f60057dd". The next step in the workflow is for AGV_1 to move the material to StationA at P1 for unloading. There are no higher-priority actions, and AGV_1's battery is at 47.7%, so it is sufficient for transport. AGV_2 remains available for future commands as only one action is requested.'
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 503
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_moveP1_agv1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

**Explanation:**  
AGV_1 is already at P0 and has just loaded the raw material with produc...'
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_moveP1_agv1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]'
2025-07-26 21:56:32,261 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:32,261 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:32,261 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:32,261 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_moveP1_agv1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753538192.261587}
2025-07-26 21:56:32,261 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_moveP1_agv1 - move for AGV_1
2025-07-26 21:56:32,362 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:32,362 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:56:32,362 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:32,363 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1']
2025-07-26 21:56:32,777 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.88, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.85, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:32,872 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_44cb8dbc', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1570.0}
2025-07-26 21:56:33,410 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:34,873 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.88, 'first_pass_rate': 0.0, 'total_production_cost': 5.37, 'material_costs': 0.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.85, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:35,200 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:36,035 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is idle and already positioned at P0 (RawMaterial warehouse) with no current load, making it ready to perform the next required action. According to the decision logic, raw material handling is the next priority. The required command is to load the specified product (prod_2_f60057dd) from the raw material warehouse using AGV_1. Only one command is needed per the instructions, so AGV_1 executes the load‚ÄîAGV_2 remains available for subsequent tasks.'
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 594
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is idle and already positioned at P0 (RawMaterial warehou...'
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]'
2025-07-26 21:56:36,040 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:36,041 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:36,041 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:36,041 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_f60057dd'}, 'timestamp': 1753538196.041164}
2025-07-26 21:56:36,041 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:36,143 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:36,144 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]

Explanation:  
There is one action required and both AGVs are available. The highest priority applicable is picking up raw material. According to command logic, the first step is to move an AGV to the RawMaterial warehouse (P0). AGV_1 is selected to perform this move. After this move, you would command AGV_1 to load the specific product_id (prod_2_f60057dd) in the next step. Since only one action is needed now, only one AGV receives a command.'
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 558
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]

Explanation:  
There is one action required and both AGVs are available. The highest prio...'
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}]'
2025-07-26 21:56:36,240 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:36,240 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:36,240 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:36,240 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753538196.240743}
2025-07-26 21:56:36,240 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P0 - move for AGV_1
2025-07-26 21:56:36,342 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:36,343 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2']
2025-07-26 21:56:36,769 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 59.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.14, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.75, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:36,973 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 59.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.14, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.75, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:37,004 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 59.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.14, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.75, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:37,078 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 59.0, 'command_id': 'flow_20240624_loadprod2f60057dd', 'response': 'Product with id prod_2_f60057dd not found in warehouse buffer.'}
2025-07-26 21:56:37,078 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_loadprod2f60057dd response: Product with id prod_2_f60057dd not found in warehouse buffer.
2025-07-26 21:56:37,499 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 59.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Product with id prod_2_f60057dd not found in warehouse buffer.'}
2025-07-26 21:56:37,500 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Product with id prod_2_f60057dd not found in warehouse buffer.
2025-07-26 21:56:37,612 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_540116e1', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 540.0}
2025-07-26 21:56:37,612 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_540116e1', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 540.0}
2025-07-26 21:56:37,612 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_540116e1', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 540.0}
2025-07-26 21:56:37,612 - order - INFO - [order.py:245] - Created order order_540116e1 with 1 products
2025-07-26 21:56:37,613 - order - INFO - [order.py:339] - Assigned 1 products from order order_540116e1 to line3
2025-07-26 21:56:37,613 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_540116e1 with 1 products to line3
2025-07-26 21:56:37,719 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.07, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 11, 'completed_orders': 0, 'active_orders': 11, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:37,723 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_60adb312', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 380.0}
2025-07-26 21:56:37,723 - order - INFO - [order.py:245] - Created order order_60adb312 with 1 products
2025-07-26 21:56:37,723 - order - INFO - [order.py:339] - Assigned 1 products from order order_60adb312 to line1
2025-07-26 21:56:37,723 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_60adb312 with 1 products to line1
2025-07-26 21:56:37,723 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.07, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_loadprod2f60057dd","action":"load","target":"AGV_1","params":{"product_id":"prod_2_f60057dd"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and not carrying a load. The next step according to the workflow is to load the specified raw material ("prod_2_f60057dd"). AGV_2 remains idle, as only one action is requested and there are no higher-priority tasks at this time.'
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 420
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_loadprod2f60057dd","action":"load","target":"AGV_1","params":{"product_id":"prod_2_f60057dd"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and not ...'
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_loadprod2f60057dd","action":"load","target":"AGV_1","params":{"product_id":"prod_2_f60057dd"}}]'
2025-07-26 21:56:37,727 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:37,727 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:37,727 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:37,728 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_loadprod2f60057dd', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_f60057dd'}, 'timestamp': 1753538197.72798}
2025-07-26 21:56:37,728 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_loadprod2f60057dd - load for AGV_1
2025-07-26 21:56:37,829 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:37,830 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:56:37,850 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.07, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 11, 'completed_orders': 0, 'active_orders': 11, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:37,851 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_60adb312', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 380.0}
2025-07-26 21:56:37,851 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.07, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:37,851 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 60.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Product with id prod_2_f60057dd not found in warehouse buffer.'}
2025-07-26 21:56:37,851 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Product with id prod_2_f60057dd not found in warehouse buffer.
2025-07-26 21:56:37,852 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 60.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_f60057ddÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%'}
2025-07-26 21:56:37,852 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_f60057ddÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%
2025-07-26 21:56:38,021 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.07, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 11, 'completed_orders': 0, 'active_orders': 11, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:38,022 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_60adb312', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 380.0}
2025-07-26 21:56:38,023 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.07, 'first_pass_rate': 0.0, 'total_production_cost': 20.37, 'material_costs': 15.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.37, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:38,658 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 61.0, 'command_id': 'flow_20240624_loadprod2f60057dd', 'response': 'Product with id prod_2_f60057dd not found in warehouse buffer.'}
2025-07-26 21:56:38,658 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_loadprod2f60057dd response: Product with id prod_2_f60057dd not found in warehouse buffer.
2025-07-26 21:56:39,649 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV2_P0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}]

Explanation:  
Only one action is needed and both AGVs are available, but AGV_1 is currently in motion (DeviceStatus.MOVING) and not at the required location. Therefore, AGV_2 (fully available at startup) is assigned the task. As per the decision logic, the correct action is to move AGV_2 to the RawMaterial warehouse (P0) to prepare for picking up the next raw material (prod_2_f60057dd). This ensures continuous production flow with minimal delay.'
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 561
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV2_P0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}]

Explanation:  
Only one action is needed and both AGVs are available, but AGV_1 is curren...'
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV2_P0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}]'
2025-07-26 21:56:39,654 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:39,654 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:39,654 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:39,655 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV2_P0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753538199.654764}
2025-07-26 21:56:39,655 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV2_P0 - move for AGV_2
2025-07-26 21:56:39,757 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:39,757 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1']
2025-07-26 21:56:40,119 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:40,121 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:40,268 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is idle, at P0 (RawMaterial warehouse), and has no load, making it ready to execute the highest-priority available action: loading the specific raw material (prod_2_f60057dd). AGV_2 is currently moving and therefore not eligible for command assignment. Thus, the LOAD command is dispatched for AGV_1 to begin the new production cycle as required by the workflow. Only one command is issued, as directed by the prompt.'
2025-07-26 21:56:40,269 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:40,269 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 560
2025-07-26 21:56:40,269 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]

Explanation:  
AGV_1 is idle, at P0 (RawMaterial warehouse), and has no load, ...'
2025-07-26 21:56:40,269 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:40,269 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_2_f60057dd"}}]'
2025-07-26 21:56:40,269 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:40,269 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:40,269 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:40,270 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_f60057dd'}, 'timestamp': 1753538200.269791}
2025-07-26 21:56:40,270 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:40,372 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:40,373 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:56:40,742 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.67, 'first_pass_rate': 0.0, 'total_production_cost': 22.16, 'material_costs': 15.0, 'energy_costs': 7.16, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.66, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:40,743 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.67, 'first_pass_rate': 0.0, 'total_production_cost': 22.16, 'material_costs': 15.0, 'energy_costs': 7.16, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.66, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:40,743 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.38, 'first_pass_rate': 0.0, 'total_production_cost': 23.95, 'material_costs': 15.0, 'energy_costs': 8.95, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.49, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:40,744 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.38, 'first_pass_rate': 0.0, 'total_production_cost': 23.95, 'material_costs': 15.0, 'energy_costs': 8.95, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.49, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:40,801 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_loadprod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

**Explanation:**  
AGV_1 is at the raw material warehouse (P0), is not currently carrying a load, and is available for a new loading operation. The action with the highest priority is to begin new production by loading the next specified raw material, which is "prod_1_2cbc9444". AGV_2 is available but not needed for any higher-priority tasks, and only one command is required for this request.'
2025-07-26 21:56:40,802 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:40,802 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 523
2025-07-26 21:56:40,802 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_loadprod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

**Explanation:**  
AGV_1 is at the raw material warehouse (P0), is not c...'
2025-07-26 21:56:40,802 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:40,802 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_loadprod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:40,802 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:40,802 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:40,802 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:40,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_loadprod1_2cbc9444', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538200.802781}
2025-07-26 21:56:40,803 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_loadprod1_2cbc9444 - load for AGV_1
2025-07-26 21:56:40,904 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:40,905 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:56:41,480 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 6.46, 'first_pass_rate': 0.0, 'total_production_cost': 25.74, 'material_costs': 15.0, 'energy_costs': 10.74, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.99, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:41,481 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 63.949999, 'command_id': 'flow_20240618_move_AGV1_P0', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 21:56:41,481 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P0 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 21:56:41,482 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 63.949999, 'command_id': 'flow_20240618_move_AGV1_P0', 'response': 'Successfully arrived at path point P0, remaining battery: 45.4%'}
2025-07-26 21:56:41,482 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P0 response: Successfully arrived at path point P0, remaining battery: 45.4%
2025-07-26 21:56:41,952 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 64.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.06, 'first_pass_rate': 0.0, 'total_production_cost': 26.92, 'material_costs': 15.0, 'energy_costs': 11.92, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.96, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:42,214 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 63.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Product with id prod_2_f60057dd not found in warehouse buffer.'}
2025-07-26 21:56:42,215 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Product with id prod_2_f60057dd not found in warehouse buffer.
2025-07-26 21:56:42,215 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.67, 'first_pass_rate': 0.0, 'total_production_cost': 22.16, 'material_costs': 15.0, 'energy_costs': 7.16, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.66, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:42,216 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.38, 'first_pass_rate': 0.0, 'total_production_cost': 23.95, 'material_costs': 15.0, 'energy_costs': 8.95, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.49, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:42,217 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 6.46, 'first_pass_rate': 0.0, 'total_production_cost': 25.74, 'material_costs': 15.0, 'energy_costs': 10.74, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.99, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:42,217 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 63.949999, 'command_id': 'flow_20240628_agv2', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 21:56:42,217 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 21:56:42,736 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
AGV_1 is idle and located at P0 (RawMaterial warehouse) with no current load, making it immediately available for the next action. According to the action queue, the next required product to load is prod_1_2cbc9444. AGV_2 is currently moving and cannot be assigned a new command. Therefore, the single command issued is for AGV_1 to load the specified raw material (prod_1_2cbc9444) from P0, in line with process and decision priority.'
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 572
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
AGV_1 is idle and located at P0 (RawMaterial warehouse) with no...'
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:42,848 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:42,848 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:42,848 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:42,849 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538202.849037}
2025-07-26 21:56:42,849 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:42,951 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:56:42,951 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:56:43,018 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 64.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.06, 'first_pass_rate': 0.0, 'total_production_cost': 26.92, 'material_costs': 15.0, 'energy_costs': 11.92, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.96, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:43,501 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
Both AGVs are listed as "AVAILABLE" but their DeviceStatus is "MOVING" and neither is at a usable location for immediate action (both at P10). According to the rules, you cannot issue another command to an AGV while it is moving. Therefore, no new command can be issued at this time. Wait for one to arrive at its destination before proceeding with a "load" or further "move" command.'
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 404
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs are listed as "AVAILABLE" but their DeviceStatus is "MOVING" and neither is at a usable location for immediate action (both at P10). According to the rules, you cannot is...'
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 19, Finished products: 0
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.IDLE at P0, battery 47.7100002%
2025-07-26 21:56:43,503 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.MOVING at P10, battery 50.0%
2025-07-26 21:56:43,503 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:43,504 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1']
2025-07-26 21:56:44,381 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:44,385 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

**Explanation:**  
AGV_1 is idle, available, and already at P0 (RawMaterial warehouse) with no load, making it ready to load the next raw material. The next-in-line raw material is "prod_1_2cbc9444". As per logic, this is the highest available priority and the command specifies the correct product ID for the load. AGV_2 is also available, but no higher-priority task requires its use right now, and only one command is needed per the instructions.'
2025-07-26 21:56:44,386 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:44,386 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 578
2025-07-26 21:56:44,386 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

**Explanation:**  
AGV_1 is idle, available, and already at P0 (RawMate...'
2025-07-26 21:56:44,386 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:44,386 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:44,386 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:44,386 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:44,386 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:44,386 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_2cbc9444', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538204.386667}
2025-07-26 21:56:44,387 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_2cbc9444 - load for AGV_1
2025-07-26 21:56:44,488 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:44,488 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:56:44,967 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 67.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.21, 'first_pass_rate': 0.0, 'total_production_cost': 28.71, 'material_costs': 15.0, 'energy_costs': 13.71, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.18, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:45,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 67.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.21, 'first_pass_rate': 0.0, 'total_production_cost': 28.71, 'material_costs': 15.0, 'energy_costs': 13.71, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.18, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:45,990 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:45,994 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle and at P0 (RawMaterial warehouse) with no current load. According to the action list, the next product required is prod_1_2cbc9444. Since only one action is needed, AGV_1 is selected to execute the LOAD command for prod_1_2cbc9444. This aligns with the production priority, uses the correct product ID, and meets the restriction of only issuing one command per request. AGV_2 remains available for subsequent operations.'
2025-07-26 21:56:45,994 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:45,994 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 587
2025-07-26 21:56:45,994 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle and at P0 (RawMaterial warehouse)...'
2025-07-26 21:56:45,994 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:45,995 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:45,995 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:45,995 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:45,995 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:45,995 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538205.995316}
2025-07-26 21:56:45,995 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:46,097 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:46,098 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:56:46,624 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 63.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 6.46, 'first_pass_rate': 0.0, 'total_production_cost': 25.74, 'material_costs': 15.0, 'energy_costs': 10.74, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.99, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:46,688 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 67.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.15, 'first_pass_rate': 0.0, 'total_production_cost': 30.5, 'material_costs': 15.0, 'energy_costs': 15.5, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.82, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:46,689 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 68.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.96, 'first_pass_rate': 0.0, 'total_production_cost': 32.29, 'material_costs': 15.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.08, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,097 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:47,120 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 67.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.15, 'first_pass_rate': 0.0, 'total_production_cost': 30.5, 'material_costs': 15.0, 'energy_costs': 15.5, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.82, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,120 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 67.949999, 'command_id': 'flow_20240618_move_AGV2_P0', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 21:56:47,121 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV2_P0 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 21:56:47,121 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 67.949999, 'command_id': 'flow_20240618_move_AGV1_P0', 'response': 'Successfully arrived at path point P0, remaining battery: 43.1%'}
2025-07-26 21:56:47,121 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P0 response: Successfully arrived at path point P0, remaining battery: 43.1%
2025-07-26 21:56:47,121 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 68.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.96, 'first_pass_rate': 0.0, 'total_production_cost': 32.29, 'material_costs': 15.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.08, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,121 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 68.949999, 'command_id': 'flow_20240618_move_AGV1_P0', 'response': 'Successfully arrived at path point P0, remaining battery: 40.8%'}
2025-07-26 21:56:47,121 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P0 response: Successfully arrived at path point P0, remaining battery: 40.8%
2025-07-26 21:56:47,126 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 64.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.06, 'first_pass_rate': 0.0, 'total_production_cost': 26.92, 'material_costs': 15.0, 'energy_costs': 11.92, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.96, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,126 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 64.91666651, 'command_id': 'flow_20240624_moveP1_agv1', 'response': 'Successfully arrived at path point P1, remaining battery: 46.0%'}
2025-07-26 21:56:47,126 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_moveP1_agv1 response: Successfully arrived at path point P1, remaining battery: 46.0%
2025-07-26 21:56:47,126 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 65.0, 'command_id': 'flow_20240624_loadprod1_2cbc9444', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:56:47,126 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_loadprod1_2cbc9444 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:56:47,236 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 67.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.21, 'first_pass_rate': 0.0, 'total_production_cost': 28.71, 'material_costs': 15.0, 'energy_costs': 13.71, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.18, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,237 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 67.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.15, 'first_pass_rate': 0.0, 'total_production_cost': 30.5, 'material_costs': 15.0, 'energy_costs': 15.5, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.82, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,237 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 68.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.96, 'first_pass_rate': 0.0, 'total_production_cost': 32.29, 'material_costs': 15.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.08, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,573 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV1_prod_1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
AGV_1 is available, idle, and already positioned at the RawMaterial warehouse (P0) with no load. The action needed is to start new production by picking up a raw material. As per the priorities and rules, the correct command is to load the next available raw material ("prod_1_2cbc9444") onto AGV_1. AGV_2 is still moving and cannot receive a new command yet.'
2025-07-26 21:56:47,573 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:47,573 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 509
2025-07-26 21:56:47,573 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV1_prod_1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
AGV_1 is available, idle, and already positioned a...'
2025-07-26 21:56:47,573 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:47,573 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV1_prod_1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:47,574 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:47,574 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:47,574 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:47,574 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV1_prod_1_2cbc9444', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538207.574112}
2025-07-26 21:56:47,574 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV1_prod_1_2cbc9444 - load for AGV_1
2025-07-26 21:56:47,675 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:47,676 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1']
2025-07-26 21:56:47,759 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,786 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:47,983 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:48,201 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,238 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5bd47ee8', 'created_at': 70.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1900.0}
2025-07-26 21:56:48,238 - order - INFO - [order.py:245] - Created order order_5bd47ee8 with 3 products
2025-07-26 21:56:48,239 - order - INFO - [order.py:339] - Assigned 3 products from order order_5bd47ee8 to line2
2025-07-26 21:56:48,239 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_5bd47ee8 with 3 products to line2
2025-07-26 21:56:48,239 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 13, 'completed_orders': 0, 'active_orders': 13, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,239 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_530dfe78', 'created_at': 70.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1300.0}
2025-07-26 21:56:48,239 - order - INFO - [order.py:245] - Created order order_530dfe78 with 2 products
2025-07-26 21:56:48,239 - order - INFO - [order.py:339] - Assigned 2 products from order order_530dfe78 to line3
2025-07-26 21:56:48,239 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_530dfe78 with 2 products to line3
2025-07-26 21:56:48,240 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,250 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5bd47ee8', 'created_at': 70.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1900.0}
2025-07-26 21:56:48,251 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 13, 'completed_orders': 0, 'active_orders': 13, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,305 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5bd47ee8', 'created_at': 70.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1900.0}
2025-07-26 21:56:48,620 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 13, 'completed_orders': 0, 'active_orders': 13, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,621 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_530dfe78', 'created_at': 70.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1300.0}
2025-07-26 21:56:48,622 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,738 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 71.0, 'command_id': 'flow_20240618_load_AGV1_prod_1_2cbc9444', 'response': 'Product with id prod_1_2cbc9444 not found in warehouse buffer.'}
2025-07-26 21:56:48,739 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV1_prod_1_2cbc9444 response: Product with id prod_1_2cbc9444 not found in warehouse buffer.
2025-07-26 21:56:48,739 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 71.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.47, 'first_pass_rate': 0.0, 'total_production_cost': 44.08, 'material_costs': 25.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.52, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:48,778 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 71.949999, 'command_id': 'flow_20240618_move_AGV2_P0', 'response': 'Successfully arrived at path point P0, remaining battery: 45.4%'}
2025-07-26 21:56:48,778 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV2_P0 response: Successfully arrived at path point P0, remaining battery: 45.4%
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, has no load, and is available to process a new raw material. The highest priority available task is to load the next raw material, "prod_1_2cbc9444". This command tells AGV_1 to execute that load. AGV_2 is available, but since only one command is allowed per request and there are no higher-priority actions for it, no action is assigned to AGV_2 in this step.'
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 554
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, has no...'
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:48,797 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:48,797 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:48,797 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:48,797 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_2cbc9444', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538208.797621}
2025-07-26 21:56:48,797 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_2cbc9444 - load for AGV_1
2025-07-26 21:56:48,899 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:56:48,899 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:56:49,122 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:49,376 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_530dfe78', 'created_at': 70.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1300.0}
2025-07-26 21:56:49,376 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.82, 'first_pass_rate': 0.0, 'total_production_cost': 42.29, 'material_costs': 25.0, 'energy_costs': 17.29, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.7, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:50,081 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 71.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Product with id prod_1_2cbc9444 not found in warehouse buffer.'}
2025-07-26 21:56:50,081 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Product with id prod_1_2cbc9444 not found in warehouse buffer.
2025-07-26 21:56:50,082 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 71.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_2cbc9444Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%'}
2025-07-26 21:56:50,082 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_2cbc9444Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%
2025-07-26 21:56:50,082 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 71.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.47, 'first_pass_rate': 0.0, 'total_production_cost': 44.08, 'material_costs': 25.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.52, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:50,207 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle and waiting at P0 (RawMaterial warehouse) without any loaded products. The highest priority action is to load the next raw material, which is prod_1_2cbc9444. Since only one action is needed for this request, AGV_1 is assigned to load prod_1_2cbc9444. This satisfies the operational logic and aligns with the instruction to only send one command per available AGV per request. AGV_2 remains ready for subsequent actions.'
2025-07-26 21:56:50,207 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:50,207 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 587
2025-07-26 21:56:50,207 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle and waiting at P0 (RawMaterial wa...'
2025-07-26 21:56:50,207 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:50,208 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_load", "action":"load", "target":"AGV_1", "params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:50,208 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:50,208 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:50,208 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:50,208 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538210.208324}
2025-07-26 21:56:50,208 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load - load for AGV_1
2025-07-26 21:56:50,310 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:50,310 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1']
2025-07-26 21:56:50,600 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV1_prod_1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
Both AGVs are at the RawMaterial warehouse (P0), idle, unloaded, and available. Only one action is needed. According to the decision logic, the next step is to load a specific raw material‚Äî"prod_1_2cbc9444". AGV_1 is selected to perform this load operation. AGV_2 remains idle and ready for further commands once the system requires additional actions.'
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 502
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV1_prod_1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]

Explanation:  
Both AGVs are at the RawMaterial warehouse (P0), i...'
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV1_prod_1_2cbc9444","action":"load","target":"AGV_1","params":{"product_id":"prod_1_2cbc9444"}}]'
2025-07-26 21:56:50,603 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:50,603 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:50,603 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:50,603 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV1_prod_1_2cbc9444', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_2cbc9444'}, 'timestamp': 1753538210.603525}
2025-07-26 21:56:50,603 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV1_prod_1_2cbc9444 - load for AGV_1
2025-07-26 21:56:50,705 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:50,706 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:56:51,853 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 74.0, 'command_id': 'flow_20240618_load_AGV1_prod_1_2cbc9444', 'response': 'Product with id prod_1_2cbc9444 not found in warehouse buffer.'}
2025-07-26 21:56:51,853 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV1_prod_1_2cbc9444 response: Product with id prod_1_2cbc9444 not found in warehouse buffer.
2025-07-26 21:56:52,174 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 74.0, 'command_id': 'flow_20240628_agv1_load', 'response': 'Can not load. AGV AGV_1 is not available or payload is full.'}
2025-07-26 21:56:52,174 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load response: Can not load. AGV AGV_1 is not available or payload is full.
2025-07-26 21:56:52,447 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:52,701 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is idle, located at P0 (RawMaterial warehouse), and currently empty (load:0). The highest-priority action per the workflow and status is to load the next raw material in the list, which is "prod_2_9510e82e." This command sends AGV_1 the order to perform the correct load operation, specifying the required product ID as instructed. AGV_2 remains available as no higher-priority action requires it, and only one command is permitted per request.'
2025-07-26 21:56:52,702 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:52,702 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 598
2025-07-26 21:56:52,702 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is idle, located at P0 (RawMaterial warehouse)...'
2025-07-26 21:56:52,702 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:52,704 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]'
2025-07-26 21:56:52,704 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:52,704 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:52,704 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:52,704 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_9510e82e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_9510e82e'}, 'timestamp': 1753538212.704892}
2025-07-26 21:56:52,705 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_9510e82e - load for AGV_1
2025-07-26 21:56:52,806 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:52,806 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:56:54,271 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:54,273 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move", "action":"move", "target":"AGV_1", "params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0 and already has a load (2), indicating it has raw materials or products ready for the next processing step. According to the workflow, after loading raw materials at P0, the next step is to move them to StationA at P1. AGV_2 is idle at P0 with no load, but since only one action is requested and AGV_1 is ready to move its current load, the correct action is to have AGV_1 move from P0 to P1 to proceed in the production sequence.'
2025-07-26 21:56:54,274 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:54,274 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 576
2025-07-26 21:56:54,274 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move", "action":"move", "target":"AGV_1", "params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0 and already has a load (2), indicating it has raw mate...'
2025-07-26 21:56:54,274 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:54,274 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move", "action":"move", "target":"AGV_1", "params":{"target_point":"P1"}}]'
2025-07-26 21:56:54,274 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:54,274 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:56:54,274 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:56:54,274 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753538214.274457}
2025-07-26 21:56:54,274 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move - move for AGV_1
2025-07-26 21:56:54,376 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:54,376 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1']
2025-07-26 21:56:54,795 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:54,963 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:55,115 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is located at P0 (RawMaterial warehouse), is idle, and not carrying a load. According to the decision logic, the top priority task is to load the next raw material, which is "prod_2_9510e82e", for production. As required, the load command specifies the exact product_id. AGV_2 remains available, as only one command is required for this action request and there are no higher-priority tasks needing attention.'
2025-07-26 21:56:55,116 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:55,116 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 563
2025-07-26 21:56:55,116 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is located at P0 (RawMaterial warehouse), is i...'
2025-07-26 21:56:55,116 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:55,116 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]'
2025-07-26 21:56:55,116 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:55,116 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:55,116 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:55,117 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_9510e82e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_9510e82e'}, 'timestamp': 1753538215.11686}
2025-07-26 21:56:55,117 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_9510e82e - load for AGV_1
2025-07-26 21:56:55,218 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:55,218 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:56:55,417 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV1_prod_2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

Explanation:  
Both AGVs are idle, available, and already located at the RawMaterial warehouse (P0) with no load. Since only one action is needed, AGV_1 is tasked to load the next raw material, which is "prod_2_9510e82e". This follows the decision logic to prioritize loading raw materials and prepares AGV_1 for the next processing stage. AGV_2 will remain idle until more actions are needed.'
2025-07-26 21:56:55,418 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:55,418 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 528
2025-07-26 21:56:55,418 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV1_prod_2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

Explanation:  
Both AGVs are idle, available, and already located...'
2025-07-26 21:56:55,418 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:55,418 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV1_prod_2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]'
2025-07-26 21:56:55,418 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:55,418 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:56:55,418 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:56:55,419 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV1_prod_2_9510e82e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_9510e82e'}, 'timestamp': 1753538215.418742}
2025-07-26 21:56:55,419 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV1_prod_2_9510e82e - load for AGV_1
2025-07-26 21:56:55,520 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:55,521 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:56:56,989 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.63, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.16, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:57,105 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.63, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.16, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:58,134 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fef43bb', 'created_at': 80.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1910.0}
2025-07-26 21:56:58,135 - order - INFO - [order.py:245] - Created order order_3fef43bb with 3 products
2025-07-26 21:56:58,135 - order - INFO - [order.py:339] - Assigned 3 products from order order_3fef43bb to line1
2025-07-26 21:56:58,135 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_3fef43bb with 3 products to line1
2025-07-26 21:56:58,135 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.85, 'total_orders': 15, 'completed_orders': 0, 'active_orders': 15, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:58,135 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a830c7f5', 'created_at': 80.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 560.0}
2025-07-26 21:56:58,135 - order - INFO - [order.py:245] - Created order order_a830c7f5 with 1 products
2025-07-26 21:56:58,135 - order - INFO - [order.py:339] - Assigned 1 products from order order_a830c7f5 to line2
2025-07-26 21:56:58,135 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_a830c7f5 with 1 products to line2
2025-07-26 21:56:58,135 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.85, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:58,135 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 80.0, 'command_id': 'flow_20240618_load_AGV1_prod_2_9510e82e', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_9510e82eÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 40.3%'}
2025-07-26 21:56:58,135 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV1_prod_2_9510e82e response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_9510e82eÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 40.3%
2025-07-26 21:56:58,237 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is available, idle, not carrying a load, and stationed at P0 (RawMaterial warehouse). The highest priority action is to start new production by loading the next specified raw material, "prod_2_9510e82e". This command correctly initiates the load using the required product ID. No higher-priority actions or special use of AGV_2 are needed, and only one command is generated per request.'
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 540
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is available, idle, not carrying a load, and s...'
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]'
2025-07-26 21:56:58,470 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:56:58,471 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:56:58,471 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:56:58,472 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_9510e82e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_9510e82e'}, 'timestamp': 1753538218.471964}
2025-07-26 21:56:58,472 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_9510e82e - load for AGV_1
2025-07-26 21:56:58,573 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:56:58,573 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2']
2025-07-26 21:56:59,628 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fef43bb', 'created_at': 80.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1910.0}
2025-07-26 21:56:59,629 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.85, 'total_orders': 15, 'completed_orders': 0, 'active_orders': 15, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:56:59,630 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a830c7f5', 'created_at': 80.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 560.0}
2025-07-26 21:57:00,039 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 71.0, 'command_id': 'flow_20240624_load_prod1_2cbc9444', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:00,040 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_2cbc9444 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:00,040 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 71.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.47, 'first_pass_rate': 0.0, 'total_production_cost': 44.08, 'material_costs': 25.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.52, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:00,086 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.85, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:00,159 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 73.0, 'command_id': 'flow_20240624_load_prod1_2cbc9444', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:00,159 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_2cbc9444 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:00,160 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 79.0, 'command_id': 'flow_20240624_load_prod2_9510e82e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:00,160 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_9510e82e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:00,160 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 79.0, 'command_id': 'flow_20240624_load_prod2_9510e82e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:00,160 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_9510e82e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:00,160 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.63, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.16, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:00,566 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fef43bb', 'created_at': 80.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1910.0}
2025-07-26 21:57:00,567 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.85, 'total_orders': 15, 'completed_orders': 0, 'active_orders': 15, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:00,568 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a830c7f5', 'created_at': 80.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 560.0}
2025-07-26 21:57:00,568 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 59.08, 'material_costs': 40.0, 'energy_costs': 19.08, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.85, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:00,569 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 82.0, 'command_id': 'flow_20240624_load_prod2_9510e82e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:00,569 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_9510e82e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:00,844 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:01,725 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 84.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.87, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:01,725 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 84.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.87, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:01,725 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 84.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.52, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.87, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:01,837 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 84.91666651, 'command_id': 'flow_20240628_agv1_move', 'response': 'Successfully arrived at path point P1, remaining battery: 42.7%'}
2025-07-26 21:57:01,837 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_move response: Successfully arrived at path point P1, remaining battery: 42.7%
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is idle, at the raw material warehouse (P0), and not loaded. The highest-priority action is to load the next raw material for production, using the specific product_id "prod_2_9510e82e". This command correctly initiates the loading step. AGV_2 remains available but is not needed since only one action is allowed at this time, and there are no higher-priority jobs for it.'
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 526
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

**Explanation:**  
AGV_1 is idle, at the raw material warehouse (P0), a...'
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]'
2025-07-26 21:57:04,545 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:04,546 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:04,546 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:04,546 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_9510e82e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_9510e82e'}, 'timestamp': 1753538224.546169}
2025-07-26 21:57:04,546 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_9510e82e - load for AGV_1
2025-07-26 21:57:04,647 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:04,648 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2']
2025-07-26 21:57:06,330 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 88.0, 'command_id': 'flow_20240624_load_prod2_9510e82e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:06,330 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_9510e82e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:06,695 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:07,383 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV1_prod_2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle, available, and at the RawMaterial warehouse (P0). With only one action required, the next priority is to load the specified raw material ("prod_2_9510e82e"). AGV_1 is selected for this task. This follows decision logic to efficiently start processing of available raw materials, while AGV_2 stays idle and ready for further instructions if more actions become necessary.'
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 551
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV1_prod_2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle, available, and at t...'
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV1_prod_2_9510e82e","action":"load","target":"AGV_1","params":{"product_id":"prod_2_9510e82e"}}]'
2025-07-26 21:57:07,388 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:07,388 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:07,388 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:07,389 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV1_prod_2_9510e82e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_9510e82e'}, 'timestamp': 1753538227.389185}
2025-07-26 21:57:07,389 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV1_prod_2_9510e82e - load for AGV_1
2025-07-26 21:57:07,491 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:07,492 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:57:07,742 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_9f24bfc0', 'created_at': 90.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 840.0}
2025-07-26 21:57:07,742 - order - INFO - [order.py:245] - Created order order_9f24bfc0 with 1 products
2025-07-26 21:57:07,742 - order - INFO - [order.py:339] - Assigned 1 products from order order_9f24bfc0 to line3
2025-07-26 21:57:07,742 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_9f24bfc0 with 1 products to line3
2025-07-26 21:57:07,904 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.04, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.52, 'total_orders': 17, 'completed_orders': 0, 'active_orders': 17, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:07,905 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:07,909 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is available, idle, at P0 (RawMaterial warehouse), and not carrying any load. The decision logic prioritizes loading the next raw material, which is "prod_2_51dec7be." This command properly executes the task by instructing AGV_1 to load this specific product. AGV_2 is available but not needed for this priority, and only one command is permitted per request.'
2025-07-26 21:57:07,909 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:07,909 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 513
2025-07-26 21:57:07,910 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is available, idle, at P0 (RawMaterial warehou...'
2025-07-26 21:57:07,910 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:07,910 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:07,910 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:07,910 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:07,910 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:07,911 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538227.910778}
2025-07-26 21:57:07,911 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:07,937 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_9f24bfc0', 'created_at': 90.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 840.0}
2025-07-26 21:57:07,938 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.04, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.52, 'total_orders': 17, 'completed_orders': 0, 'active_orders': 17, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:08,012 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:08,012 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2']
2025-07-26 21:57:08,029 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8db29e6d', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 570.0}
2025-07-26 21:57:08,030 - order - INFO - [order.py:245] - Created order order_8db29e6d with 1 products
2025-07-26 21:57:08,030 - order - INFO - [order.py:339] - Assigned 1 products from order order_8db29e6d to line1
2025-07-26 21:57:08,030 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_8db29e6d with 1 products to line1
2025-07-26 21:57:08,031 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.04, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.52, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:08,154 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_9f24bfc0', 'created_at': 90.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 840.0}
2025-07-26 21:57:08,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.04, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.52, 'total_orders': 17, 'completed_orders': 0, 'active_orders': 17, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:08,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8db29e6d', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 570.0}
2025-07-26 21:57:08,156 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.04, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.52, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:08,610 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move", "action":"move", "target":"AGV_1", "params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0 and already holding a load of 2. According to the production workflow, after raw material loading at P0, the AGV should proceed to StationA (P1) for unloading. Since AGV_2 is idle with no load and only a single action is needed, the most efficient command is for AGV_1 to move its current load to P1. This continues the process flow efficiently.'
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 491
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move", "action":"move", "target":"AGV_1", "params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0 and already holding a load of 2. According to the prod...'
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move", "action":"move", "target":"AGV_1", "params":{"target_point":"P1"}}]'
2025-07-26 21:57:08,612 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:08,612 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:08,612 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:08,612 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753538228.612542}
2025-07-26 21:57:08,612 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move - move for AGV_1
2025-07-26 21:57:08,713 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:08,714 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:57:08,996 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:09,474 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8db29e6d', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 570.0}
2025-07-26 21:57:09,475 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.04, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.52, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:09,476 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 90.0, 'command_id': 'flow_20240618_load_AGV1_prod_2_9510e82e', 'response': 'Product with id prod_2_9510e82e not found in warehouse buffer.'}
2025-07-26 21:57:09,476 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV1_prod_2_9510e82e response: Product with id prod_2_9510e82e not found in warehouse buffer.
2025-07-26 21:57:09,805 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 92.0, 'command_id': 'flow_20240628_agv1_move', 'response': 'Can not find path from P1 to P1'}
2025-07-26 21:57:09,806 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_move response: Can not find path from P1 to P1
2025-07-26 21:57:10,368 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 92.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:10,368 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:10,599 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:10,600 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and not carrying any load. The next highest-priority action is to load the next scheduled raw material, which is "prod_2_51dec7be." The load command is issued with the correct product_id. AGV_2 remains available, but no higher-priority actions require its use at this step, and only one action is permitted per request.'
2025-07-26 21:57:10,601 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:10,601 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 513
2025-07-26 21:57:10,601 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and no...'
2025-07-26 21:57:10,601 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:10,601 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:10,601 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:10,601 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:10,601 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:10,601 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538230.601347}
2025-07-26 21:57:10,601 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:10,702 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:10,703 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1']
2025-07-26 21:57:11,789 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:11,793 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0, has already loaded one product, and is ready for the next stage. According to the decision logic, after loading a raw material, the AGV should move to StationA (P1) for unloading. AGV_2 is idle and empty at P0 but no new load is commanded since only one action is needed and AGV_1 has priority due to already carrying material. Therefore, AGV_1 is sent to move to P1 to continue the production flow.'
2025-07-26 21:57:11,793 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:11,794 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 546
2025-07-26 21:57:11,794 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0, has already loaded one product, and is ready for the ...'
2025-07-26 21:57:11,794 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:11,794 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]'
2025-07-26 21:57:11,794 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:11,794 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:11,794 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:11,794 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753538231.794467}
2025-07-26 21:57:11,794 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P1 - move for AGV_1
2025-07-26 21:57:11,896 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:11,897 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3']
2025-07-26 21:57:12,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 94.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:12,350 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:12,901 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:13,235 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:13,914 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:15,260 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]

Explanation:  
AGV_1 is idle at P1 (StationA) and has a load of 2, meaning it has delivered raw materials as per the process flow. The correct next action is to unload the materials at StationA (P1) so the production can continue automatically. AGV_2 is idle at P0 but has no load, and only one action is needed in this request. Therefore, the unload command for AGV_1 is the optimal choice to maintain efficient production flow.'
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 525
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]

Explanation:  
AGV_1 is idle at P1 (StationA) and has a load of 2, meaning it has delivered raw material...'
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]'
2025-07-26 21:57:15,263 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:15,263 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:15,263 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:15,263 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_unload', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538235.263658}
2025-07-26 21:57:15,263 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_unload - unload for AGV_1
2025-07-26 21:57:15,365 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:15,366 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:57:15,940 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0 and already loaded with one raw material. According to the workflow logic, the next step for AGV_1 is to move to StationA (P1) for unloading that raw material to begin production. Only one action is needed, so AGV_1 is prioritized for this operation. AGV_2 remains idle at P0 awaiting further instructions.'
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 452
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

Explanation:  
AGV_1 is idle at P0 and already loaded with one raw material. According to...'
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]'
2025-07-26 21:57:15,944 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:15,944 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:15,944 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:15,945 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753538235.944965}
2025-07-26 21:57:15,945 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P1 - move for AGV_1
2025-07-26 21:57:16,046 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:16,047 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3']
2025-07-26 21:57:17,535 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle, at P0 (RawMaterial warehouse), and not loaded. The highest-priority task is to load the next raw material, "prod_2_51dec7be," for production. This command instructs AGV_1 to perform the correct loading operation and specifies the required product_id. No other higher-priority task or AGV_2-specific action is pending, and only one command is needed for this request.'
2025-07-26 21:57:17,536 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:17,536 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 529
2025-07-26 21:57:17,536 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle, at P0 (RawMaterial warehouse), and no...'
2025-07-26 21:57:17,536 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:17,536 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:17,536 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:17,536 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:17,536 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:17,536 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538237.536669}
2025-07-26 21:57:17,537 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:17,638 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:17,638 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1']
2025-07-26 21:57:17,865 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_41b54926', 'created_at': 100.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 21:57:17,865 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_41b54926', 'created_at': 100.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 21:57:17,866 - order - INFO - [order.py:245] - Created order order_41b54926 with 1 products
2025-07-26 21:57:17,866 - order - INFO - [order.py:339] - Assigned 1 products from order order_41b54926 to line2
2025-07-26 21:57:17,866 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_41b54926 with 1 products to line2
2025-07-26 21:57:18,123 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.24, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.27, 'total_orders': 19, 'completed_orders': 0, 'active_orders': 19, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,123 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.24, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.27, 'total_orders': 19, 'completed_orders': 0, 'active_orders': 19, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,499 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_021fa2ae', 'created_at': 100.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1660.0}
2025-07-26 21:57:18,499 - order - INFO - [order.py:245] - Created order order_021fa2ae with 3 products
2025-07-26 21:57:18,500 - order - INFO - [order.py:339] - Assigned 3 products from order order_021fa2ae to line3
2025-07-26 21:57:18,500 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_021fa2ae with 3 products to line3
2025-07-26 21:57:18,500 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.24, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.27, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,501 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.59, 'first_pass_rate': 0.0, 'total_production_cost': 61.45, 'material_costs': 40.0, 'energy_costs': 21.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.26, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,613 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_41b54926', 'created_at': 100.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 21:57:18,613 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.24, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.27, 'total_orders': 19, 'completed_orders': 0, 'active_orders': 19, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,735 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_021fa2ae', 'created_at': 100.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1660.0}
2025-07-26 21:57:18,736 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.24, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.27, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,736 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 100.0, 'command_id': 'flow_20240628_agv1_unload', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_f60057ddÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 42.2%'}
2025-07-26 21:57:18,736 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_unload response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_f60057ddÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 42.2%
2025-07-26 21:57:18,736 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.59, 'first_pass_rate': 0.0, 'total_production_cost': 61.45, 'material_costs': 40.0, 'energy_costs': 21.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.26, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,741 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_021fa2ae', 'created_at': 100.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1660.0}
2025-07-26 21:57:18,742 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.24, 'first_pass_rate': 0.0, 'total_production_cost': 60.27, 'material_costs': 40.0, 'energy_costs': 20.27, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.27, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,912 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.59, 'first_pass_rate': 0.0, 'total_production_cost': 61.45, 'material_costs': 40.0, 'energy_costs': 21.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.26, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:18,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 100.91666651, 'command_id': 'flow_20240618_move_AGV1_P1', 'response': 'Successfully arrived at path point P1, remaining battery: 38.7%'}
2025-07-26 21:57:18,914 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P1 response: Successfully arrived at path point P1, remaining battery: 38.7%
2025-07-26 21:57:19,052 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:19,055 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]

Explanation:  
AGV_1 is at P1 (StationA) with a load of 2 and is idle, which means it has delivered raw materials to StationA and is ready to unload. According to the process, the correct next step is to unload the materials at StationA so that production can proceed automatically through the next stages. Although AGV_2 is available at P0, AGV_1's unload is the most immediate action required and only one command is allowed per the request. This choice keeps the production line moving efficiently.'
2025-07-26 21:57:19,055 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:19,055 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 597
2025-07-26 21:57:19,055 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]

Explanation:  
AGV_1 is at P1 (StationA) with a load of 2 and is idle, which means it has delivered raw ...'
2025-07-26 21:57:19,055 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:19,055 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]'
2025-07-26 21:57:19,056 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:19,056 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:19,056 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:19,056 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_unload', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538239.056312}
2025-07-26 21:57:19,056 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_unload - unload for AGV_1
2025-07-26 21:57:19,158 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:19,158 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:57:19,686 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:19,960 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
AGV_1 is currently moving (not idle), so you cannot issue any new commands to it until it arrives at its next destination. AGV_2 is idle and at P0, but the workflow logic only needs one action at this time, and AGV_1 already has the priority action (is loaded and moving for transfer). Therefore, no new command should be sent at this time; wait until one AGV is idle and ready for the next step.'
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 416
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
AGV_1 is currently moving (not idle), so you cannot issue any new commands to it until it arrives at its next destination. AGV_2 is idle and at P0, but the workflow logic only need...'
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 28, Finished products: 0
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.IDLE at P1, battery 38.65666749800001%
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 47.7100002%
2025-07-26 21:57:20,205 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:57:20,579 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:20,804 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 103.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:20,805 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:21,538 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and has no load. According to the decision logic, the next action is to load the next raw material, which is "prod_2_51dec7be". The command uses the required product_id as specified in the workflow. AGV_2 is available but not required for a higher-priority action, and only one action is permitted per request.'
2025-07-26 21:57:21,538 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:21,538 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 504
2025-07-26 21:57:21,538 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and ha...'
2025-07-26 21:57:21,538 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:21,539 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:21,539 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:21,539 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:21,539 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:21,539 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538241.539452}
2025-07-26 21:57:21,539 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:21,641 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:21,641 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1']
2025-07-26 21:57:21,808 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.19, 'first_pass_rate': 0.0, 'total_production_cost': 62.45, 'material_costs': 40.0, 'energy_costs': 22.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.61, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:22,262 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:22,614 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 104.0, 'command_id': 'flow_20240628_agv1_unload', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_1_2cbc9444Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 41.7%'}
2025-07-26 21:57:22,614 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_unload response: Â∑≤Â∞Ü‰∫ßÂìÅprod_1_2cbc9444Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 41.7%
2025-07-26 21:57:22,696 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:22,700 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]

Explanation:  
AGV_1 is idle at P1 (StationA) and still carrying a load of 1, which likely means there is one more unit to unload at StationA for processing. While AGV_2 is idle at P0 and ready for future tasks, the immediate priority is for AGV_1 to unload its remaining load at StationA. This keeps the station supplied and production advancing as quickly as possible. Only one command is required, so AGV_1 gets the unload instruction.'
2025-07-26 21:57:22,701 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:22,701 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 534
2025-07-26 21:57:22,701 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]

Explanation:  
AGV_1 is idle at P1 (StationA) and still carrying a load of 1, which likely means there i...'
2025-07-26 21:57:22,701 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:22,701 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_unload", "action":"unload", "target":"AGV_1", "params":{}}]'
2025-07-26 21:57:22,701 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:22,701 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:22,701 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:22,702 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_unload', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538242.701788}
2025-07-26 21:57:22,702 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_unload - unload for AGV_1
2025-07-26 21:57:22,726 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.19, 'first_pass_rate': 0.0, 'total_production_cost': 62.45, 'material_costs': 40.0, 'energy_costs': 22.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.61, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:22,739 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:22,803 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:22,803 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:57:23,241 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:24,154 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 63.63, 'material_costs': 40.0, 'energy_costs': 23.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.57, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:24,422 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 63.63, 'material_costs': 40.0, 'energy_costs': 23.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.57, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:24,679 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 104.91666651, 'command_id': 'flow_20240618_move_AGV1_P1', 'response': 'Successfully arrived at path point P1, remaining battery: 37.0%'}
2025-07-26 21:57:24,679 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P1 response: Successfully arrived at path point P1, remaining battery: 37.0%
2025-07-26 21:57:25,009 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is now idle at StationA (P1) and is loaded with a raw material. According to decision logic and workflow, the next action is to unload the raw material at StationA (P1) to initiate processing. AGV_2 remains idle at P0 and is empty, but no additional action is required at this step, so only AGV_1 receives the unload command.'
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 442
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is now idle at StationA (P1) and is loaded with a raw material. According to decisi...'
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]'
2025-07-26 21:57:25,012 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:25,013 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:25,013 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:25,013 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV1_P1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538245.013156}
2025-07-26 21:57:25,013 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV1_P1 - unload for AGV_1
2025-07-26 21:57:25,115 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:25,115 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:57:25,202 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:25,342 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.19, 'first_pass_rate': 0.0, 'total_production_cost': 62.45, 'material_costs': 40.0, 'energy_costs': 22.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.61, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:25,442 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:25,446 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle, available, and positioned at P0 (RawMaterial warehouse) with no current load. According to the decision logic, the highest priority action is to load the next specified raw material ("prod_2_51dec7be"), and the load command must include the specific product_id. This action keeps production flowing. AGV_2 remains idle as there is no higher-priority need for a second AGV and only one action is required per request.'
2025-07-26 21:57:25,446 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:25,446 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 579
2025-07-26 21:57:25,446 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle, available, and positioned at P0 (RawM...'
2025-07-26 21:57:25,447 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:25,447 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:25,447 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:25,447 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:25,447 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:25,447 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538245.447384}
2025-07-26 21:57:25,447 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:25,549 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:57:25,550 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1']
2025-07-26 21:57:25,728 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:25,959 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 63.63, 'material_costs': 40.0, 'energy_costs': 23.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.57, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:26,550 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:26,875 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.56, 'first_pass_rate': 0.0, 'total_production_cost': 64.63, 'material_costs': 40.0, 'energy_costs': 24.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.75, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:26,928 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:26,973 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.56, 'first_pass_rate': 0.0, 'total_production_cost': 64.63, 'material_costs': 40.0, 'energy_costs': 24.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.75, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:27,824 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.56, 'first_pass_rate': 0.0, 'total_production_cost': 64.63, 'material_costs': 40.0, 'energy_costs': 24.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.75, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) with no load, positioning it optimally to pick up the next needed raw material for production. According to the action list, the next raw material required is prod_2_51dec7be. AGV_1 is idle at P1 and has no load, but as only one action is required and raw material pickup is the highest available priority, AGV_2 is instructed to load prod_2_51dec7be from P0. This command keeps materials flowing toward StationA for continuous production.'
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 620
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) with no load, posit...'
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:27,826 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:27,826 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:27,826 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:27,826 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538247.826491}
2025-07-26 21:57:27,826 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:57:27,928 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:27,928 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:57:28,052 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:28,145 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:28,148 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is in the correct position at P0 (RawMaterial warehouse), is idle, and has no load. The top-priority action is to load the next raw material with the specific product_id "prod_2_51dec7be". This action kicks off the production flow as outlined by the process. AGV_2 is available but not needed for this request since only one action can be taken and there are no higher-priority or special situations involving it at this time.'
2025-07-26 21:57:28,148 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:28,148 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 580
2025-07-26 21:57:28,148 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is in the correct position at P0 (RawMaterial ...'
2025-07-26 21:57:28,148 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:28,149 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:28,149 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:28,149 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:28,149 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:28,149 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538248.149261}
2025-07-26 21:57:28,149 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:28,250 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:28,251 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1']
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at StationA (P1) and is carrying a raw material load. Based on the production flow and priority logic, the next immediate action is to unload its cargo at P1 to begin production processing. AGV_2 is idle at P0 and empty, but no new action is currently needed for it, so the command is for AGV_1 only.'
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 425
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at StationA (P1) and is carrying a raw material load. Based on the producti...'
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]'
2025-07-26 21:57:28,629 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:28,629 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:28,629 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:28,629 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV1_P1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538248.629531}
2025-07-26 21:57:28,629 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV1_P1 - unload for AGV_1
2025-07-26 21:57:28,730 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:28,731 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:57:31,038 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:31,097 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) with no load, making it the best candidate to load the next required raw material. The action queue specifies prod_2_51dec7be as the next product to load. AGV_1 is idle at P1 (StationA) without a load, but since only one action is needed and the next workflow step is raw material pickup, the optimal command is to instruct AGV_2 to load prod_2_51dec7be. This keeps the production cycle moving smoothly and efficiently.'
2025-07-26 21:57:31,098 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:31,098 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 600
2025-07-26 21:57:31,098 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) with no load, makin...'
2025-07-26 21:57:31,098 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:31,098 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:31,098 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:31,098 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:31,098 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:31,098 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538251.098254}
2025-07-26 21:57:31,098 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:57:31,200 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:31,200 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:57:31,495 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle and positioned at P0 (RawMaterial warehouse) with no load. The raw materials action queue indicates that the next product to process is "prod_2_51dec7be." According to the workflow and decision priorities, the appropriate action is to load this product using the required product_id. AGV_2 is available but not required for any higher-priority action and only one command is allowed per request.'
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 557
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle and positioned at P0 (RawMaterial ware...'
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:31,616 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:31,617 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:31,617 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:31,617 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538251.617138}
2025-07-26 21:57:31,617 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:31,718 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:31,719 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1']
2025-07-26 21:57:32,396 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:32,400 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at StationA (P1) and is loaded, indicating it has transported raw material to the correct processing point. The immediate required action, based on flow priority and station location, is to unload this material at P1 to start the production process. AGV_2, while available and idle, is not needed for this specific single action at present. Only AGV_1 receives a command.'
2025-07-26 21:57:32,401 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:32,401 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 496
2025-07-26 21:57:32,401 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at StationA (P1) and is loaded, indicating it has transported raw material ...'
2025-07-26 21:57:32,401 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:32,401 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]'
2025-07-26 21:57:32,401 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:32,401 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:32,401 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:32,401 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV1_P1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538252.401708}
2025-07-26 21:57:32,402 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV1_P1 - unload for AGV_1
2025-07-26 21:57:32,504 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:32,504 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:57:33,191 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.85, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.73, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,307 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7e24bdf5', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 710.0}
2025-07-26 21:57:33,307 - order - INFO - [order.py:245] - Created order order_7e24bdf5 with 1 products
2025-07-26 21:57:33,307 - order - INFO - [order.py:339] - Assigned 1 products from order order_7e24bdf5 to line1
2025-07-26 21:57:33,307 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_7e24bdf5 with 1 products to line1
2025-07-26 21:57:33,308 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.8, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.58, 'total_orders': 21, 'completed_orders': 0, 'active_orders': 21, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,593 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_89ed4fab', 'created_at': 110.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2060.0}
2025-07-26 21:57:33,594 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:33,594 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.85, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.73, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,594 - order - INFO - [order.py:245] - Created order order_89ed4fab with 3 products
2025-07-26 21:57:33,595 - order - INFO - [order.py:339] - Assigned 3 products from order order_89ed4fab to line2
2025-07-26 21:57:33,595 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_89ed4fab with 3 products to line2
2025-07-26 21:57:33,595 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.8, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.58, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,595 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 114.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.82, 'first_pass_rate': 0.0, 'total_production_cost': 66.63, 'material_costs': 40.0, 'energy_costs': 26.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.82, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,750 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 114.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.6, 'first_pass_rate': 0.0, 'total_production_cost': 67.63, 'material_costs': 40.0, 'energy_costs': 27.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.8, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,750 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.85, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.73, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:33,861 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240628_agv1_unload', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 21:57:33,861 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_unload response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 21:57:34,116 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7e24bdf5', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 710.0}
2025-07-26 21:57:34,116 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.8, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.58, 'total_orders': 21, 'completed_orders': 0, 'active_orders': 21, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,231 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_89ed4fab', 'created_at': 110.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2060.0}
2025-07-26 21:57:34,345 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.8, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.58, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,347 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 114.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.82, 'first_pass_rate': 0.0, 'total_production_cost': 66.63, 'material_costs': 40.0, 'energy_costs': 26.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.82, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,348 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 114.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.6, 'first_pass_rate': 0.0, 'total_production_cost': 67.63, 'material_costs': 40.0, 'energy_costs': 27.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.8, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,641 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 116.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 82.63, 'material_costs': 55.0, 'energy_costs': 27.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.51, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,838 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has no current load. The highest priority action is to load the raw material with product_id "prod_2_51dec7be". This matches the current workflow and fulfills the requirement to specify the exact product ID when issuing a load command from P0. AGV_2 remains available, but only one command per request is permitted.'
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 511
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has ...'
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:34,841 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:34,841 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:34,842 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:34,842 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538254.842077}
2025-07-26 21:57:34,842 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:34,921 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7e24bdf5', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 710.0}
2025-07-26 21:57:34,923 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.8, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.58, 'total_orders': 21, 'completed_orders': 0, 'active_orders': 21, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,924 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_89ed4fab', 'created_at': 110.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2060.0}
2025-07-26 21:57:34,924 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.8, 'first_pass_rate': 0.0, 'total_production_cost': 65.63, 'material_costs': 40.0, 'energy_costs': 25.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 20.58, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,924 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 114.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.82, 'first_pass_rate': 0.0, 'total_production_cost': 66.63, 'material_costs': 40.0, 'energy_costs': 26.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.82, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:34,943 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:34,944 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2']
2025-07-26 21:57:35,904 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240618_unload_AGV1_P1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 21:57:35,904 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_unload_AGV1_P1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 21:57:35,905 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240618_unload_AGV1_P1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 21:57:35,905 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_unload_AGV1_P1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 21:57:35,906 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 116.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 82.63, 'material_costs': 55.0, 'energy_costs': 27.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.51, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:37,067 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_51dec7be not found in warehouse buffer.'}
2025-07-26 21:57:37,068 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_51dec7be not found in warehouse buffer.
2025-07-26 21:57:37,262 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 117.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_51dec7beÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 47.2%'}
2025-07-26 21:57:37,262 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_51dec7beÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 47.2%
2025-07-26 21:57:37,566 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 114.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.6, 'first_pass_rate': 0.0, 'total_production_cost': 67.63, 'material_costs': 40.0, 'energy_costs': 27.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.8, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:37,567 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:37,567 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:37,567 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:37,567 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:37,568 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:37,568 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:37,568 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 116.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:37,568 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:37,568 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 116.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 82.63, 'material_costs': 55.0, 'energy_costs': 27.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.51, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,310 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:38,457 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.62, 'first_pass_rate': 0.0, 'total_production_cost': 83.63, 'material_costs': 55.0, 'energy_costs': 28.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.97, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,833 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.87, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.96, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,833 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.62, 'first_pass_rate': 0.0, 'total_production_cost': 83.63, 'material_costs': 55.0, 'energy_costs': 28.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.97, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,834 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.87, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.96, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,835 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_79a3b443', 'created_at': 120.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 870.0}
2025-07-26 21:57:38,835 - order - INFO - [order.py:245] - Created order order_79a3b443 with 1 products
2025-07-26 21:57:38,835 - order - INFO - [order.py:339] - Assigned 1 products from order order_79a3b443 to line3
2025-07-26 21:57:38,835 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_79a3b443 with 1 products to line3
2025-07-26 21:57:38,951 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_79a3b443', 'created_at': 120.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 870.0}
2025-07-26 21:57:38,952 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.84, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.86, 'total_orders': 23, 'completed_orders': 0, 'active_orders': 23, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,954 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.84, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.86, 'total_orders': 23, 'completed_orders': 0, 'active_orders': 23, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:38,955 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c7239e32', 'created_at': 120.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1200.0}
2025-07-26 21:57:38,955 - order - INFO - [order.py:245] - Created order order_c7239e32 with 2 products
2025-07-26 21:57:38,955 - order - INFO - [order.py:339] - Assigned 2 products from order order_c7239e32 to line1
2025-07-26 21:57:38,955 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_c7239e32 with 2 products to line1
2025-07-26 21:57:39,022 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:39,071 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c7239e32', 'created_at': 120.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1200.0}
2025-07-26 21:57:39,071 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.84, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.86, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:39,072 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 121.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 85.63, 'material_costs': 55.0, 'energy_costs': 30.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.69, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:39,679 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.84, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.86, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:39,680 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 121.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:39,680 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:39,680 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 121.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 85.63, 'material_costs': 55.0, 'energy_costs': 30.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.69, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:39,726 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) with no load, making it the optimal AGV for the next raw material handling operation. The action list specifies prod_2_51dec7be as the next product to be loaded. According to the workflow, raw material loading is the highest priority available action at this step. AGV_1 is idle at P1 but not positioned at the raw material source, so AGV_2 is given the load command for prod_2_51dec7be to continue efficient production. Only one command is generated as required.'
2025-07-26 21:57:39,726 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:39,726 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 644
2025-07-26 21:57:39,726 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) with no load, makin...'
2025-07-26 21:57:39,726 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:39,726 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:39,727 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:39,727 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:39,727 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:39,727 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538259.72723}
2025-07-26 21:57:39,727 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:57:39,829 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:39,829 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2']
2025-07-26 21:57:40,110 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:40,415 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle and ready at P0 (RawMaterial warehouse) without any load, and the action queue specifies "prod_2_51dec7be" as the next raw material to process. According to the decision logic, the highest priority action is to load this product, and the command must include the exact product_id. As per process instructions, only one command is sent per request and AGV_2 remains available since it is not required for any higher-priority operation at this step.'
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 609
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]

**Explanation:**  
AGV_1 is idle and ready at P0 (RawMaterial warehouse...'
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_51dec7be","action":"load","target":"AGV_1","params":{"product_id":"prod_2_51dec7be"}}]'
2025-07-26 21:57:40,420 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:40,420 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:40,420 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:40,421 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_51dec7be', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_51dec7be'}, 'timestamp': 1753538260.420791}
2025-07-26 21:57:40,421 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_51dec7be - load for AGV_1
2025-07-26 21:57:40,523 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:40,523 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1']
2025-07-26 21:57:40,620 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:40,625 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at StationA (P1) and has a raw material loaded. The correct next action is to unload this material at P1 to continue the production flow. This matches the decision priority to deliver materials where needed. AGV_2 is idle at P0 and not involved, since only one action is requested and AGV_1 has priority due to its current status and location.'
2025-07-26 21:57:40,625 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:40,625 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 468
2025-07-26 21:57:40,625 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at StationA (P1) and has a raw material loaded. The correct next action is ...'
2025-07-26 21:57:40,626 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:40,626 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV1_P1","action":"unload","target":"AGV_1","params":{}}]'
2025-07-26 21:57:40,626 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:40,626 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:40,626 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:40,626 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV1_P1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538260.626427}
2025-07-26 21:57:40,626 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV1_P1 - unload for AGV_1
2025-07-26 21:57:40,727 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:40,727 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:57:40,932 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 117.0, 'command_id': 'flow_20240618_unload_AGV1_P1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_9510e82eÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 36.5%'}
2025-07-26 21:57:40,933 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_unload_AGV1_P1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_9510e82eÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 36.5%
2025-07-26 21:57:41,007 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:41,044 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.62, 'first_pass_rate': 0.0, 'total_production_cost': 83.63, 'material_costs': 55.0, 'energy_costs': 28.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.97, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:41,045 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.87, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.96, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:41,045 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 123.0, 'command_id': 'flow_20240624_load_prod2_51dec7be', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:57:41,045 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_51dec7be response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:57:41,046 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_79a3b443', 'created_at': 120.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 870.0}
2025-07-26 21:57:41,166 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.84, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.86, 'total_orders': 23, 'completed_orders': 0, 'active_orders': 23, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:41,168 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c7239e32', 'created_at': 120.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1200.0}
2025-07-26 21:57:41,458 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 123.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_51dec7be not found in warehouse buffer.'}
2025-07-26 21:57:41,458 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_51dec7be not found in warehouse buffer.
2025-07-26 21:57:41,720 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:41,981 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 124.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.61, 'first_pass_rate': 0.0, 'total_production_cost': 86.63, 'material_costs': 55.0, 'energy_costs': 31.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.19, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:41,981 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 124.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.4, 'first_pass_rate': 0.0, 'total_production_cost': 87.63, 'material_costs': 55.0, 'energy_costs': 32.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.18, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:42,104 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 124.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.61, 'first_pass_rate': 0.0, 'total_production_cost': 86.63, 'material_costs': 55.0, 'energy_costs': 31.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.19, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:42,216 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 124.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.4, 'first_pass_rate': 0.0, 'total_production_cost': 87.63, 'material_costs': 55.0, 'energy_costs': 32.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.18, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:42,301 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.84, 'first_pass_rate': 0.0, 'total_production_cost': 84.63, 'material_costs': 55.0, 'energy_costs': 29.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.86, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:42,303 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 121.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.51, 'first_pass_rate': 0.0, 'total_production_cost': 85.63, 'material_costs': 55.0, 'energy_costs': 30.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.69, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:42,304 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 123.0, 'command_id': 'flow_20240618_unload_AGV1_P1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 21:57:42,304 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_unload_AGV1_P1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 21:57:42,507 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 124.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.61, 'first_pass_rate': 0.0, 'total_production_cost': 86.63, 'material_costs': 55.0, 'energy_costs': 31.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.19, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:42,509 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 124.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.4, 'first_pass_rate': 0.0, 'total_production_cost': 87.63, 'material_costs': 55.0, 'energy_costs': 32.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 18.18, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:43,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 126.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.57, 'first_pass_rate': 0.0, 'total_production_cost': 88.63, 'material_costs': 55.0, 'energy_costs': 33.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.93, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:43,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 126.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.57, 'first_pass_rate': 0.0, 'total_production_cost': 88.63, 'material_costs': 55.0, 'energy_costs': 33.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.93, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:43,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 126.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.57, 'first_pass_rate': 0.0, 'total_production_cost': 88.63, 'material_costs': 55.0, 'energy_costs': 33.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.93, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:45,427 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:45,430 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and located at the RawMaterial warehouse (P0) with no load. With new raw materials available, and according to the decision logic, the next required action is to load a specific raw material at P0. AGV_2 is chosen for this task (since AGV_1 is now at P1, empty and not in position to load). The specific product to load is "prod_2_932e77b9", which is next in the action queue. AGV_1 will remain idle at P1 until another action is required of it.'
2025-07-26 21:57:45,431 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:45,431 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 609
2025-07-26 21:57:45,431 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and located at the RawMaterial wareh...'
2025-07-26 21:57:45,431 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:45,431 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:45,431 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:45,431 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:45,431 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:45,431 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538265.431592}
2025-07-26 21:57:45,431 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:57:45,532 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:45,533 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:57:46,700 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:46,704 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and ready at P0 (RawMaterial warehouse) with no load, positioning it perfectly for the next step in the production flow. The next product listed for raw material is prod_2_932e77b9. Since loading raw materials is a priority action and AGV_2 meets all the conditions for loading at P0, the optimal command is to have AGV_2 load this product. AGV_1 is at P1 with no load but cannot perform the raw material pickup since it is not at P0. This command ensures continuous material supply for efficient production.'
2025-07-26 21:57:46,705 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:46,705 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 659
2025-07-26 21:57:46,705 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and ready at P0 (RawMaterial warehouse) with no l...'
2025-07-26 21:57:46,705 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:46,705 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:46,705 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:46,705 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:46,705 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:46,705 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538266.705671}
2025-07-26 21:57:46,705 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:57:46,807 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:46,807 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2']
2025-07-26 21:57:46,902 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 129.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.66, 'first_pass_rate': 0.0, 'total_production_cost': 89.63, 'material_costs': 55.0, 'energy_costs': 34.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.48, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:46,902 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 129.6, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.87, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.46, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:47,342 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 129.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.66, 'first_pass_rate': 0.0, 'total_production_cost': 89.63, 'material_costs': 55.0, 'energy_costs': 34.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.48, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:47,343 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 129.6, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.87, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.46, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:47,364 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 129.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.66, 'first_pass_rate': 0.0, 'total_production_cost': 89.63, 'material_costs': 55.0, 'energy_costs': 34.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.48, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:47,365 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 129.6, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.87, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.46, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:57:47,971 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and is empty (load:0). According to the workflow, the next high-priority task is to load the next raw material for production, which is "prod_2_932e77b9." This command fulfills that need, specifying the correct product_id. AGV_2 remains available but is not needed for this specific raw material loading task, and only one command is allowed per request.'
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 546
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and is e...'
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:47,976 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:47,976 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:47,977 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:47,977 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538267.977078}
2025-07-26 21:57:47,977 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:57:48,078 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:48,079 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1']
2025-07-26 21:57:49,077 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:49,080 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, empty, and already at the RawMaterial warehouse (P0), making it the optimal choice to load the next available raw material. The next product in the queue is "prod_2_932e77b9". AGV_1 is idle at P1, which is not a loading point, so it isn't chosen for this action. Following the decision logic, AGV_2 will load the specified raw material, enabling efficient throughput for the production line. AGV_1 remains idle at P1 until further action is required.'
2025-07-26 21:57:49,081 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:49,081 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 615
2025-07-26 21:57:49,081 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, empty, and already at the RawMateri...'
2025-07-26 21:57:49,081 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:49,081 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:49,081 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:49,081 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:49,081 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:49,081 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538269.081632}
2025-07-26 21:57:49,082 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:57:49,183 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:57:49,184 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:57:51,612 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:52,089 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:52,229 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle, positioned at P0 (RawMaterial warehouse), and currently not carrying any load. According to the decision logic, the next action is to load the next raw material for production, which is "prod_2_932e77b9." The command includes the required product_id as specified in the workflow. AGV_2 remains available, but since only one action is needed per request and there is no higher-priority task for AGV_2 at this moment, no command is issued to it.'
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 606
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle, positioned at P0 (RawMaterial warehou...'
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:52,232 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:52,232 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:52,232 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:52,233 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538272.232836}
2025-07-26 21:57:52,233 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:57:52,334 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:52,335 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1']
2025-07-26 21:57:52,990 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) and has no load, making it the best candidate to load the next raw material. The highest priority action in the workflow is to continue feeding StationA with raw materials, and the next product required is prod_2_932e77b9. AGV_1 is idle at P1 but cannot load from raw material because it is not at P0. Therefore, the optimal command is for AGV_2 to load prod_2_932e77b9 and keep production flowing efficiently. Only one action is needed, so AGV_2 is assigned the command.'
2025-07-26 21:57:52,990 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:52,990 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 652
2025-07-26 21:57:52,990 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) and has no load, ma...'
2025-07-26 21:57:52,990 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:52,991 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:52,991 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:52,991 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:52,991 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:52,991 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538272.991589}
2025-07-26 21:57:52,991 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:57:53,093 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:53,094 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2']
2025-07-26 21:57:53,652 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:54,563 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:57:56,858 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:57,497 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:57,840 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, available, and positioned at the RawMaterial warehouse (P0) without a load, making it the correct choice for handling the next raw material action. The current production need is to load "prod_2_932e77b9" from the available list. AGV_1 is idle at P1, but not at a loading point. Therefore, AGV_2 is dispatched to load the specified raw material and continue supporting optimal production flow.'
2025-07-26 21:57:57,840 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:57,840 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 558
2025-07-26 21:57:57,841 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, available, and positioned at the Ra...'
2025-07-26 21:57:57,841 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:57,841 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:57,841 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:57,841 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:57:57,841 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:57:57,842 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538277.84177}
2025-07-26 21:57:57,842 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:57:57,943 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:57,943 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:57:58,234 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and not carrying a load. The next highest priority action is to load the next raw material, "prod_2_932e77b9." This command fulfills the rule to specify the product_id and maintains the correct process flow. AGV_2, while available, is not needed for this action as only one step is requested and there are no higher-priority or special tasks for it.'
2025-07-26 21:57:58,235 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:58,235 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 543
2025-07-26 21:57:58,235 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and no...'
2025-07-26 21:57:58,235 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:58,235 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:58,235 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:58,235 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:57:58,235 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:57:58,235 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538278.235397}
2025-07-26 21:57:58,235 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:57:58,337 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:58,337 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1']
2025-07-26 21:57:59,428 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:57:59,524 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) and has no load, which makes it the best candidate to execute the next raw material pickup. The highest priority available action is to keep feeding the production line by loading the next required raw material, prod_2_932e77b9, from P0. AGV_1 is idle at P1 but cannot participate in raw material handling at this step. Only one action is required, so AGV_2 is assigned this load command to maintain continuous production.'
2025-07-26 21:57:59,524 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:57:59,524 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 603
2025-07-26 21:57:59,524 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle at P0 (RawMaterial warehouse) and has no load, wh...'
2025-07-26 21:57:59,525 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:57:59,525 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:57:59,525 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:57:59,525 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:57:59,525 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:57:59,525 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538279.52556}
2025-07-26 21:57:59,525 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:57:59,627 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:57:59,628 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2']
2025-07-26 21:58:01,040 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:02,035 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:02,529 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle, at P0 (RawMaterial warehouse), and not carrying a load. According to the workflow and the list of next actions, the highest priority is to load the next raw material‚Äî"prod_2_932e77b9"‚Äîby specifying its product_id in the load command. AGV_2 is available but not required, as only one action is allowed per request and there are no higher-priority tasks.'
2025-07-26 21:58:02,529 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:02,529 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 515
2025-07-26 21:58:02,529 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle, at P0 (RawMaterial warehouse), and no...'
2025-07-26 21:58:02,529 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:02,530 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:02,530 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:02,530 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:02,530 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:02,530 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538282.530275}
2025-07-26 21:58:02,530 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:58:02,631 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:02,632 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1']
2025-07-26 21:58:02,952 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:02,956 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, available, and positioned at the RawMaterial warehouse (P0) with no load, making it the appropriate choice for loading the next specified raw material ("prod_2_932e77b9"). This aligns with the decision logic, which prioritizes loading raw materials to keep production flowing efficiently. AGV_1 is idle but located at P1 and cannot load raw material at its current location, so AGV_2 is assigned the action.'
2025-07-26 21:58:02,956 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:02,956 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 572
2025-07-26 21:58:02,956 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, available, and positioned at the Ra...'
2025-07-26 21:58:02,957 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:02,957 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:02,957 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:02,957 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:02,957 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:02,957 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538282.957386}
2025-07-26 21:58:02,957 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:58:03,058 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:03,058 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:58:03,076 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and located at P0 (RawMaterial warehouse) with no load, making it the optimal choice to perform the next raw material load. The action list requires prod_2_932e77b9 to be loaded next. AGV_1 is idle at P1 but not at the raw material warehouse, and thus unable to perform this step. The command enables continuous feeding of StationA for maximum production flow, in line with the highest production priority currently available. Only one command is needed, so AGV_2 is selected for this operation.'
2025-07-26 21:58:03,076 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:03,077 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 646
2025-07-26 21:58:03,077 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and located at P0 (RawMaterial warehouse) with no...'
2025-07-26 21:58:03,077 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:03,077 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:03,077 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:03,077 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:03,077 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:03,077 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538283.077347}
2025-07-26 21:58:03,077 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:58:03,178 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:03,179 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2']
2025-07-26 21:58:04,913 - openai.agents - WARNING - [processors.py:137] - [non-fatal] Tracing: request failed: _ssl.c:989: The handshake operation timed out
2025-07-26 21:58:05,931 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:06,097 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:06,292 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, available, and at the correct loading location (P0), making it optimal for the next raw material pickup. The next raw material in the queue is "prod_2_932e77b9." AGV_1 is idle at P1, which is not a loading position and therefore not considered for this action. Commanding AGV_2 to load "prod_2_932e77b9" keeps the production flow efficient and aligns perfectly with the workflow priorities.'
2025-07-26 21:58:06,292 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:06,292 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 555
2025-07-26 21:58:06,292 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle, available, and at the correct loadi...'
2025-07-26 21:58:06,292 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:06,292 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:06,293 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:06,293 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:06,293 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:06,293 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538286.293214}
2025-07-26 21:58:06,293 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:58:06,395 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:06,396 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3']
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle and empty. The next step in the workflow, following the priority rules, is to load the next raw material‚Äî"prod_2_932e77b9"‚Äîspecifying its exact product_id. This command fulfills the current production need. AGV_2 remains available for any future tasks, but only one command can be issued per request and there are no other higher priorities at this moment.'
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 549
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle and emp...'
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:06,624 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:06,624 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:06,624 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:06,625 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538286.624943}
2025-07-26 21:58:06,625 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:58:06,726 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:06,726 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1']
2025-07-26 21:58:07,521 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:08,196 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:08,199 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is currently idle at P0 (RawMaterial warehouse) and has no load, so it is optimally positioned to pick up the next required raw material for production. The priority action is to keep the flow of materials feeding StationA, and the next product to load is prod_2_932e77b9. AGV_1, while available, is at P1 and not at P0, and thus cannot perform the loading action. Only one command may be issued per the request, so AGV_2 is given the instruction to load prod_2_932e77b9, ensuring uninterrupted production flow.'
2025-07-26 21:58:08,199 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:08,199 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 654
2025-07-26 21:58:08,199 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is currently idle at P0 (RawMaterial warehouse) and has n...'
2025-07-26 21:58:08,199 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:08,200 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:08,200 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:08,200 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:08,200 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:08,200 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538288.200478}
2025-07-26 21:58:08,200 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:58:08,302 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:08,302 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2']
2025-07-26 21:58:08,534 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4b4bd7bc', 'created_at': 130.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1330.0}
2025-07-26 21:58:08,534 - order - INFO - [order.py:245] - Created order order_4b4bd7bc with 2 products
2025-07-26 21:58:08,535 - order - INFO - [order.py:339] - Assigned 2 products from order order_4b4bd7bc to line2
2025-07-26 21:58:08,535 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_4b4bd7bc with 2 products to line2
2025-07-26 21:58:08,716 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4b4bd7bc', 'created_at': 130.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1330.0}
2025-07-26 21:58:08,718 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.86, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.41, 'total_orders': 25, 'completed_orders': 0, 'active_orders': 25, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:08,951 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_0b53a435', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1570.0}
2025-07-26 21:58:08,951 - order - INFO - [order.py:245] - Created order order_0b53a435 with 3 products
2025-07-26 21:58:08,951 - order - INFO - [order.py:339] - Assigned 3 products from order order_0b53a435 to line3
2025-07-26 21:58:08,951 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_0b53a435 with 3 products to line3
2025-07-26 21:58:08,951 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.86, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,026 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 131.1756343148229, 'device_id': 'AGV_1', 'alert_type': 'fault_injected', 'symptom': 'AGV Stuck', 'fault_type': 'agv_fault', 'estimated_duration': 34.76862018740134, 'message': 'Device AGV_1 has fault: AGV Stuck'}
2025-07-26 21:58:09,026 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 131.18, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.71, 'first_pass_rate': 0.0, 'total_production_cost': 98.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.25, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,027 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 131.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.5, 'first_pass_rate': 0.0, 'total_production_cost': 99.63, 'material_costs': 55.0, 'energy_costs': 36.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.24, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,055 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.47, 'first_pass_rate': 0.0, 'total_production_cost': 99.63, 'material_costs': 55.0, 'energy_costs': 36.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.15, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 1}
2025-07-26 21:58:09,056 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.6, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.59, 'first_pass_rate': 0.0, 'total_production_cost': 100.63, 'material_costs': 55.0, 'energy_costs': 37.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.82, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 1}
2025-07-26 21:58:09,058 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.86, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.41, 'total_orders': 25, 'completed_orders': 0, 'active_orders': 25, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,090 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:09,341 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4b4bd7bc', 'created_at': 130.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1330.0}
2025-07-26 21:58:09,341 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.7, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.59, 'first_pass_rate': 100.0, 'total_production_cost': 100.63, 'material_costs': 55.0, 'energy_costs': 37.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.8, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,342 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.86, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.41, 'total_orders': 25, 'completed_orders': 0, 'active_orders': 25, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,342 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.7, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.39, 'first_pass_rate': 100.0, 'total_production_cost': 101.63, 'material_costs': 55.0, 'energy_costs': 38.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.8, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,444 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 136.4, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.53, 'first_pass_rate': 100.0, 'total_production_cost': 102.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.59, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,445 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 139.11, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.45, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.27, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,546 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5a17bcc7', 'created_at': 140.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1370.0}
2025-07-26 21:58:09,547 - order - INFO - [order.py:245] - Created order order_5a17bcc7 with 2 products
2025-07-26 21:58:09,547 - order - INFO - [order.py:339] - Assigned 2 products from order order_5a17bcc7 to line1
2025-07-26 21:58:09,548 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_5a17bcc7 with 2 products to line1
2025-07-26 21:58:09,767 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.7, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 27, 'completed_orders': 1, 'active_orders': 26, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,767 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_0b53a435', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1570.0}
2025-07-26 21:58:09,768 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:09,770 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.86, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,771 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_736137cb', 'created_at': 140.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2240.0}
2025-07-26 21:58:09,771 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 131.18, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.71, 'first_pass_rate': 0.0, 'total_production_cost': 98.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.25, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,771 - order - INFO - [order.py:245] - Created order order_736137cb with 3 products
2025-07-26 21:58:09,772 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 131.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.5, 'first_pass_rate': 0.0, 'total_production_cost': 99.63, 'material_costs': 55.0, 'energy_costs': 36.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.24, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,772 - order - INFO - [order.py:339] - Assigned 3 products from order order_736137cb to line2
2025-07-26 21:58:09,773 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_736137cb with 3 products to line2
2025-07-26 21:58:09,773 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.12, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,773 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.48, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,937 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.48, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.32, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 2}
2025-07-26 21:58:09,938 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.47, 'first_pass_rate': 0.0, 'total_production_cost': 99.63, 'material_costs': 55.0, 'energy_costs': 36.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.15, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 1}
2025-07-26 21:58:09,939 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.6, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.59, 'first_pass_rate': 0.0, 'total_production_cost': 100.63, 'material_costs': 55.0, 'energy_costs': 37.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.82, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 1}
2025-07-26 21:58:09,939 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.3, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:09,939 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.7, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.59, 'first_pass_rate': 100.0, 'total_production_cost': 100.63, 'material_costs': 55.0, 'energy_costs': 37.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.8, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,939 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.48, 'first_pass_rate': 100.0, 'total_production_cost': 111.63, 'material_costs': 55.0, 'energy_costs': 40.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:09,940 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.7, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.39, 'first_pass_rate': 100.0, 'total_production_cost': 101.63, 'material_costs': 55.0, 'energy_costs': 38.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.8, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,940 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 136.4, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.53, 'first_pass_rate': 100.0, 'total_production_cost': 102.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.59, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:09,949 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_0b53a435', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1570.0}
2025-07-26 21:58:09,949 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.86, 'first_pass_rate': 0.0, 'total_production_cost': 90.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,949 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 131.18, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.71, 'first_pass_rate': 0.0, 'total_production_cost': 98.63, 'material_costs': 55.0, 'energy_costs': 35.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.25, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:09,957 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:09,959 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
The highest-priority action required now is to load raw material for production. AGV_2 is idle, empty, and correctly positioned at P0 (RawMaterial warehouse), making it the optimal choice to perform the next load. The next item in the queue for loading is "prod_2_932e77b9". AGV_1 is idle but is located at P1 (StationA) and cannot perform a raw material load action from that position. This command keeps production flow continuous and matches the current plant decision logic.'
2025-07-26 21:58:09,959 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:09,960 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 628
2025-07-26 21:58:09,960 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
The highest-priority action required now is to loa...'
2025-07-26 21:58:09,960 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:09,960 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:09,960 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:09,960 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:09,960 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:09,960 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538289.960334}
2025-07-26 21:58:09,960 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:58:10,062 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:10,062 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1']
2025-07-26 21:58:10,085 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:10,292 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 131.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.5, 'first_pass_rate': 0.0, 'total_production_cost': 99.63, 'material_costs': 55.0, 'energy_costs': 36.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.24, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 0}
2025-07-26 21:58:10,293 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.5, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.26, 'first_pass_rate': 100.0, 'total_production_cost': 112.63, 'material_costs': 55.0, 'energy_costs': 41.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.0, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:10,294 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.47, 'first_pass_rate': 0.0, 'total_production_cost': 99.63, 'material_costs': 55.0, 'energy_costs': 36.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.15, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 1}
2025-07-26 21:58:10,295 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.6, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.29, 'first_pass_rate': 100.0, 'total_production_cost': 113.63, 'material_costs': 55.0, 'energy_costs': 42.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.44, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:10,297 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.6, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.59, 'first_pass_rate': 0.0, 'total_production_cost': 100.63, 'material_costs': 55.0, 'energy_costs': 37.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.82, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 0, 'active_faults': 1}
2025-07-26 21:58:10,297 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.97, 'first_pass_rate': 100.0, 'total_production_cost': 113.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.32, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:10,298 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.7, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.59, 'first_pass_rate': 100.0, 'total_production_cost': 100.63, 'material_costs': 55.0, 'energy_costs': 37.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.8, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:10,298 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 134.7, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.39, 'first_pass_rate': 100.0, 'total_production_cost': 101.63, 'material_costs': 55.0, 'energy_costs': 38.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.8, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:10,299 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.97, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.32, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:10,299 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 148.0, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.96, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.29, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:10,299 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 136.4, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.53, 'first_pass_rate': 100.0, 'total_production_cost': 102.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.59, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:10,300 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is available, idle, at P0 (RawMaterial warehouse), and currently not carrying anything. The next appropriate action by priority is to load the specified raw material "prod_2_932e77b9". The command is constructed as required for P0 loading‚Äîspecifying the exact product_id. AGV_2 is available but does not have a higher-priority task at this point, and only one command is allowed per request.'
2025-07-26 21:58:10,300 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 139.106783268095, 'device_id': 'Conveyor_AB', 'alert_type': 'fault_injected', 'symptom': 'Conveyor Stuck', 'fault_type': 'conveyor_fault', 'estimated_duration': 45.899586049618534, 'message': 'Device Conveyor_AB has fault: Conveyor Stuck'}
2025-07-26 21:58:10,300 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:10,300 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 545
2025-07-26 21:58:10,301 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 139.11, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.45, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.27, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:10,301 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is available, idle, at P0 (RawMaterial warehou...'
2025-07-26 21:58:10,301 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:10,301 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:10,301 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:10,301 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:10,301 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:10,302 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538290.3019}
2025-07-26 21:58:10,302 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:58:10,403 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:58:10,404 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1']
2025-07-26 21:58:10,429 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_2de2e150', 'created_at': 150.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 630.0}
2025-07-26 21:58:10,430 - order - INFO - [order.py:245] - Created order order_2de2e150 with 1 products
2025-07-26 21:58:10,431 - order - INFO - [order.py:339] - Assigned 1 products from order order_2de2e150 to line3
2025-07-26 21:58:10,431 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_2de2e150 with 1 products to line3
2025-07-26 21:58:10,432 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.9, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 29, 'completed_orders': 2, 'active_orders': 27, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:10,814 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:11,621 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:11,624 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and at P0 (RawMaterial warehouse) without any load, making it the correct AGV to handle the next raw material loading task. The priority per the action list is to load prod_2_932e77b9 from P0 to keep production flowing into StationA. AGV_1 is at P1 and cannot perform a load from P0 at this moment. Only one action is needed, so AGV_2 is given the command to load prod_2_932e77b9. This maximizes throughput and maintains continuous production operations.'
2025-07-26 21:58:11,624 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:11,624 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 605
2025-07-26 21:58:11,624 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
AGV_2 is idle and at P0 (RawMaterial warehouse) without any loa...'
2025-07-26 21:58:11,624 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:11,624 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_load", "action":"load", "target":"AGV_2", "params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:11,625 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:11,625 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:11,625 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:11,625 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_load', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538291.625244}
2025-07-26 21:58:11,625 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_load - load for AGV_2
2025-07-26 21:58:11,726 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:11,727 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3']
2025-07-26 21:58:11,866 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 139.11, 'order_completion_rate': 3.85, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.45, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.27, 'total_orders': 26, 'completed_orders': 1, 'active_orders': 25, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:11,866 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5a17bcc7', 'created_at': 140.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1370.0}
2025-07-26 21:58:11,867 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.7, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 27, 'completed_orders': 1, 'active_orders': 26, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:11,867 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5a17bcc7', 'created_at': 140.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1370.0}
2025-07-26 21:58:11,868 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.7, 'average_production_cycle': 6.76, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 27, 'completed_orders': 1, 'active_orders': 26, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:12,090 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_736137cb', 'created_at': 140.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2240.0}
2025-07-26 21:58:12,090 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.12, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:12,090 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.48, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:12,208 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.48, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.32, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 2}
2025-07-26 21:58:12,209 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.3, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:12,210 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.48, 'first_pass_rate': 100.0, 'total_production_cost': 111.63, 'material_costs': 55.0, 'energy_costs': 40.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:12,390 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.5, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.26, 'first_pass_rate': 100.0, 'total_production_cost': 112.63, 'material_costs': 55.0, 'energy_costs': 41.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.0, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:12,914 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_736137cb', 'created_at': 140.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2240.0}
2025-07-26 21:58:12,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.6, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.29, 'first_pass_rate': 100.0, 'total_production_cost': 113.63, 'material_costs': 55.0, 'energy_costs': 42.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.44, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:12,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.12, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:12,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.48, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.43, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 1}
2025-07-26 21:58:12,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.97, 'first_pass_rate': 100.0, 'total_production_cost': 113.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.32, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:12,917 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 3.57, 'average_production_cycle': 7.48, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.32, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.17, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 1, 'active_faults': 2}
2025-07-26 21:58:12,917 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.3, 'first_pass_rate': 100.0, 'total_production_cost': 110.63, 'material_costs': 55.0, 'energy_costs': 39.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,028 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 147.7034077201287, 'device_id': 'QualityCheck', 'alert_type': 'fault_injected', 'symptom': 'Station Vibration', 'fault_type': 'station_fault', 'estimated_duration': 31.272659209987836, 'message': 'Device QualityCheck has fault: Station Vibration'}
2025-07-26 21:58:13,029 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.97, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.32, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,030 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.48, 'first_pass_rate': 100.0, 'total_production_cost': 111.63, 'material_costs': 55.0, 'energy_costs': 40.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,030 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 148.0, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.96, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.29, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:13,031 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.5, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.26, 'first_pass_rate': 100.0, 'total_production_cost': 112.63, 'material_costs': 55.0, 'energy_costs': 41.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.0, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,031 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.6, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.29, 'first_pass_rate': 100.0, 'total_production_cost': 113.63, 'material_costs': 55.0, 'energy_costs': 42.63, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.44, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,273 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_2de2e150', 'created_at': 150.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 630.0}
2025-07-26 21:58:13,273 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.9, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 29, 'completed_orders': 2, 'active_orders': 27, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:13,437 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c5ff963e', 'created_at': 150.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 790.0}
2025-07-26 21:58:13,437 - order - INFO - [order.py:245] - Created order order_c5ff963e with 2 products
2025-07-26 21:58:13,437 - order - INFO - [order.py:339] - Assigned 2 products from order order_c5ff963e to line1
2025-07-26 21:58:13,438 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_c5ff963e with 2 products to line1
2025-07-26 21:58:13,701 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.37, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:13,702 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:13,960 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.97, 'first_pass_rate': 100.0, 'total_production_cost': 113.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.32, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,960 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.7, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.97, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.32, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:13,960 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 148.0, 'order_completion_rate': 7.14, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.96, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.29, 'total_orders': 28, 'completed_orders': 2, 'active_orders': 26, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:14,003 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has no load. The highest priority action is to load the next raw material for production: "prod_2_932e77b9", as specified in the actions. The command uses the exact required product_id for loading from P0 per workflow rules. AGV_2 is also available, but no higher-priority task is pending for it and only one action is permitted per request.'
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 537
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has ...'
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:14,007 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:14,007 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:14,008 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:14,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538294.008048}
2025-07-26 21:58:14,008 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:58:14,108 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:14,109 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1']
2025-07-26 21:58:14,160 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 151.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.79, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.99, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:14,269 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:14,270 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:14,270 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:14,270 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:14,270 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:14,270 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:14,270 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:14,270 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:14,271 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 152.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_932e77b9Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%'}
2025-07-26 21:58:14,271 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_932e77b9Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%
2025-07-26 21:58:14,774 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_2de2e150', 'created_at': 150.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 630.0}
2025-07-26 21:58:14,775 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.9, 'average_production_cycle': 4.27, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 29, 'completed_orders': 2, 'active_orders': 27, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:14,779 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c5ff963e', 'created_at': 150.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 790.0}
2025-07-26 21:58:14,779 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.37, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:15,007 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:15,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:15,008 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:15,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:15,008 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:15,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:15,008 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:15,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:15,008 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:15,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:15,008 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:15,240 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 151.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.79, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.99, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:15,240 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 154.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:15,240 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:15,535 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:15,782 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
Both AGVs are idle, but only AGV_2 is at the raw material warehouse (P0), which is the required position to perform a load from raw materials. The action priority is to load the next raw material for production, which is "prod_2_932e77b9". AGV_1 is at P1 and thus cannot perform this action. This command allows AGV_2 to initiate the next cycle of raw material transport efficiently.'
2025-07-26 21:58:15,783 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:15,783 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 533
2025-07-26 21:58:15,783 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]

Explanation:  
Both AGVs are idle, but only AGV_2 is at the raw m...'
2025-07-26 21:58:15,783 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:15,783 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_load_AGV2_prod_2_932e77b9","action":"load","target":"AGV_2","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:15,783 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:15,783 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:15,783 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:15,783 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538295.783299}
2025-07-26 21:58:15,783 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_2_932e77b9 - load for AGV_2
2025-07-26 21:58:15,885 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:15,886 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:16,720 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:16,773 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p8", "action":"move", "target":"AGV_2", "params":{"target_point":"P8"}}]

Explanation:  
Only AGV_2 is available since AGV_1 is in FAULT state. There are finished products (2) at QualityCheck that have priority over raw materials based on the decision logic. The required first step for finished products is to move the available AGV to P8 (QualityCheck output) to collect them. Therefore, the MOVE command is issued for AGV_2 to proceed to P8. When it arrives, subsequent load/unload actions can be performed. Only one command is issued for the available AGV as required.'
2025-07-26 21:58:16,773 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:16,773 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 612
2025-07-26 21:58:16,773 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p8", "action":"move", "target":"AGV_2", "params":{"target_point":"P8"}}]

Explanation:  
Only AGV_2 is available since AGV_1 is in FAULT state. There are finish...'
2025-07-26 21:58:16,773 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:16,774 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p8", "action":"move", "target":"AGV_2", "params":{"target_point":"P8"}}]'
2025-07-26 21:58:16,774 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:16,774 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:16,774 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:16,774 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753538296.774339}
2025-07-26 21:58:16,774 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p8 - move for AGV_2
2025-07-26 21:58:16,876 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:16,877 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3']
2025-07-26 21:58:17,116 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 154.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:17,116 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:17,886 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c5ff963e', 'created_at': 150.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 790.0}
2025-07-26 21:58:17,887 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.37, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:17,887 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.91, 'first_pass_rate': 100.0, 'total_production_cost': 121.83, 'material_costs': 55.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.09, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:17,999 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 151.0, 'order_completion_rate': 6.67, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.79, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.99, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:18,000 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:18,000 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:18,000 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:18,000 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:18,000 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:18,000 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:18,001 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:18,001 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:18,001 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 151.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:18,001 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:18,001 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 159.0, 'command_id': 'flow_20240628_agv2_load', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:18,001 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_load response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:18,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_65095244', 'created_at': 160.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 910.0}
2025-07-26 21:58:18,155 - order - INFO - [order.py:245] - Created order order_65095244 with 1 products
2025-07-26 21:58:18,155 - order - INFO - [order.py:339] - Assigned 1 products from order order_65095244 to line2
2025-07-26 21:58:18,155 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:18,155 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_65095244 with 1 products to line2
2025-07-26 21:58:18,156 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_65095244', 'created_at': 160.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 910.0}
2025-07-26 21:58:18,156 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.45, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 31, 'completed_orders': 2, 'active_orders': 29, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:18,268 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.45, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 31, 'completed_orders': 2, 'active_orders': 29, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:18,269 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e82a9713', 'created_at': 160.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 480.0}
2025-07-26 21:58:18,270 - order - INFO - [order.py:245] - Created order order_e82a9713 with 1 products
2025-07-26 21:58:18,271 - order - INFO - [order.py:339] - Assigned 1 products from order order_e82a9713 to line3
2025-07-26 21:58:18,271 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_e82a9713 with 1 products to line3
2025-07-26 21:58:18,271 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not loaded. According to the workflow and priority, the next high-priority action is to load the specified raw material "prod_2_932e77b9" with the product_id clearly specified. No higher-priority actions exist and AGV_2 does not have a task, so only this single command is issued.'
2025-07-26 21:58:18,271 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:18,271 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 476
2025-07-26 21:58:18,272 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not ...'
2025-07-26 21:58:18,272 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:18,272 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_932e77b9","action":"load","target":"AGV_1","params":{"product_id":"prod_2_932e77b9"}}]'
2025-07-26 21:58:18,272 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:18,272 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:18,272 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:18,272 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_932e77b9', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_932e77b9'}, 'timestamp': 1753538298.272272}
2025-07-26 21:58:18,272 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_932e77b9 - load for AGV_1
2025-07-26 21:58:18,374 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:18,374 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1']
2025-07-26 21:58:18,378 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.58, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:18,379 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:18,415 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 160.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:18,415 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:18,903 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_65095244', 'created_at': 160.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 910.0}
2025-07-26 21:58:18,903 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.45, 'average_production_cycle': 4.47, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 31, 'completed_orders': 2, 'active_orders': 29, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:19,007 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e82a9713', 'created_at': 160.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 480.0}
2025-07-26 21:58:19,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.58, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:19,008 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:19,973 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e82a9713', 'created_at': 160.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 480.0}
2025-07-26 21:58:19,974 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.58, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:19,974 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.6, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 14.15, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 3}
2025-07-26 21:58:19,975 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 160.0, 'command_id': 'flow_20240618_load_AGV2_prod_2_932e77b9', 'response': 'Product with id prod_2_932e77b9 not found in warehouse buffer.'}
2025-07-26 21:58:19,975 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_2_932e77b9 response: Product with id prod_2_932e77b9 not found in warehouse buffer.
2025-07-26 21:58:20,491 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P8","action":"move","target":"AGV_1","params":{"target_point":"P8"}}]

Explanation:  
According to the decision logic, finished products at QualityCheck take priority over raw material movement. There is at least one product at QualityCheck, so the next action is to move an AGV to P8 (QualityCheck output) to prepare for loading and delivery to warehouse. AGV_1 is idle and available, so it is dispatched to P8. AGV_2 remains ready for further commands regarding raw material once the higher-priority finished product action is addressed.'
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 579
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P8","action":"move","target":"AGV_1","params":{"target_point":"P8"}}]

Explanation:  
According to the decision logic, finished products at QualityCheck take pr...'
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P8","action":"move","target":"AGV_1","params":{"target_point":"P8"}}]'
2025-07-26 21:58:20,495 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:20,495 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:20,495 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:20,496 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P8', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P8'}, 'timestamp': 1753538300.495977}
2025-07-26 21:58:20,496 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P8 - move for AGV_1
2025-07-26 21:58:20,597 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:58:20,598 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:21,445 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:21,531 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle, at P0 (RawMaterial warehouse), and has no load, making it ready for the next step. The next scheduled raw material per the actions list is "prod_1_66f5a66e." The appropriate command is to load this item using the exact product_id. AGV_2 is available, but only one command is allowed per request and there are no higher-priority tasks requiring AGV_2 at this time.'
2025-07-26 21:58:21,531 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:21,531 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 526
2025-07-26 21:58:21,531 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle, at P0 (RawMaterial warehouse), and ha...'
2025-07-26 21:58:21,532 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:21,532 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:21,532 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:21,532 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:21,532 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:21,532 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538301.532322}
2025-07-26 21:58:21,532 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:21,633 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:21,634 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1']
2025-07-26 21:58:23,065 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:23,209 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 165.94425450222423, 'device_id': 'AGV_1', 'alert_type': 'fault_recovered', 'symptom': 'AGV Stuck', 'fault_type': 'unknown', 'estimated_duration': 0.0, 'message': 'Device AGV_1 fault has been automatically recovered'}
2025-07-26 21:58:23,397 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 165.0, 'command_id': 'flow_20240624_load_prod2_932e77b9', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:23,398 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_932e77b9 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:23,401 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 165.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:23,402 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV1_P8","action":"move","target":"AGV_1","params":{"target_point":"P8"}}]

Explanation:  
There is a finished product at QualityCheck, which is a high-priority action according to the decision logic. The appropriate next step is to move an available AGV to the QualityCheck output (P8) in preparation for loading and transporting the finished product to the warehouse. AGV_1 is idle and available at P1, so it is assigned to move to P8. AGV_2 remains available for raw material actions after this urgent task is handled.'
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 556
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV1_P8","action":"move","target":"AGV_1","params":{"target_point":"P8"}}]

Explanation:  
There is a finished product at QualityCheck, which is a high-priority acti...'
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV1_P8","action":"move","target":"AGV_1","params":{"target_point":"P8"}}]'
2025-07-26 21:58:23,403 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:23,404 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:23,404 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:23,404 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV1_P8', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P8'}, 'timestamp': 1753538303.404181}
2025-07-26 21:58:23,404 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV1_P8 - move for AGV_1
2025-07-26 21:58:23,506 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:58:23,506 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:24,111 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 166.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.4, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.7, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:24,111 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 166.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.4, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.7, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:24,112 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 166.0, 'order_completion_rate': 6.25, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.4, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.7, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:25,500 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:26,020 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
AGV_1 is currently moving and cannot receive a new command until it becomes idle again. AGV_2 is idle at P0, but the highest-priority action is to address the finished product at QualityCheck, which is already in progress by AGV_1. Since only one action is needed and a command is already being executed, no new commands should be issued at this time. Wait for AGV_1 to arrive at its destination before proceeding.'
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 434
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
AGV_1 is currently moving and cannot receive a new command until it becomes idle again. AGV_2 is idle at P0, but the highest-priority action is to address the finished product at Q...'
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:26,136 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:26,137 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:26,137 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 52, Finished products: 0
2025-07-26 21:58:26,137 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.MOVING at P1, battery 36.47333419600001%
2025-07-26 21:58:26,137 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 45.420000400000006%
2025-07-26 21:58:26,137 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:26,137 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:27,225 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and has no current load. The highest priority task is to load the next raw material, which according to the queue is "prod_1_66f5a66e". This command directs AGV_1 to load this specific product, following the requirement to include the exact product_id. AGV_2 remains available but is not needed for this request, as only one command is allowed at a time and no higher-priority actions exist.'
2025-07-26 21:58:27,225 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:27,225 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 585
2025-07-26 21:58:27,225 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and ha...'
2025-07-26 21:58:27,225 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:27,226 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:27,226 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:27,226 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:27,226 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:27,226 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538307.22617}
2025-07-26 21:58:27,226 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:27,327 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:27,327 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1']
2025-07-26 21:58:28,277 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:28,476 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 170.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:28,476 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:28,748 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_896992e6', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1850.0}
2025-07-26 21:58:28,749 - order - INFO - [order.py:245] - Created order order_896992e6 with 3 products
2025-07-26 21:58:28,749 - order - INFO - [order.py:339] - Assigned 3 products from order order_896992e6 to line1
2025-07-26 21:58:28,749 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_896992e6 with 3 products to line1
2025-07-26 21:58:28,749 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 6.06, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 33, 'completed_orders': 2, 'active_orders': 31, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:28,760 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[]

Explanation:  
AGV_1 is in transit (DeviceStatus.MOVING) and cannot receive a new command until it is idle. The high-priority task (move to QualityCheck for finished product) is already underway. AGV_2 is idle at P0, but only one action is needed and that priority is currently being fulfilled by AGV_1. Therefore, no additional command is issued at this time‚Äîwait for AGV_1 to complete its movement to P8.'
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 410
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[]

Explanation:  
AGV_1 is in transit (DeviceStatus.MOVING) and cannot receive a new command until it is idle. The high-priority task (move to QualityCheck for finished product) is already underway. ...'
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 52, Finished products: 0
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.MOVING at P1, battery 36.47333419600001%
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 45.420000400000006%
2025-07-26 21:58:28,763 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:28,763 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:28,850 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6a609aae', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 650.0}
2025-07-26 21:58:28,850 - order - INFO - [order.py:245] - Created order order_6a609aae with 1 products
2025-07-26 21:58:28,850 - order - INFO - [order.py:339] - Assigned 1 products from order order_6a609aae to line2
2025-07-26 21:58:28,850 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_6a609aae with 1 products to line2
2025-07-26 21:58:28,850 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:28,851 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p8", "action":"move", "target":"AGV_2", "params":{"target_point":"P8"}}]

Explanation:  
AGV_1 is unavailable due to a fault, so only AGV_2 may be used. The top priority is to handle finished products: AGV_2 must move to P8 (QualityCheck output) to pick them up. This move command is the correct first step because AGV_2 is currently at P0 and must first reach P8 before loading finished products for delivery to the warehouse. Only one action is allowed per AGV, per request. Raw materials and further product handling will be addressed in the next steps.'
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 596
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p8", "action":"move", "target":"AGV_2", "params":{"target_point":"P8"}}]

Explanation:  
AGV_1 is unavailable due to a fault, so only AGV_2 may be used. The top...'
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p8", "action":"move", "target":"AGV_2", "params":{"target_point":"P8"}}]'
2025-07-26 21:58:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:28,947 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:28,947 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:28,948 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753538308.947939}
2025-07-26 21:58:28,948 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p8 - move for AGV_2
2025-07-26 21:58:29,049 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:58:29,049 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1']
2025-07-26 21:58:29,304 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_896992e6', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1850.0}
2025-07-26 21:58:29,305 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 6.06, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 33, 'completed_orders': 2, 'active_orders': 31, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:29,319 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_896992e6', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1850.0}
2025-07-26 21:58:29,320 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 6.06, 'average_production_cycle': 4.68, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 33, 'completed_orders': 2, 'active_orders': 31, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:29,320 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6a609aae', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 650.0}
2025-07-26 21:58:29,418 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6a609aae', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 650.0}
2025-07-26 21:58:29,419 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:29,419 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:30,215 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:30,216 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.33, 'first_pass_rate': 100.0, 'total_production_cost': 136.83, 'material_costs': 70.0, 'energy_costs': 42.83, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 15.25, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:31,439 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:32,311 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[]

Explanation:  
AGV_1 is currently moving (not idle) to complete a high-priority finished product action (heading toward P8). Per the rules, you can only send one command per AGV at a time, and only one action is needed. AGV_2 is idle, but the finished product task is being handled by AGV_1 and takes precedence over raw material movement. Therefore, no further action is needed‚Äîwait until AGV_1 is idle before giving the next command.'
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 439
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[]

Explanation:  
AGV_1 is currently moving (not idle) to complete a high-priority finished product action (heading toward P8). Per the rules, you can only send one command per AGV at a time, and onl...'
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 52, Finished products: 0
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.MOVING at P1, battery 36.47333419600001%
2025-07-26 21:58:32,430 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 45.420000400000006%
2025-07-26 21:58:32,431 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:32,431 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), is idle and empty, making it available for the next loading action. The next raw material in the action queue is "prod_1_66f5a66e". The decision logic specifies that when loading from P0, the precise product_id must be given. Thus, the command instructs AGV_1 to load "prod_1_66f5a66e". AGV_2 is also available, but only one action is allowed per request and no higher-priority actions are present at this time.'
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 599
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), is idle and ...'
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:32,608 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:32,608 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:32,608 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:32,609 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538312.608993}
2025-07-26 21:58:32,609 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:32,711 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:32,712 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2']
2025-07-26 21:58:33,499 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 175.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:33,499 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:34,164 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 176.65, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.57, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.45, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:34,164 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 176.65, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.57, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.45, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:34,501 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 176.65, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.57, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.45, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 2}
2025-07-26 21:58:34,553 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 176.65022, 'command_id': 'flow_20240628_agv2_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 43.4%'}
2025-07-26 21:58:34,553 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p8 response: Successfully arrived at path point P8, remaining battery: 43.4%
2025-07-26 21:58:35,703 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:36,513 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p8", "action":"move", "target":"AGV_1", "params":{"target_point":"P8"}}]

Explanation:
Although there are 2 actions needed, only AGV_1 is available for a new command since AGV_2 is currently moving and cannot receive another command yet. The highest priority is to deliver finished products, so AGV_1 should be sent to P8 (QualityCheck output) to pick them up for warehouse transfer. This keeps finished goods flowing and maximizes factory efficiency. Only one command is issued‚Äîone per available AGV as required.'
2025-07-26 21:58:36,514 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:36,514 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 553
2025-07-26 21:58:36,514 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p8", "action":"move", "target":"AGV_1", "params":{"target_point":"P8"}}]

Explanation:
Although there are 2 actions needed, only AGV_1 is available for a new co...'
2025-07-26 21:58:36,514 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:36,514 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p8", "action":"move", "target":"AGV_1", "params":{"target_point":"P8"}}]'
2025-07-26 21:58:36,514 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:36,514 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:36,514 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:36,515 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p8', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P8'}, 'timestamp': 1753538316.514921}
2025-07-26 21:58:36,515 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p8 - move for AGV_1
2025-07-26 21:58:36,617 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:36,618 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1']
2025-07-26 21:58:36,644 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 178.97606693011653, 'device_id': 'QualityCheck', 'alert_type': 'fault_recovered', 'symptom': 'Station Vibration', 'fault_type': 'unknown', 'estimated_duration': 0.0, 'message': 'Device QualityCheck fault has been automatically recovered'}
2025-07-26 21:58:36,646 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle and positioned at P0 (RawMaterial warehouse) with no load, prepared for the next operation. According to the decision logic, the highest priority is to load the next raw material for production, which is "prod_1_66f5a66e." The command includes the exact product_id as required. AGV_2 remains available but is not needed for this action, and only one command is allowed per request.'
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 543
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle and positioned at P0 (RawMaterial ware...'
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:36,649 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:36,649 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:36,649 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:36,649 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538316.649791}
2025-07-26 21:58:36,649 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:36,751 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:36,751 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2']
2025-07-26 21:58:37,198 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 179.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.52, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.2, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:37,199 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 179.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.52, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.2, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:37,200 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 179.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:37,200 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:37,201 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 179.0, 'order_completion_rate': 5.88, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.52, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.2, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:37,631 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:37,636 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[]

Explanation:  
AGV_1 is currently moving and cannot accept another command until it becomes idle. AGV_2 is idle at P0, but the high-priority action (handling a finished product at QualityCheck) is already being processed by AGV_1. Only one action is requested, and that action is in progress. Therefore, no new commands should be issued at this time. Wait for AGV_1 to reach its target and become idle before sending the next command.'
2025-07-26 21:58:37,636 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:37,636 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 438
2025-07-26 21:58:37,636 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[]

Explanation:  
AGV_1 is currently moving and cannot accept another command until it becomes idle. AGV_2 is idle at P0, but the high-priority action (handling a finished product at QualityCheck) is...'
2025-07-26 21:58:37,636 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:37,636 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:37,637 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:37,637 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:37,637 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:37,637 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 56, Finished products: 0
2025-07-26 21:58:37,637 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.MOVING at P1, battery 36.47333419600001%
2025-07-26 21:58:37,637 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 45.420000400000006%
2025-07-26 21:58:37,637 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:37,638 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1']
2025-07-26 21:58:38,320 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_246da550', 'created_at': 180.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1260.0}
2025-07-26 21:58:38,320 - order - INFO - [order.py:245] - Created order order_246da550 with 2 products
2025-07-26 21:58:38,320 - order - INFO - [order.py:339] - Assigned 2 products from order order_246da550 to line3
2025-07-26 21:58:38,320 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_246da550 with 2 products to line3
2025-07-26 21:58:38,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.71, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 35, 'completed_orders': 2, 'active_orders': 33, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:38,441 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_246da550', 'created_at': 180.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1260.0}
2025-07-26 21:58:38,441 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.71, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 35, 'completed_orders': 2, 'active_orders': 33, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:38,602 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6cdfef76', 'created_at': 180.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1220.0}
2025-07-26 21:58:38,602 - order - INFO - [order.py:245] - Created order order_6cdfef76 with 3 products
2025-07-26 21:58:38,602 - order - INFO - [order.py:339] - Assigned 3 products from order order_6cdfef76 to line1
2025-07-26 21:58:38,602 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_6cdfef76 with 3 products to line1
2025-07-26 21:58:38,602 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 5.19, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:38,602 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 5.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:38,874 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_246da550', 'created_at': 180.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1260.0}
2025-07-26 21:58:38,874 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.71, 'average_production_cycle': 4.98, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 35, 'completed_orders': 2, 'active_orders': 33, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:38,944 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6cdfef76', 'created_at': 180.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1220.0}
2025-07-26 21:58:38,945 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 5.19, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:38,945 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 5.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:39,887 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:40,177 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and not carrying anything. The top-priority action is to load the next raw material, "prod_1_66f5a66e", and the command must specify the exact product_id when loading from P0. AGV_2 is also available but is not needed for this high-priority action, and only one command is allowed per request.'
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 487
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and no...'
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:40,178 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:40,178 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:40,178 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:40,179 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538320.178972}
2025-07-26 21:58:40,179 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:40,279 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:40,280 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:58:40,363 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:40,414 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6cdfef76', 'created_at': 180.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1220.0}
2025-07-26 21:58:40,414 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 5.19, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:40,415 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 5.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.51, 'first_pass_rate': 100.0, 'total_production_cost': 140.16, 'material_costs': 70.0, 'energy_costs': 46.16, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 16.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:40,825 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240628_agv1_move_p8", "action":"move", "target":"AGV_1", "params":{"target_point":"P8"}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]

Explanation:  
Both AGVs are available. AGV_2 is at P8 (QualityCheck output) with a load, so the next step for it is to move to P9 (Warehouse) to deliver the finished product. Meanwhile, AGV_1 is idle at P1 and can be assigned to handle the second finished product at P8. Therefore, the commands are:  
1. Move AGV_1 to P8 so it can participate in finished product pick-up.  
2. Move AGV_2 (which is loaded) to P9 to begin delivering finished products to the warehouse.  
This maximizes throughput and ensures both high-priority finished product tasks are initiated.'
2025-07-26 21:58:40,825 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:40,825 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 798
2025-07-26 21:58:40,825 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240628_agv1_move_p8", "action":"move", "target":"AGV_1", "params":{"target_point":"P8"}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "pa...'
2025-07-26 21:58:40,825 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:40,826 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240628_agv1_move_p8", "action":"move", "target":"AGV_1", "params":{"target_point":"P8"}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]'
2025-07-26 21:58:40,826 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:58:40,826 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line2
2025-07-26 21:58:40,826 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line2
2025-07-26 21:58:40,826 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p8', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P8'}, 'timestamp': 1753538320.826608}
2025-07-26 21:58:40,826 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p8 - move for AGV_1
2025-07-26 21:58:40,841 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[]

Explanation:  
AGV_1 is still moving (DeviceStatus.MOVING) and cannot take another command until it becomes idle. While AGV_2 is idle and positioned at P0 (RawMaterial warehouse), according to the decision logic and requested "1 action needed," the finished product handling remains the higher priority but is already committed to AGV_1. No new action (such as a raw material load) should be started concurrently in this case. Wait until AGV_1 is idle before issuing the next command.'
2025-07-26 21:58:40,841 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:40,841 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 488
2025-07-26 21:58:40,841 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[]

Explanation:  
AGV_1 is still moving (DeviceStatus.MOVING) and cannot take another command until it becomes idle. While AGV_2 is idle and positioned at P0 (RawMaterial warehouse), according to the...'
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 56, Finished products: 0
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.MOVING at P1, battery 36.47333419600001%
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 45.420000400000006%
2025-07-26 21:58:40,842 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:40,842 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 21:58:40,928 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538320.928095}
2025-07-26 21:58:40,928 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:58:41,029 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:41,030 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1']
2025-07-26 21:58:41,329 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 183.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:41,329 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:42,273 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.56, 'order_completion_rate': 5.56, 'average_production_cycle': 5.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.84, 'first_pass_rate': 100.0, 'total_production_cost': 144.08, 'material_costs': 70.0, 'energy_costs': 50.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.75, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:42,273 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.56, 'order_completion_rate': 5.56, 'average_production_cycle': 5.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.84, 'first_pass_rate': 100.0, 'total_production_cost': 144.08, 'material_costs': 70.0, 'energy_costs': 50.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.75, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:42,273 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.7, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.84, 'first_pass_rate': 100.0, 'total_production_cost': 144.08, 'material_costs': 70.0, 'energy_costs': 50.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.73, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 1}
2025-07-26 21:58:42,502 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 184.56022000000002, 'command_id': 'flow_20240618_move_AGV1_P8', 'response': 'Successfully arrived at path point P8, remaining battery: 32.1%'}
2025-07-26 21:58:42,502 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P8 response: Successfully arrived at path point P8, remaining battery: 32.1%
2025-07-26 21:58:42,503 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.7, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.84, 'first_pass_rate': 100.0, 'total_production_cost': 144.08, 'material_costs': 70.0, 'energy_costs': 50.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.73, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 1}
2025-07-26 21:58:42,503 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.7, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.99, 'first_pass_rate': 100.0, 'total_production_cost': 145.08, 'material_costs': 70.0, 'energy_costs': 51.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.73, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 1}
2025-07-26 21:58:43,036 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.7, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.99, 'first_pass_rate': 100.0, 'total_production_cost': 145.08, 'material_costs': 70.0, 'energy_costs': 51.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.73, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 1}
2025-07-26 21:58:43,943 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.56, 'order_completion_rate': 5.56, 'average_production_cycle': 5.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.84, 'first_pass_rate': 100.0, 'total_production_cost': 144.08, 'material_costs': 70.0, 'energy_costs': 50.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.75, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 2, 'active_faults': 1}
2025-07-26 21:58:43,966 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 185.00636931771353, 'device_id': 'Conveyor_AB', 'alert_type': 'fault_recovered', 'symptom': 'Conveyor Stuck', 'fault_type': 'unknown', 'estimated_duration': 0.0, 'message': 'Device Conveyor_AB fault has been automatically recovered'}
2025-07-26 21:58:44,215 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:44,372 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:44,376 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has no load, making it ready for the next operation. The highest priority task in the current workflow is to load the next raw material, which is "prod_1_66f5a66e". The load command specifies the required product_id, as per the manufacturing logic. AGV_2 is available, but only one command can be given per request and there are no higher-priority actions for AGV_2 at this moment.'
2025-07-26 21:58:44,376 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:44,376 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 577
2025-07-26 21:58:44,376 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has ...'
2025-07-26 21:58:44,376 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:44,377 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:44,377 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:44,377 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:44,377 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:44,377 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538324.377354}
2025-07-26 21:58:44,377 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:44,473 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.7, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.84, 'first_pass_rate': 100.0, 'total_production_cost': 144.08, 'material_costs': 70.0, 'energy_costs': 50.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.73, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 1}
2025-07-26 21:58:44,474 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.7, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.99, 'first_pass_rate': 100.0, 'total_production_cost': 145.08, 'material_costs': 70.0, 'energy_costs': 51.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.73, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 1}
2025-07-26 21:58:44,475 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 186.0, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.93, 'first_pass_rate': 100.0, 'total_production_cost': 145.08, 'material_costs': 70.0, 'energy_costs': 51.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.59, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:44,478 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:44,478 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:58:44,539 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 186.0, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.93, 'first_pass_rate': 100.0, 'total_production_cost': 145.08, 'material_costs': 70.0, 'energy_costs': 51.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.59, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:44,893 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 186.0, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 6.93, 'first_pass_rate': 100.0, 'total_production_cost': 145.08, 'material_costs': 70.0, 'energy_costs': 51.08, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 17.59, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:45,184 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Of the two AGVs, only AGV_2 is currently IDLE and available for a new command; AGV_1 is still moving and cannot accept a new action. AGV_2 is at P8 with a finished product loaded, so the highest-priority action is for it to move to P9 (Warehouse) to deliver the finished product. This supports the finished-product handling priority and keeps the production flow moving efficiently. Only one command is sent, as required for available AGVs.'
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 569
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Of the two AGVs, only AGV_2 is currently IDLE and available for a new c...'
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]'
2025-07-26 21:58:45,185 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:45,185 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:45,185 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:45,186 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538325.185918}
2025-07-26 21:58:45,186 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:58:45,287 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:45,288 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1']
2025-07-26 21:58:46,230 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.56, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.35, 'first_pass_rate': 100.0, 'total_production_cost': 148.99, 'material_costs': 70.0, 'energy_costs': 54.99, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.39, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,231 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 188.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:46,231 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.56, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.35, 'first_pass_rate': 100.0, 'total_production_cost': 148.99, 'material_costs': 70.0, 'energy_costs': 54.99, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.39, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,231 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:46,232 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.56, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.35, 'first_pass_rate': 100.0, 'total_production_cost': 148.99, 'material_costs': 70.0, 'energy_costs': 54.99, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 19.39, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[] 

Explanation:  
AGV_1 is currently moving and cannot receive a new command until it becomes idle. AGV_2 is idle at P0, capable of loading raw material, but the highest active priority is still the finished product (if any), which AGV_1 is in the process of addressing. Since only one action is needed and it's already in progress with AGV_1, no new command should be sent to AGV_2 at this moment. Wait for AGV_1 to complete its move before issuing further instructions.'
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 473
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[] 

Explanation:  
AGV_1 is currently moving and cannot receive a new command until it becomes idle. AGV_2 is idle at P0, capable of loading raw material, but the highest active priority is still the...'
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 61, Finished products: 1
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.IDLE at P8, battery 32.06129019600001%
2025-07-26 21:58:46,586 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P0, battery 45.420000400000006%
2025-07-26 21:58:46,587 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:46,587 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 21:58:46,664 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.65, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.75, 'first_pass_rate': 100.0, 'total_production_cost': 152.32, 'material_costs': 70.0, 'energy_costs': 58.32, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.15, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,664 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 188.56022000000002, 'command_id': 'flow_20240618_move_AGV1_P8', 'response': 'Successfully arrived at path point P8, remaining battery: 27.6%'}
2025-07-26 21:58:46,665 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV1_P8 response: Successfully arrived at path point P8, remaining battery: 27.6%
2025-07-26 21:58:46,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 188.65022, 'command_id': 'flow_20240628_agv2_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 39.5%'}
2025-07-26 21:58:46,665 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p8 response: Successfully arrived at path point P8, remaining battery: 39.5%
2025-07-26 21:58:46,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.65, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.75, 'first_pass_rate': 100.0, 'total_production_cost': 152.32, 'material_costs': 70.0, 'energy_costs': 58.32, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.15, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.89, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.86, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.64, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,816 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.65, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.75, 'first_pass_rate': 100.0, 'total_production_cost': 152.32, 'material_costs': 70.0, 'energy_costs': 58.32, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.15, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,817 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.89, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.86, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.64, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,991 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 188.89, 'order_completion_rate': 8.33, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.86, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.64, 'total_orders': 36, 'completed_orders': 3, 'active_orders': 33, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:46,992 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 188.88999939, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Successfully arrived at path point P9, remaining battery: 38.1%'}
2025-07-26 21:58:46,992 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Successfully arrived at path point P9, remaining battery: 38.1%
2025-07-26 21:58:47,299 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not carrying a load. According to the production workflow and priority logic, the next raw material to process is "prod_1_66f5a66e". The correct command is to have AGV_1 load this specific product_id, fulfilling the required format. AGV_2 is available but is not needed for this step, as only one command may be issued and there are no higher-priority actions for it presently.'
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 573
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not ...'
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:47,629 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:47,629 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:47,630 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:47,630 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538327.630027}
2025-07-26 21:58:47,630 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:47,731 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:47,731 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:58:48,822 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:48,881 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fdd9875', 'created_at': 190.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2500.0}
2025-07-26 21:58:48,882 - order - INFO - [order.py:245] - Created order order_3fdd9875 with 4 products
2025-07-26 21:58:48,882 - order - INFO - [order.py:339] - Assigned 4 products from order order_3fdd9875 to line2
2025-07-26 21:58:48,882 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_3fdd9875 with 4 products to line2
2025-07-26 21:58:49,088 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 8.11, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 37, 'completed_orders': 3, 'active_orders': 34, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:49,089 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fdd9875', 'created_at': 190.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2500.0}
2025-07-26 21:58:49,095 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[]

Explanation:  
Both AGVs are currently MOVING (not IDLE), so no commands can be sent to them at this step. Commands are only valid for AGVs that are AVAILABLE and IDLE. You must wait until an AGV has completed its move before giving the next instruction. No action is taken this cycle.'
2025-07-26 21:58:49,095 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:49,095 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 289
2025-07-26 21:58:49,095 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[]

Explanation:  
Both AGVs are currently MOVING (not IDLE), so no commands can be sent to them at this step. Commands are only valid for AGVs that are AVAILABLE and IDLE. You must wait until an AGV ...'
2025-07-26 21:58:49,095 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:49,095 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[]'
2025-07-26 21:58:49,096 - src.product_flow_agent - INFO - [product_flow_agent.py:667] - No commands in parsed output
2025-07-26 21:58:49,096 - src.product_flow_agent - INFO - [product_flow_agent.py:668] - Parsed data was: []
2025-07-26 21:58:49,096 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - No commands generated - no action needed for this line
2025-07-26 21:58:49,096 - src.product_flow_agent - INFO - [product_flow_agent.py:182] - Factory summary: Raw materials: 61, Finished products: 2
2025-07-26 21:58:49,096 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_1: DeviceStatus.MOVING at P1, battery 41.736667098000005%
2025-07-26 21:58:49,096 - src.product_flow_agent - INFO - [product_flow_agent.py:189] - AGV_2: DeviceStatus.IDLE at P8, battery 39.5499122%
2025-07-26 21:58:49,096 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:49,097 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3']
2025-07-26 21:58:49,306 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 8.11, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 37, 'completed_orders': 3, 'active_orders': 34, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:49,310 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c67d5d57', 'created_at': 190.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2500.0}
2025-07-26 21:58:49,311 - order - INFO - [order.py:245] - Created order order_c67d5d57 with 4 products
2025-07-26 21:58:49,314 - order - INFO - [order.py:339] - Assigned 4 products from order order_c67d5d57 to line3
2025-07-26 21:58:49,315 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_c67d5d57 with 4 products to line3
2025-07-26 21:58:49,315 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.67, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:49,316 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:49,372 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 190.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:49,372 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:50,244 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 192.89, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.82, 'first_pass_rate': 100.0, 'total_production_cost': 154.27, 'material_costs': 70.0, 'energy_costs': 60.27, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.65, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:50,661 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:51,009 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fdd9875', 'created_at': 190.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2500.0}
2025-07-26 21:58:51,010 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 8.11, 'average_production_cycle': 4.42, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 37, 'completed_orders': 3, 'active_orders': 34, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:51,184 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240618_load_AGV1_finished_QC","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_20240618_load_AGV2_prod_1_66f5a66e","action":"load","target":"AGV_2","params":{"product_id":"prod_1_66f5a66e"}}
]

Explanation:  
Two actions are needed and both AGVs are idle and available. 
- The highest priority is the finished product at QualityCheck. AGV_1 is already positioned at P8 (QualityCheck output) and is empty, so it should load the finished product.
- The next priority is loading more raw materials to keep production flowing. AGV_2 is at P0 (RawMaterial warehouse) and is empty, so it can immediately load the next raw material, "prod_1_66f5a66e".
This approach keeps both AGVs continuously engaged and maximizes production throughput according to the decision priorities.'
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 815
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240618_load_AGV1_finished_QC","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_20240618_load_AGV2_prod_1_66f5a66e","action":"load","target":"AGV_2","param...'
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240618_load_AGV1_finished_QC","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_20240618_load_AGV2_prod_1_66f5a66e","action":"load","target":"AGV_2","params":{"product_id":"prod_1_66f5a66e"}}
]'
2025-07-26 21:58:51,185 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:58:51,185 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line3
2025-07-26 21:58:51,185 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line3
2025-07-26 21:58:51,186 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV1_finished_QC', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538331.185991}
2025-07-26 21:58:51,186 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV1_finished_QC - load for AGV_1
2025-07-26 21:58:51,288 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_1_66f5a66e', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538331.287474}
2025-07-26 21:58:51,288 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_1_66f5a66e - load for AGV_2
2025-07-26 21:58:51,300 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not carrying a load. The workflow prioritizes loading the next available raw material, which is "prod_1_66f5a66e". The command is given in the required format, specifying the correct product_id. AGV_2 is available but not needed for this request since there are no higher-priority actions for it, and only one command is issued per cycle.'
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 534
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not ...'
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:58:51,303 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:51,303 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:58:51,304 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:58:51,304 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538331.304045}
2025-07-26 21:58:51,304 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:58:51,390 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:51,390 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:58:51,413 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:51,413 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:58:51,546 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Only AGV_2 is currently idle and available for a new command, while AGV_1 is still moving and cannot accept a command. AGV_2 is at P8 (QualityCheck output) with a finished product loaded, so the next correct step is for AGV_2 to move to P9 (Warehouse) where finished products are to be delivered. This follows the high-priority workflow for finished products and utilizes the available AGV efficiently. Only one command is issued per request.'
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 571
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Only AGV_2 is currently idle and available for a new command, while AGV...'
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]'
2025-07-26 21:58:51,711 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:51,711 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:51,711 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:51,711 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538331.711638}
2025-07-26 21:58:51,711 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:58:51,813 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_available (severity: low)
2025-07-26 21:58:51,813 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3']
2025-07-26 21:58:52,370 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c67d5d57', 'created_at': 190.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2500.0}
2025-07-26 21:58:52,371 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.67, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:52,372 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:52,372 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 192.89, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.82, 'first_pass_rate': 100.0, 'total_production_cost': 154.27, 'material_costs': 70.0, 'energy_costs': 60.27, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.65, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:52,827 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c67d5d57', 'created_at': 190.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2500.0}
2025-07-26 21:58:52,828 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.67, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:52,829 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.83, 'first_pass_rate': 100.0, 'total_production_cost': 153.3, 'material_costs': 70.0, 'energy_costs': 59.3, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.5, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:53,040 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 192.89, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.82, 'first_pass_rate': 100.0, 'total_production_cost': 154.27, 'material_costs': 70.0, 'energy_costs': 60.27, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.65, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:53,041 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 192.88999939, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Successfully arrived at path point P9, remaining battery: 36.6%'}
2025-07-26 21:58:53,041 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Successfully arrived at path point P9, remaining battery: 36.6%
2025-07-26 21:58:53,596 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 195.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.77, 'first_pass_rate': 100.0, 'total_production_cost': 164.27, 'material_costs': 80.0, 'energy_costs': 60.27, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.39, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:53,919 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 195.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:58:53,920 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:58:54,005 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:54,034 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 195.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.77, 'first_pass_rate': 100.0, 'total_production_cost': 164.27, 'material_costs': 80.0, 'energy_costs': 60.27, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.39, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:54,455 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:58:54,966 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:54,975 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 195.0, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.77, 'first_pass_rate': 100.0, 'total_production_cost': 164.27, 'material_costs': 80.0, 'energy_costs': 60.27, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 21.39, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:54,976 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 195.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:58:54,976 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:58:55,459 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:55,515 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240618_load_AGV1_finished_P8","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_20240618_load_AGV2_prod_1_66f5a66e","action":"load","target":"AGV_2","params":{"product_id":"prod_1_66f5a66e"}}
]

Explanation:  
Both AGVs are idle and available, and two actions are needed:
- The highest priority is to handle the finished product at QualityCheck output (P8). AGV_1 is already at P8 and empty, so it should perform the load action for the finished product.
- At the same time, AGV_2 is at P0 (RawMaterial warehouse) and empty. The next priority is starting production by loading a new raw material, specifically "prod_1_66f5a66e".

This simultaneous engagement of both AGVs maximizes efficiency and maintains continuous flow in both outbound and inbound production.'
2025-07-26 21:58:55,516 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:55,516 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 808
2025-07-26 21:58:55,516 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240618_load_AGV1_finished_P8","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_20240618_load_AGV2_prod_1_66f5a66e","action":"load","target":"AGV_2","param...'
2025-07-26 21:58:55,516 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:55,516 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240618_load_AGV1_finished_P8","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_20240618_load_AGV2_prod_1_66f5a66e","action":"load","target":"AGV_2","params":{"product_id":"prod_1_66f5a66e"}}
]'
2025-07-26 21:58:55,516 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:58:55,516 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line3
2025-07-26 21:58:55,516 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line3
2025-07-26 21:58:55,517 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV1_finished_P8', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538335.516686}
2025-07-26 21:58:55,517 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV1_finished_P8 - load for AGV_1
2025-07-26 21:58:55,592 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
AGV_2 is currently idle at P8 (QualityCheck output) and has a finished product loaded. According to the logic for finished products, the next required action is to move AGV_2 to P9 (Warehouse) to deliver the finished product. AGV_1 is still MOVING and cannot accept a new command until it is idle. Therefore, only AGV_2 is assigned a command at this time, which aligns with the high-priority finished product handling process.'
2025-07-26 21:58:55,592 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:55,592 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 555
2025-07-26 21:58:55,592 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
AGV_2 is currently idle at P8 (QualityCheck output) and has a finished ...'
2025-07-26 21:58:55,592 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:55,593 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]'
2025-07-26 21:58:55,593 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:55,593 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:55,593 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:55,593 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538335.593136}
2025-07-26 21:58:55,593 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:58:55,618 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_load_AGV2_prod_1_66f5a66e', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538335.618416}
2025-07-26 21:58:55,618 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_load_AGV2_prod_1_66f5a66e - load for AGV_2
2025-07-26 21:58:55,694 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:55,694 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3']
2025-07-26 21:58:55,719 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:58:55,719 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:58:56,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 198.56, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.14, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.0, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:56,663 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 198.56022000000002, 'command_id': 'flow_20240628_agv1_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 37.3%'}
2025-07-26 21:58:56,664 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_move_p8 response: Successfully arrived at path point P8, remaining battery: 37.3%
2025-07-26 21:58:57,476 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 199.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:58:57,477 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:58:58,528 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:58,530 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:58:58,533 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Even though two actions are needed, only AGV_2 is currently available to receive a command since AGV_1 is still MOVING. AGV_2 is at P8 (QualityCheck output) with a finished product loaded, so the next step in the process is for it to move to P9 (Warehouse) for unloading. This command addresses the highest-priority finished product workflow using the only available AGV. AGV_1 will be assigned when it becomes idle.'
2025-07-26 21:58:58,534 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:58,534 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 545
2025-07-26 21:58:58,534 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Even though two actions are needed, only AGV_2 is currently available t...'
2025-07-26 21:58:58,534 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:58,534 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]'
2025-07-26 21:58:58,534 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:58,534 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:58:58,534 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:58:58,535 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538338.534835}
2025-07-26 21:58:58,535 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]

Explanation:  
Only AGV_2 is available; AGV_1 is busy. AGV_2 is idle at P0 and already loaded (load:2). According to the workflow, after loading raw materials at P0, the next action is to move the AGV to StationA (P1) to unload for processing. Thus, the correct command is to instruct AGV_2 to move to P1 in preparation for unloading, ensuring production flow continues efficiently.'
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 493
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]

Explanation:  
Only AGV_2 is available; AGV_1 is busy. AGV_2 is idle at P0 and already lo...'
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]'
2025-07-26 21:58:58,630 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:58:58,630 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:58:58,630 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:58:58,630 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV2_P1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753538338.630792}
2025-07-26 21:58:58,630 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV2_P1 - move for AGV_2
2025-07-26 21:58:58,636 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:58,637 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3']
2025-07-26 21:58:58,654 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_ac14e26a', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 980.0}
2025-07-26 21:58:58,655 - order - INFO - [order.py:245] - Created order order_ac14e26a with 3 products
2025-07-26 21:58:58,655 - order - INFO - [order.py:339] - Assigned 3 products from order order_ac14e26a to line1
2025-07-26 21:58:58,655 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_ac14e26a with 3 products to line1
2025-07-26 21:58:58,732 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:58:58,732 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:58:58,777 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.69, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 39, 'completed_orders': 3, 'active_orders': 36, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:58,877 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fa915cc', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1020.0}
2025-07-26 21:58:58,878 - order - INFO - [order.py:245] - Created order order_3fa915cc with 2 products
2025-07-26 21:58:58,878 - order - INFO - [order.py:339] - Assigned 2 products from order order_3fa915cc to line2
2025-07-26 21:58:58,878 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_3fa915cc with 2 products to line2
2025-07-26 21:58:59,347 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.5, 'average_production_cycle': 5.08, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:59,347 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:58:59,819 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 201.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:58:59,819 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:59:01,147 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 196.0, 'command_id': 'flow_20240618_load_AGV2_prod_1_66f5a66e', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_66f5a66eÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%'}
2025-07-26 21:59:01,148 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_1_66f5a66e response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_66f5a66eÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%
2025-07-26 21:59:01,148 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 196.0, 'command_id': 'flow_20240618_load_AGV1_finished_QC', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_9510e82eÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 27.1%'}
2025-07-26 21:59:01,149 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV1_finished_QC response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_9510e82eÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 27.1%
2025-07-26 21:59:01,249 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 198.56, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.14, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.0, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:01,250 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 199.0, 'command_id': 'flow_20240618_load_AGV1_finished_P8', 'response': 'QualityCheck output_buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:59:01,250 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV1_finished_P8 response: QualityCheck output_buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:59:01,250 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 199.0, 'command_id': 'flow_20240618_load_AGV2_prod_1_66f5a66e', 'response': 'Can not load. AGV AGV_2 is not available or payload is full.'}
2025-07-26 21:59:01,250 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_load_AGV2_prod_1_66f5a66e response: Can not load. AGV AGV_2 is not available or payload is full.
2025-07-26 21:59:01,285 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 203.56, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.4, 'first_pass_rate': 100.0, 'total_production_cost': 172.1, 'material_costs': 80.0, 'energy_costs': 68.1, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.25, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:01,671 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:01,739 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 203.56022000000002, 'command_id': 'flow_20240628_agv1_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 32.9%'}
2025-07-26 21:59:01,739 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_move_p8 response: Successfully arrived at path point P8, remaining battery: 32.9%
2025-07-26 21:59:01,779 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle and ready at P0 (RawMaterial warehouse) with no load. According to the action list, the next raw material needed for production is "prod_1_66f5a66e." Per your rule, the product_id must be specified when loading from P0. This command accomplishes that operation. AGV_2 remains available, but no higher-priority actions exist, and only one command is permitted per request.'
2025-07-26 21:59:01,779 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:01,779 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 533
2025-07-26 21:59:01,780 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]

**Explanation:**  
AGV_1 is idle and ready at P0 (RawMaterial warehouse...'
2025-07-26 21:59:01,780 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:01,780 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod1_66f5a66e","action":"load","target":"AGV_1","params":{"product_id":"prod_1_66f5a66e"}}]'
2025-07-26 21:59:01,780 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:01,780 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:01,780 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:01,780 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod1_66f5a66e', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_66f5a66e'}, 'timestamp': 1753538341.780146}
2025-07-26 21:59:01,780 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod1_66f5a66e - load for AGV_1
2025-07-26 21:59:01,783 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:01,881 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:01,882 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 21:59:02,194 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:02,303 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_ac14e26a', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 980.0}
2025-07-26 21:59:02,304 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.69, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 39, 'completed_orders': 3, 'active_orders': 36, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]

Explanation:  
AGV_2 is the only available AGV, idle at P0 and already loaded. The correct action in the production flow after loading raw materials is to move to StationA (P1) for unloading, as this keeps the process moving forward and makes room for more raw material transport. AGV_1 is busy and cannot be tasked. Thus, AGV_2 is instructed to move directly to P1.'
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 477
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]

Explanation:  
AGV_2 is the only available AGV, idle at P0 and already loaded. The correc...'
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]'
2025-07-26 21:59:02,429 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:02,430 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:02,430 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:02,430 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV2_P1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753538342.430256}
2025-07-26 21:59:02,430 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV2_P1 - move for AGV_2
2025-07-26 21:59:02,532 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:02,533 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1']
2025-07-26 21:59:02,553 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fa915cc', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1020.0}
2025-07-26 21:59:02,565 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.5, 'average_production_cycle': 5.08, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:02,566 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:02,723 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 203.56, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.4, 'first_pass_rate': 100.0, 'total_production_cost': 172.1, 'material_costs': 80.0, 'energy_costs': 68.1, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.25, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:03,243 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 198.56, 'order_completion_rate': 7.89, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.14, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 24.0, 'total_orders': 38, 'completed_orders': 3, 'active_orders': 35, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:03,243 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240628_agv1_load_p8", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]

Explanation:  
Both AGVs are available at P8 (QualityCheck output). AGV_1 is idle and empty, so the correct next step is to load one of the finished products at P8. AGV_2 is idle at P8 with a load, so the next required action is to move AGV_2 to P9 (Warehouse) to deliver its finished product load. This allocation uses both available AGVs efficiently‚ÄîAGV_1 is assigned to pick up a finished product (step 1: load), and AGV_2 proceeds with delivery (step 2: move). This addresses both urgent finished product tasks at once.'
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 736
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240628_agv1_load_p8", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_poin...'
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240628_agv1_load_p8", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]'
2025-07-26 21:59:04,332 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:59:04,333 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line2
2025-07-26 21:59:04,333 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line2
2025-07-26 21:59:04,333 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load_p8', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538344.33321}
2025-07-26 21:59:04,333 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load_p8 - load for AGV_1
2025-07-26 21:59:04,347 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:04,386 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 206.92, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.44, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.32, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:04,390 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_ac14e26a', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 980.0}
2025-07-26 21:59:04,391 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.69, 'average_production_cycle': 4.92, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 39, 'completed_orders': 3, 'active_orders': 36, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:04,434 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538344.434758}
2025-07-26 21:59:04,435 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:59:04,536 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:04,537 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3']
2025-07-26 21:59:04,925 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 206.91666651, 'command_id': 'flow_20240618_move_AGV2_P1', 'response': 'Successfully arrived at path point P1, remaining battery: 42.7%'}
2025-07-26 21:59:04,926 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV2_P1 response: Successfully arrived at path point P1, remaining battery: 42.7%
2025-07-26 21:59:04,939 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:05,340 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:05,343 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse), has no load, and is available to begin a new operation. The next product in the loading queue is "prod_2_dae91068". Following the workflow and the requirement to specify the product_id when loading from P0, this command instructs AGV_1 to perform the load. AGV_2 remains idle, as there are no higher-priority tasks and only one action is permitted per request.'
2025-07-26 21:59:05,343 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:05,343 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 553
2025-07-26 21:59:05,344 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse), has no ...'
2025-07-26 21:59:05,344 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:05,344 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:05,344 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:05,344 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:05,344 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:05,344 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538345.34469}
2025-07-26 21:59:05,344 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:05,446 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:05,446 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 21:59:05,479 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:05,713 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:05,947 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3fa915cc', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1020.0}
2025-07-26 21:59:05,947 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.5, 'average_production_cycle': 5.08, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:05,947 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.1, 'first_pass_rate': 100.0, 'total_production_cost': 168.19, 'material_costs': 80.0, 'energy_costs': 64.19, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.8, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:06,624 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:07,200 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:07,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 203.56, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.4, 'first_pass_rate': 100.0, 'total_production_cost': 172.1, 'material_costs': 80.0, 'energy_costs': 68.1, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.25, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:07,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 204.0, 'command_id': 'flow_20240624_load_prod1_66f5a66e', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:59:07,228 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod1_66f5a66e response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:59:07,229 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 206.92, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.44, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.32, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:07,659 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 208.0, 'command_id': 'flow_20240624_load_prod2_dae91068', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:59:07,659 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_dae91068 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240628_agv1_load_p8", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]

Explanation:  
Both AGVs are idle and positioned at P8 (QualityCheck output), where there are two finished products ready for handling. AGV_1 has no load, so it should load a finished product at P8. AGV_2 already has a load, so the next step for AGV_2 is to move to P9 (Warehouse) to deliver that finished product. This uses both available AGVs efficiently and progresses both finished-product actions as per decision priority.'
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 640
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240628_agv1_load_p8", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_poin...'
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240628_agv1_load_p8", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]'
2025-07-26 21:59:08,214 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:59:08,214 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line2
2025-07-26 21:59:08,214 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line2
2025-07-26 21:59:08,215 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load_p8', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538348.215027}
2025-07-26 21:59:08,215 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load_p8 - load for AGV_1
2025-07-26 21:59:08,316 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538348.316318}
2025-07-26 21:59:08,316 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:59:08,418 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:08,419 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3']
2025-07-26 21:59:08,681 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6ddd0372', 'created_at': 210.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1290.0}
2025-07-26 21:59:08,681 - order - INFO - [order.py:245] - Created order order_6ddd0372 with 2 products
2025-07-26 21:59:08,681 - order - INFO - [order.py:339] - Assigned 2 products from order order_6ddd0372 to line3
2025-07-26 21:59:08,681 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_6ddd0372 with 2 products to line3
2025-07-26 21:59:08,681 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.32, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 41, 'completed_orders': 3, 'active_orders': 38, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:09,009 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 206.92, 'order_completion_rate': 7.5, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.44, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.32, 'total_orders': 40, 'completed_orders': 3, 'active_orders': 37, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:09,535 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 207.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:59:09,535 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:59:09,536 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 208.0, 'command_id': 'flow_20240628_agv1_load_p8', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_f60057ddÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 32.4%'}
2025-07-26 21:59:09,536 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load_p8 response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_f60057ddÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 32.4%
2025-07-26 21:59:09,563 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]

Explanation:  
Both AGVs are available, but only one action is needed. AGV_2 is idle at P0 and already loaded with raw materials (load:2). According to the production flow, after an AGV is loaded with raw materials at P0, it should move to StationA (P1) to unload and feed the production line. This keeps production moving efficiently. AGV_1 is at P8 with a load, but there is currently no finished product at QualityCheck to pick up, so raw material movement takes priority for the single action needed.'
2025-07-26 21:59:09,563 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:09,564 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 615
2025-07-26 21:59:09,564 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]

Explanation:  
Both AGVs are available, but only one action is needed. AGV_2 is idle at P...'
2025-07-26 21:59:09,564 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:09,564 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_move_AGV2_P1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}]'
2025-07-26 21:59:09,564 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:09,564 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:09,564 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:09,564 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_move_AGV2_P1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753538349.564624}
2025-07-26 21:59:09,565 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_move_AGV2_P1 - move for AGV_2
2025-07-26 21:59:09,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6ddd0372', 'created_at': 210.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1290.0}
2025-07-26 21:59:09,666 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.32, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 41, 'completed_orders': 3, 'active_orders': 38, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:09,667 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:09,667 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2']
2025-07-26 21:59:09,771 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_959c4c0d', 'created_at': 210.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1410.0}
2025-07-26 21:59:09,771 - order - INFO - [order.py:245] - Created order order_959c4c0d with 2 products
2025-07-26 21:59:09,771 - order - INFO - [order.py:339] - Assigned 2 products from order order_959c4c0d to line1
2025-07-26 21:59:09,771 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_959c4c0d with 2 products to line1
2025-07-26 21:59:09,778 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6ddd0372', 'created_at': 210.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1290.0}
2025-07-26 21:59:09,858 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.32, 'average_production_cycle': 5.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 41, 'completed_orders': 3, 'active_orders': 38, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:09,870 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.14, 'average_production_cycle': 5.41, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:09,871 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.14, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:09,871 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.92, 'order_completion_rate': 7.14, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.42, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.29, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,166 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_959c4c0d', 'created_at': 210.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1410.0}
2025-07-26 21:59:10,168 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.14, 'average_production_cycle': 5.41, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,168 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.14, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,277 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.92, 'order_completion_rate': 7.14, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.42, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.29, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,387 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 212.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:59:10,387 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:59:10,584 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_959c4c0d', 'created_at': 210.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1410.0}
2025-07-26 21:59:10,585 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.14, 'average_production_cycle': 5.41, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,585 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 7.14, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.37, 'first_pass_rate': 100.0, 'total_production_cost': 173.28, 'material_costs': 80.0, 'energy_costs': 69.28, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.86, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,586 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.92, 'order_completion_rate': 7.14, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.42, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.29, 'total_orders': 42, 'completed_orders': 3, 'active_orders': 39, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:10,586 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 210.91666651, 'command_id': 'flow_20240618_move_AGV2_P1', 'response': 'Successfully arrived at path point P1, remaining battery: 41.1%'}
2025-07-26 21:59:10,586 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV2_P1 response: Successfully arrived at path point P1, remaining battery: 41.1%
2025-07-26 21:59:10,682 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 212.0, 'command_id': 'flow_20240618_move_AGV2_P1', 'response': 'Can not find path from P1 to P1'}
2025-07-26 21:59:10,683 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_move_AGV2_P1 response: Can not find path from P1 to P1
2025-07-26 21:59:12,844 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:13,234 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:14,480 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[
  {"command_id":"flow_20240628_agv1_load_finished", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]

Explanation:  
Both AGVs are idle and located at P8 (QualityCheck output) where there are two finished products ready. AGV_1 has no load, so its next step is to load one of the finished products at P8. AGV_2 already has a finished product loaded, so its next required step is to move to P9 (Warehouse) to deliver that product for unloading. Assigning these actions fulfills the top-priority finished product moves, maximizing throughput and keeping the output process flowing efficiently.'
2025-07-26 21:59:14,480 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:14,480 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 707
2025-07-26 21:59:14,480 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[
  {"command_id":"flow_20240628_agv1_load_finished", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"targe...'
2025-07-26 21:59:14,480 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:14,481 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[
  {"command_id":"flow_20240628_agv1_load_finished", "action":"load", "target":"AGV_1", "params":{}},
  {"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}
]'
2025-07-26 21:59:14,481 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 2 commands for available AGVs
2025-07-26 21:59:14,481 - src.line_commander - INFO - [line_commander.py:382] - Generated 2 commands for available AGVs for for line2
2025-07-26 21:59:14,481 - src.line_commander - INFO - [line_commander.py:400] - Executing 2 commands for different AGVs for line2
2025-07-26 21:59:14,481 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_load_finished', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753538354.481572}
2025-07-26 21:59:14,482 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_load_finished - load for AGV_1
2025-07-26 21:59:14,583 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538354.583291}
2025-07-26 21:59:14,584 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:59:14,685 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:14,686 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3']
2025-07-26 21:59:14,923 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:15,479 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:15,481 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and ready to load new materials. The next product to load, according to the actions queue, is "prod_2_dae91068". The workflow requires specifying the product_id when loading at P0. AGV_2 is not needed for a higher-priority task and only one command is issued per request, so AGV_1 is selected for this operation.'
2025-07-26 21:59:15,482 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:15,482 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 506
2025-07-26 21:59:15,482 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is at P0 (RawMaterial warehouse), idle, and re...'
2025-07-26 21:59:15,482 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:15,482 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:15,482 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:15,482 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:15,482 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:15,482 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538355.482461}
2025-07-26 21:59:15,482 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:15,584 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:15,585 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2']
2025-07-26 21:59:15,630 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:16,492 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:16,973 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 218.0, 'command_id': 'flow_20240624_load_prod2_dae91068', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:59:16,974 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_dae91068 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:59:17,401 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:18,571 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle and available at P0 (RawMaterial warehouse) with no load. The next scheduled action is to load the raw material "prod_2_dae91068" using the specific product_id, as required by the workflow. AGV_2 is also available, but no higher-priority action exists for it at this step and only one command is issued per request.'
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 477
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle and available at P0 (RawMaterial wareh...'
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:18,733 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:18,733 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:18,733 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538358.733599}
2025-07-26 21:59:18,733 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:18,834 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:18,835 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2']
2025-07-26 21:59:18,978 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_26abd6ad', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2980.0}
2025-07-26 21:59:18,979 - order - INFO - [order.py:245] - Created order order_26abd6ad with 5 products
2025-07-26 21:59:18,979 - order - INFO - [order.py:339] - Assigned 5 products from order order_26abd6ad to line2
2025-07-26 21:59:18,979 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_26abd6ad with 5 products to line2
2025-07-26 21:59:18,980 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.98, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 43, 'completed_orders': 3, 'active_orders': 40, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_unload_p9", "action":"unload", "target":"AGV_2", "params":{}}]

Explanation:  
Only AGV_2 is available for a new command (AGV_1 is busy). AGV_2 previously moved to P9 (Warehouse) after picking up a finished product. The correct step is now to unload the finished product at P9. This completes the high-priority finished product workflow and updates the system for the next set of actions. Only one command is sent as allowed per the rules.'
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 474
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_unload_p9", "action":"unload", "target":"AGV_2", "params":{}}]

Explanation:  
Only AGV_2 is available for a new command (AGV_1 is busy). AGV_2 previously moved to P...'
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_unload_p9", "action":"unload", "target":"AGV_2", "params":{}}]'
2025-07-26 21:59:18,981 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:18,981 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:18,981 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:18,982 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_unload_p9', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538358.981976}
2025-07-26 21:59:18,982 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_unload_p9 - unload for AGV_2
2025-07-26 21:59:19,083 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:19,084 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:59:19,171 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_26abd6ad', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2980.0}
2025-07-26 21:59:19,198 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_f5e6712d', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1660.0}
2025-07-26 21:59:19,198 - order - INFO - [order.py:245] - Created order order_f5e6712d with 3 products
2025-07-26 21:59:19,198 - order - INFO - [order.py:339] - Assigned 3 products from order order_f5e6712d to line3
2025-07-26 21:59:19,198 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_f5e6712d with 3 products to line3
2025-07-26 21:59:19,199 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.82, 'average_production_cycle': 5.66, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 44, 'completed_orders': 3, 'active_orders': 41, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:19,199 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.82, 'average_production_cycle': 5.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 44, 'completed_orders': 3, 'active_orders': 41, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:19,268 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.98, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 43, 'completed_orders': 3, 'active_orders': 40, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:19,494 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_f5e6712d', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1660.0}
2025-07-26 21:59:19,495 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.82, 'average_production_cycle': 5.66, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 44, 'completed_orders': 3, 'active_orders': 41, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:19,495 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.82, 'average_production_cycle': 5.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 44, 'completed_orders': 3, 'active_orders': 41, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:20,722 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 222.0, 'command_id': 'flow_20240624_load_prod2_dae91068', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:59:20,723 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_dae91068 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:59:20,793 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 212.0, 'command_id': 'flow_20240628_agv1_load_p8', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_1_2cbc9444Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 31.9%'}
2025-07-26 21:59:20,794 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load_p8 response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_1_2cbc9444Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 31.9%
2025-07-26 21:59:21,068 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 217.0, 'command_id': 'flow_20240628_agv1_load_finished', 'response': 'Can not load. AGV AGV_1 is not available or payload is full.'}
2025-07-26 21:59:21,068 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv1_load_finished response: Can not load. AGV AGV_1 is not available or payload is full.
2025-07-26 21:59:21,069 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 217.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:59:21,069 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:59:21,746 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:22,117 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Only AGV_2 is available for command issuance; AGV_1 is still busy. AGV_2 is currently at P8 (QualityCheck output) with a finished product loaded, so according to the process flow for finished products, it should now move to P9 (Warehouse) to deliver the finished product. This action follows the high-priority finished goods handling logic and maintains output flow. Only one command is generated as required.'
2025-07-26 21:59:22,117 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:22,117 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 538
2025-07-26 21:59:22,118 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]

Explanation:  
Only AGV_2 is available for command issuance; AGV_1 is still busy. AGV_...'
2025-07-26 21:59:22,118 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:22,118 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv2_move_p9", "action":"move", "target":"AGV_2", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:22,118 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:22,118 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:22,118 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:22,118 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753538362.118512}
2025-07-26 21:59:22,118 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv2_move_p9 - move for AGV_2
2025-07-26 21:59:22,220 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:22,221 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:59:22,848 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:22,962 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle, located at P0 (RawMaterial warehouse), and not carrying any load. The top priority action is to load the next raw material listed ("prod_2_dae91068"), which must be specified by product_id in the command. AGV_2 is available but is not required for any higher-priority task right now, and only one command is allowed per request. This keeps the production line flowing without violating any of the outlined priorities or rules.'
2025-07-26 21:59:22,963 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:22,963 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 589
2025-07-26 21:59:22,963 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle, located at P0 (RawMaterial warehouse)...'
2025-07-26 21:59:22,963 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:22,963 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:22,963 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:22,963 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:22,963 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:22,964 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538362.963961}
2025-07-26 21:59:22,964 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:23,065 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:23,066 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2']
2025-07-26 21:59:25,269 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
Both AGVs are available, but only one action is needed. AGV_2 is at StationA (P1), loaded (load:2), and idle. According to production flow, the next step after delivering raw materials to P1 is to unload them for processing at StationA. AGV_1 is at P8 with a load, but there are no finished products to move, so raw material unloading at P1 takes priority for the required action.'
2025-07-26 21:59:25,269 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:25,269 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 491
2025-07-26 21:59:25,269 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
Both AGVs are available, but only one action is needed. AGV_2 is at StationA (P1), loaded...'
2025-07-26 21:59:25,270 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:25,270 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:25,270 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:25,270 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:25,270 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:25,270 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538365.270526}
2025-07-26 21:59:25,270 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:25,371 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:25,371 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:26,362 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_26abd6ad', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2980.0}
2025-07-26 21:59:26,362 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.98, 'average_production_cycle': 5.5, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 43, 'completed_orders': 3, 'active_orders': 40, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:26,648 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:26,672 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
Both AGVs are available at P8 (QualityCheck output), but AGV_1 has the larger load (2), meaning it is carrying finished products ready for warehouse delivery. The highest priority action is to move finished products to the warehouse. Therefore, AGV_1 should move to P9 (Warehouse) to begin unloading these products. Only one command is needed this cycle, so AGV_1 is assigned the move to P9. AGV_2 remains ready for further steps.'
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 559
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
Both AGVs are available at P8 (QualityCheck output), but AGV_1 has the ...'
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:26,674 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:26,674 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:26,674 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:26,674 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538366.674838}
2025-07-26 21:59:26,675 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:26,776 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:26,776 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2']
2025-07-26 21:59:27,359 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:27,571 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:27,724 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 229.0, 'command_id': 'flow_20240618_unload_AGV2_P1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_932e77b9Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 40.6%'}
2025-07-26 21:59:27,724 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240618_unload_AGV2_P1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_932e77b9Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 40.6%
2025-07-26 21:59:27,884 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 228.0, 'command_id': 'flow_20240624_load_prod2_dae91068', 'response': 'StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 21:59:27,884 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240624_load_prod2_dae91068 response: StationA buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at the P0 (RawMaterial warehouse) location and is empty (not carrying a load). According to the decision priorities, the next highest task is to load the raw material "prod_2_dae91068" using a load command with the correct product_id. AGV_2 remains available, but since only one action is needed per request and there are no higher-priority actions for AGV_2, only AGV_1 is addressed this cycle.'
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 557
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at the P0 (RawMaterial warehouse) loca...'
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:27,988 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:27,988 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:27,988 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:27,989 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538367.98894}
2025-07-26 21:59:27,989 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:28,029 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:28,090 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:28,092 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2']
2025-07-26 21:59:28,569 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:28,611 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3e1a62c5', 'created_at': 230.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1190.0}
2025-07-26 21:59:28,611 - order - INFO - [order.py:245] - Created order order_3e1a62c5 with 2 products
2025-07-26 21:59:28,611 - order - INFO - [order.py:339] - Assigned 2 products from order order_3e1a62c5 to line1
2025-07-26 21:59:28,612 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_3e1a62c5 with 2 products to line1
2025-07-26 21:59:28,727 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.67, 'average_production_cycle': 5.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 45, 'completed_orders': 3, 'active_orders': 42, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:28,930 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c10dd9cc', 'created_at': 230.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1270.0}
2025-07-26 21:59:28,930 - order - INFO - [order.py:245] - Created order order_c10dd9cc with 3 products
2025-07-26 21:59:28,930 - order - INFO - [order.py:339] - Assigned 3 products from order order_c10dd9cc to line2
2025-07-26 21:59:28,930 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_c10dd9cc with 3 products to line2
2025-07-26 21:59:28,930 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.52, 'average_production_cycle': 5.83, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:28,931 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:29,172 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:29,192 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3e1a62c5', 'created_at': 230.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1190.0}
2025-07-26 21:59:29,296 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.67, 'average_production_cycle': 5.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 45, 'completed_orders': 3, 'active_orders': 42, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:29,463 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has two raw materials loaded. According to the production flow and your decision logic, the appropriate action now is to unload these materials at P1, so production can proceed. AGV_1 is at P8 with a load, but there is no finished product to transport right now; thus, AGV_2 should execute the unload at P1 as your highest-priority required action.'
2025-07-26 21:59:29,463 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:29,463 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 494
2025-07-26 21:59:29,463 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has two raw materials loaded. According to the product...'
2025-07-26 21:59:29,463 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:29,463 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:29,464 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:29,464 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:29,464 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:29,464 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538369.464231}
2025-07-26 21:59:29,464 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:29,565 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:29,566 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:29,671 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c10dd9cc', 'created_at': 230.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1270.0}
2025-07-26 21:59:29,689 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:30,114 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.52, 'average_production_cycle': 5.83, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:30,115 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:30,170 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle at P8 with finished product loads, but AGV_1 has a larger load (2). The top priority by workflow is to deliver finished products to the warehouse. To execute this, AGV_1 should move to P9 (Warehouse) for unloading. Only one command is needed for this cycle, so AGV_1 is selected for the move to P9. AGV_2 remains available for the next required action.'
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 511
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
Both AGV_1 and AGV_2 are idle at P8 with finished product loads, but AG...'
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:30,175 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:30,175 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:30,176 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:30,176 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538370.176065}
2025-07-26 21:59:30,176 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:30,277 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 21:59:30,278 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:30,504 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:30,772 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:31,028 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:31,319 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle, available, and stationed at P0 (RawMaterial warehouse) with no load. The most important action per decision logic is to load the next raw material for production, which is "prod_2_dae91068". The command specifies this product_id as required when loading from P0. AGV_2 remains available but is not assigned since only one command can be generated per request and there is no higher-priority task for AGV_2 at this time.'
2025-07-26 21:59:31,319 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:31,320 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 592
2025-07-26 21:59:31,320 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle, available, and stationed at...'
2025-07-26 21:59:31,320 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:31,320 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:31,320 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:31,320 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:31,320 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:31,320 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538371.320504}
2025-07-26 21:59:31,320 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:31,421 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:31,422 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:31,656 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_f5e6712d', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1660.0}
2025-07-26 21:59:31,656 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.82, 'average_production_cycle': 5.66, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 44, 'completed_orders': 3, 'active_orders': 41, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:31,878 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 6.82, 'average_production_cycle': 5.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.2, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 25.04, 'total_orders': 44, 'completed_orders': 3, 'active_orders': 41, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:31,878 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 222.0, 'command_id': 'flow_20240628_agv2_unload_p9', 'response': '‰∫ßÂìÅÁßªÂä®ËøùÂèçÂ∑•Ëâ∫Ë∑ØÁ∫ø: ‰∏çÂÖÅËÆ∏ÁöÑÁßªÂä®Ôºö‰ªé RawMaterial Âà∞ WarehouseÔºåÊúüÊúõ‰∏ã‰∏ÄÁ´ô: StationA'}
2025-07-26 21:59:31,878 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_unload_p9 response: ‰∫ßÂìÅÁßªÂä®ËøùÂèçÂ∑•Ëâ∫Ë∑ØÁ∫ø: ‰∏çÂÖÅËÆ∏ÁöÑÁßªÂä®Ôºö‰ªé RawMaterial Âà∞ WarehouseÔºåÊúüÊúõ‰∏ã‰∏ÄÁ´ô: StationA
2025-07-26 21:59:31,879 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 228.0, 'command_id': 'flow_20240628_agv2_move_p9', 'response': 'Can not find path from P9 to P9'}
2025-07-26 21:59:31,879 - src.line_commander - INFO - [line_commander.py:265] - Command flow_20240628_agv2_move_p9 response: Can not find path from P9 to P9
2025-07-26 21:59:32,078 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3e1a62c5', 'created_at': 230.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1190.0}
2025-07-26 21:59:32,177 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.67, 'average_production_cycle': 5.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 45, 'completed_orders': 3, 'active_orders': 42, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:32,186 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 233.1, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.02, 'first_pass_rate': 100.0, 'total_production_cost': 175.46, 'material_costs': 80.0, 'energy_costs': 71.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.43, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:32,698 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c10dd9cc', 'created_at': 230.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1270.0}
2025-07-26 21:59:32,699 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.52, 'average_production_cycle': 5.83, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:32,699 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.94, 'first_pass_rate': 100.0, 'total_production_cost': 174.46, 'material_costs': 80.0, 'energy_costs': 70.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.79, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:33,769 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:33,879 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
Both AGVs are idle at P8 (QualityCheck output) and are loaded with finished products, but AGV_1 has a larger load (2). The highest priority is to move finished products to the warehouse (P9). Therefore, the best action is for AGV_1 to move to P9 to begin unloading its finished products. Only one command is allowed per cycle, so AGV_1 is selected for the move to keep output flowing efficiently. AGV_2 remains available for the next task.'
2025-07-26 21:59:33,879 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:33,879 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 568
2025-07-26 21:59:33,880 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
Both AGVs are idle at P8 (QualityCheck output) and are loaded with fini...'
2025-07-26 21:59:33,880 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:33,880 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:33,880 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:33,880 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:33,880 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:33,880 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538373.880327}
2025-07-26 21:59:33,880 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:33,904 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 233.1, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.02, 'first_pass_rate': 100.0, 'total_production_cost': 175.46, 'material_costs': 80.0, 'energy_costs': 71.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.43, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:33,982 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:33,982 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:34,178 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:34,326 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle and positioned at P0 (RawMaterial warehouse) with no load. The highest priority according to the workflow is to load the next raw material: "prod_2_dae91068." This command specifies the required product_id, which is necessary when loading from P0. AGV_2 is available, but only one command is allowed per request and there are no higher-priority actions for it at this time.'
2025-07-26 21:59:34,326 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:34,326 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 535
2025-07-26 21:59:34,326 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle and positioned at P0 (RawMaterial ware...'
2025-07-26 21:59:34,326 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:34,327 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:34,327 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:34,327 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:34,327 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:34,327 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538374.327136}
2025-07-26 21:59:34,327 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:34,428 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:34,428 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:34,700 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 233.1, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 8.02, 'first_pass_rate': 100.0, 'total_production_cost': 175.46, 'material_costs': 80.0, 'energy_costs': 71.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 23.43, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 21:59:37,542 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:37,547 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and still has one raw material loaded. To maintain steady production flow, the most critical action is to unload this remaining raw material at StationA so processing can continue efficiently. AGV_1 is at P8, but since there is no finished product at QualityCheck, no transport is required from that end. Thus, the optimal command is for AGV_2 to unload at P1.'
2025-07-26 21:59:37,548 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:37,548 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 502
2025-07-26 21:59:37,548 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and still has one raw material loaded. To maintain steady ...'
2025-07-26 21:59:37,548 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:37,548 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:37,548 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:37,548 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:37,548 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:37,549 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538377.548961}
2025-07-26 21:59:37,549 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:37,650 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:37,651 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:38,063 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:38,988 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:39,161 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:39,529 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not carrying a load. The top-priority action, per the action queue and workflow, is to load the next raw material, "prod_2_dae91068," with the exact product_id. This command sets up AGV_1 to perform that load operation. AGV_2 remains available but is not given a command because only one command can be sent per request and no higher-priority actions require it.'
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 558
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not ...'
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:39,558 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:39,558 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:39,558 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:39,559 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538379.559001}
2025-07-26 21:59:39,559 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:39,660 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:39,661 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:40,050 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:40,470 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and still has one raw material loaded. Since the highest-priority action outside of emergencies is to unload raw material at P1 for production to proceed, the appropriate command is to have AGV_2 unload at P1. AGV_1 is at P8 with a load, but no finished product is in QualityCheck, so no transport action is needed there. Thus, the needed action is for AGV_2 to unload its cargo at P1 and keep production flowing.'
2025-07-26 21:59:40,471 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:40,471 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 555
2025-07-26 21:59:40,471 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and still has one raw material loaded. Since the highest-p...'
2025-07-26 21:59:40,471 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:40,471 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:40,471 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:40,471 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:40,471 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:40,472 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538380.47184}
2025-07-26 21:59:40,472 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:40,572 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:40,573 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:
AGV_1 is idle at P8 with a load of 2, making it the optimal candidate to move finished products to the warehouse (P9) per the highest current priority. AGV_2 is idle at P9 and loaded, likely awaiting an unload, but since only one action is requested, AGV_1 is assigned the move command. This ensures the continued flow of finished products and aligns with the workflow priorities. AGV_2‚Äôs next step (unload) will be handled in the next command cycle.'
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 577
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:
AGV_1 is idle at P8 with a load of 2, making it the optimal candidate to ...'
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:40,681 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:40,681 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:40,681 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:40,681 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538380.681746}
2025-07-26 21:59:40,681 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:40,783 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:40,784 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:43,088 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has no load. Decision priority 4 states that, when raw material is available, the AGV at P0 should load the next product. The next in the queue is "prod_2_dae91068", so the command issues a load with this exact product_id. AGV_2 is available, but no higher-priority actions require its use, and only one command is allowed per request.'
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 531
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has ...'
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:43,206 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:43,206 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:43,207 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:43,207 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538383.207044}
2025-07-26 21:59:43,207 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:43,308 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:43,309 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:43,365 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:45,973 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with a load of 2 finished products, making it the optimal candidate to move to P9 (Warehouse) for the next required operation. This follows the workflow for handling finished goods and gives priority to product delivery. AGV_2, while also available, is already at P9 and holding a load, likely awaiting an unload. Only one action is allowed, so the command is sent to AGV_1 for the move to P9. This ensures efficient and continuous finished product flow.'
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 625
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with a load of 2 finished pro...'
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:45,978 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:45,978 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:45,978 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:45,979 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538385.979005}
2025-07-26 21:59:45,979 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:46,080 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:46,081 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:46,829 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:46,858 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:47,289 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has one raw material still loaded. The best next step to maintain production flow is to unload this raw material at P1. There are no finished products requiring transport, and AGV_1's location and load are not needed for the next action. Thus, AGV_2 should unload at P1 as the only required action at this moment.'
2025-07-26 21:59:47,289 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:47,289 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 459
2025-07-26 21:59:47,289 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has one raw material still loaded. The best next step ...'
2025-07-26 21:59:47,289 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:47,289 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:47,290 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:47,290 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:47,290 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:47,290 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538387.290506}
2025-07-26 21:59:47,290 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:47,383 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse), not carrying a load, and available. The workflow's highest priority (after charging and finished products) is to load the next raw material using the specifed product_id, which here is "prod_2_dae91068". This command ensures the correct item is loaded per process requirements. AGV_2 is available but not assigned a task since only one action is permitted per request and there are no higher-priority needs for it at this moment.'
2025-07-26 21:59:47,384 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:47,384 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 622
2025-07-26 21:59:47,384 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse), not car...'
2025-07-26 21:59:47,384 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:47,384 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:47,384 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:47,384 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:47,384 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:47,384 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538387.384536}
2025-07-26 21:59:47,384 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:47,391 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 21:59:47,392 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:47,486 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:47,486 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:47,805 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:48,330 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:49,012 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 and has a load of 2 finished products, making it the correct AGV to move to P9 (Warehouse) for finished product delivery. AGV_2 is at P9 with a load (likely awaiting an unload command for next cycle). As only one command is required per request, AGV_1 is assigned to move to P9. This maintains efficient finished product handling as per decision priority and workflow.'
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 517
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 and has a load of 2 finished products, making it th...'
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:49,494 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:49,495 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:49,495 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:49,495 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538389.495158}
2025-07-26 21:59:49,495 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:49,596 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:49,597 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:50,123 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:52,000 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:52,109 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is at StationA (P1), idle, and has one remaining raw material on board. The highest-priority action is to unload the raw material at P1 so production can continue. AGV_1 is at P8 with a load, but there are no finished products to deliver from QualityCheck, so AGV_2 should proceed with the unload action. This maintains efficient flow of materials into production as per the decision priorities.'
2025-07-26 21:59:52,109 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:52,109 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 512
2025-07-26 21:59:52,109 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is at StationA (P1), idle, and has one remaining raw material on board. The highest...'
2025-07-26 21:59:52,109 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:52,110 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:52,110 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:52,110 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:52,110 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:52,110 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538392.11057}
2025-07-26 21:59:52,111 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:52,212 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:52,213 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:52,271 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is IDLE at P8 (QualityCheck output) and has a load of 2, meaning it is ready to deliver finished products to the warehouse (P9). Since delivering finished products is the current highest priority, AGV_1 should move to P9. AGV_2 is already at P9 with a load, but only one command is allowed per step, so AGV_1 is chosen for this cycle to ensure efficient throughput and constant flow of finished goods.'
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 536
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is IDLE at P8 (QualityCheck output) and has a load of 2, meaning ...'
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:53,052 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:53,052 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:53,052 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:53,052 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538393.052717}
2025-07-26 21:59:53,052 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:53,154 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:53,154 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has no load. According to the decision logic, the highest priority is to load the next raw material from P0 using the exact product_id, which in this case is "prod_2_dae91068." The command ensures the workflow continues correctly. AGV_2 is available, but only one command is allowed per request and there are no higher-priority or alternate tasks for it at this step.'
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 563
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and has ...'
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:53,654 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:53,654 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:53,654 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:53,654 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538393.654831}
2025-07-26 21:59:53,654 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:53,756 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:53,756 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:55,214 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:55,671 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:55,774 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and is still carrying one raw material. Since the transmission of raw materials to StationA is a high-priority, production-enabling action and there are no other higher priorities (such as emergencies or finished product deliveries), AGV_2 should unload at P1. AGV_1's current position and load do not create an urgent need. This command ensures continuous supply to the line.'
2025-07-26 21:59:55,775 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:55,775 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 518
2025-07-26 21:59:55,775 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and is still carrying one raw material. Since the transmis...'
2025-07-26 21:59:55,775 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:55,775 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:55,775 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:55,775 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:55,775 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:55,775 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538395.775596}
2025-07-26 21:59:55,775 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:55,877 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:55,878 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 21:59:56,196 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:56,197 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:56,717 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with two finished products loaded, which makes it the best candidate to move these finished products to the warehouse (P9) according to the current priorities. AGV_2 is already at P9 and likely waiting to unload, but only one command may be given per request. Sending AGV_1 to P9 ensures the continuous flow of finished goods out of the line and optimizes throughput.'
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 538
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with two finished products lo...'
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 21:59:56,835 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:56,835 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 21:59:56,835 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 21:59:56,835 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538396.83581}
2025-07-26 21:59:56,836 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 21:59:56,937 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:56,938 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:57,802 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:58,024 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is ready, idle, and in position at P0 (RawMaterial warehouse) with no load. The production priority is to load the next specified raw material, which is "prod_2_dae91068", using a load command with the required product_id. AGV_2 remains available but no higher-priority task exists for it, and only one command per request is allowed. This ensures maximum flow efficiency and compliance with process rules.'
2025-07-26 21:59:58,025 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:58,025 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 560
2025-07-26 21:59:58,025 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is ready, idle, and in position at P0 (RawMate...'
2025-07-26 21:59:58,025 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:58,025 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 21:59:58,025 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:58,025 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 21:59:58,025 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 21:59:58,025 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538398.025735}
2025-07-26 21:59:58,025 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 21:59:58,127 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 21:59:58,128 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 21:59:58,537 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 21:59:59,348 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle and loaded at StationA (P1), which means it is ready to unload raw materials for production. According to the decision logic, unloading raw material at P1 is the top-priority production action since there are no finished products or critical battery issues to address. AGV_1 is at P8 but does not match a current action or priority. This ensures continuous material flow to keep the production line supplied.'
2025-07-26 21:59:59,349 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 21:59:59,349 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 533
2025-07-26 21:59:59,349 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle and loaded at StationA (P1), which means it is ready to unload raw material...'
2025-07-26 21:59:59,349 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 21:59:59,349 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 21:59:59,349 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 21:59:59,349 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 21:59:59,349 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 21:59:59,350 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538399.349868}
2025-07-26 21:59:59,350 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 21:59:59,451 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 21:59:59,451 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:01,130 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:01,135 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle, located at P0 (RawMaterial warehouse), and currently not carrying a load. Per the decision logic, the top action is to load the next raw material using the specific product_id, which is "prod_2_dae91068". AGV_2 is available but not required for this step, and only one command can be executed per request. This ensures correct process flow and maintains system efficiency.'
2025-07-26 22:00:01,135 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:01,136 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 535
2025-07-26 22:00:01,136 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle, located at P0 (RawMaterial warehouse)...'
2025-07-26 22:00:01,136 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:01,136 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:01,136 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:01,136 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:01,136 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:01,137 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538401.136537}
2025-07-26 22:00:01,137 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:01,238 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:01,238 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:02,485 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one raw material loaded, which means the next required action is for it to unload at P1 for production to continue. According to decision logic, this is the highest-priority action available and keeps the raw material supply moving into processing. AGV_1 is idle at P8 with a load, but there are no finished products or QualityCheck needs at this moment, so AGV_2's unload at P1 takes precedence.'
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 543
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one raw material loaded, which means the next require...'
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:02,487 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:02,488 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:02,488 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:02,488 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538402.488069}
2025-07-26 22:00:02,488 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:02,589 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:02,590 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:03,533 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 238.2, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.84, 'first_pass_rate': 100.0, 'total_production_cost': 176.46, 'material_costs': 80.0, 'energy_costs': 72.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.86, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:00:04,066 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 238.2, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.84, 'first_pass_rate': 100.0, 'total_production_cost': 176.46, 'material_costs': 80.0, 'energy_costs': 72.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.86, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:00:04,803 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:04,915 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:04,920 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) and is loaded with 2 finished products, making it the optimal AGV to move to P9 (Warehouse) for product delivery. This action aligns with the highest current priority: clearing finished products from the line. AGV_2 is already at P9, likely waiting for an unload command and is not optimal for this move. Only one command is issued per decision cycle, so AGV_1 is selected to maximize output flow.'
2025-07-26 22:00:04,920 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:04,920 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 568
2025-07-26 22:00:04,920 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) and is loaded with 2 finished...'
2025-07-26 22:00:04,921 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:04,921 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:04,921 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:04,921 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:04,921 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:04,922 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538404.921953}
2025-07-26 22:00:04,922 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:04,933 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 238.2, 'order_completion_rate': 6.52, 'average_production_cycle': 6.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 7.84, 'first_pass_rate': 100.0, 'total_production_cost': 176.46, 'material_costs': 80.0, 'energy_costs': 72.46, 'maintenance_costs': 24.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 22.86, 'total_orders': 46, 'completed_orders': 3, 'active_orders': 43, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:00:05,024 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:05,025 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:06,777 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle, at P0 (RawMaterial warehouse), and has no load. The top priority per the workflow is to load the next scheduled raw material, "prod_2_dae91068", and the command must specify this product_id. AGV_2 is also available, but there are no higher-priority or special actions for it at the moment, and only one command should be issued per request. This keeps the production line moving efficiently and in compliance with operational rules.'
2025-07-26 22:00:06,777 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:06,777 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 605
2025-07-26 22:00:06,777 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle, at P0 (RawMaterial warehous...'
2025-07-26 22:00:06,778 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:06,778 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:06,778 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:06,778 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:06,778 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:06,778 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538406.778305}
2025-07-26 22:00:06,778 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:06,879 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:06,880 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:07,204 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:08,251 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:08,257 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 with a load of 2 finished products. The top priority by process logic is to move finished products to the warehouse (P9). Thus, AGV_1 should be dispatched to P9 to deliver its load. AGV_2 is already at P9 and loaded, probably awaiting an unload, but only one command should be issued; sending AGV_1 to P9 ensures a continuous flow of output products as per decision logic.'
2025-07-26 22:00:08,257 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:08,257 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 521
2025-07-26 22:00:08,257 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 with a load of 2 finished products. The top priorit...'
2025-07-26 22:00:08,257 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:08,257 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:08,258 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:08,258 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:08,258 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:08,258 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538408.258557}
2025-07-26 22:00:08,259 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:08,360 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 22:00:08,361 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:08,777 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:08,853 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one raw material loaded. The workflow dictates that the raw material should be unloaded at P1 to enable production at StationA. There are no more urgent priorities or finished product transfers currently, so unloading AGV_2 at P1 is the required and correct action for continued production flow. AGV_1, although loaded and idle at P8, is not required for any immediate action.'
2025-07-26 22:00:08,854 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:08,854 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 523
2025-07-26 22:00:08,854 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one raw material loaded. The workflow dictates that t...'
2025-07-26 22:00:08,854 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:08,854 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:08,854 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:08,854 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:08,854 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:08,854 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538408.854446}
2025-07-26 22:00:08,854 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:08,956 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:08,956 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:09,828 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:10,057 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle and at P0 (RawMaterial warehouse) with no load. In accordance with the workflow and priority rules, the next required action is to load the raw material "prod_2_dae91068," referencing the specific product_id. AGV_2 remains available but is not assigned a task since there are no higher-priority or alternate actions, and only one command is permitted per request. This ensures the production flow continues smoothly and in compliance with all rules.'
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 621
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle and at P0 (RawMaterial wareh...'
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:10,060 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:10,060 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:10,060 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:10,061 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538410.060934}
2025-07-26 22:00:10,061 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:10,162 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:10,163 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:11,147 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:12,032 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:12,449 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) and is loaded with 2 finished products. According to the workflow priorities, it should deliver these to the warehouse (P9). AGV_2 is already at P9 and loaded, likely waiting for a separate unload command in a future step. Only one command is needed at this step, so AGV_1 is assigned to move to P9 to maximize finished product throughput. This keeps the finished goods flow uninterrupted and efficiently utilizes both AGVs according to process priorities.'
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 627
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) and is loaded with 2 finished...'
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:12,453 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:12,453 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:12,454 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:12,454 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538412.454051}
2025-07-26 22:00:12,455 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:12,556 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:12,556 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:12,579 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:12,585 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
The current action needed is to unload raw material at StationA for processing. AGV_2 is idle, located at P1 (StationA), and has one raw material loaded. According to your workflow, unloading at P1 is the top priority to keep production moving. AGV_1 is idle at P8 but has no immediate or high-priority tasks to perform, so the correct action is for AGV_2 to unload at P1. This aligns with the decision logic and maintains optimal production flow.'
2025-07-26 22:00:12,585 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:12,585 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 558
2025-07-26 22:00:12,585 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
The current action needed is to unload raw material at StationA for processing. AGV_2 is ...'
2025-07-26 22:00:12,586 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:12,586 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:12,586 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:12,586 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:12,586 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:12,586 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538412.586223}
2025-07-26 22:00:12,586 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:12,687 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:12,688 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:13,034 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:13,279 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is available, idle, and currently at P0 (RawMaterial warehouse) with no load. The workflow's next required action is to load the specified raw material, which is "prod_2_dae91068." The command specifies this product ID as required. AGV_2 is also available, but no higher-priority or alternate actions are pending, and only one command should be issued per request. This ensures process continuity and adherence to system rules.'
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 581
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is available, idle, and currently at P0 (RawMa...'
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:13,497 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:13,497 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:13,497 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:13,497 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538413.497837}
2025-07-26 22:00:13,497 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:13,598 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:13,599 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:14,082 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:14,543 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:17,228 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:
AGV_2 is idle and loaded at StationA (P1). According to the production workflow and decision logic, the next priority is to unload this raw material at StationA so production can proceed. AGV_1 at P8 (with a load) is not required at this moment since there are no finished products needing transport or other higher-priority actions. Unloading AGV_2 at P1 is the most efficient way to maintain the production flow.'
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 523
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:
AGV_2 is idle and loaded at StationA (P1). According to the production workflow and decisio...'
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:17,234 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:17,235 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:17,235 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:17,235 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538417.235607}
2025-07-26 22:00:17,236 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:17,337 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:17,338 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:18,215 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle at P0 (RawMaterial warehouse) and not carrying a load. The highest workflow priority at this step is to load the next available raw material with the exact product_id, which is "prod_2_dae91068." AGV_2 is also available, but only one command is permitted per request and there are no higher-priority tasks, so only AGV_1 is utilized for this operation. This command maintains correct process flow and system efficiency.'
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 591
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is currently idle at P0 (RawMaterial warehouse...'
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:18,228 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:18,228 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:18,228 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:18,229 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538418.228981}
2025-07-26 22:00:18,229 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:18,330 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:18,331 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:19,014 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with 2 finished products loaded, so it is ready for the next step: delivery to P9 (Warehouse). Delivering finished products is the top priority, and AGV_2, though available, is already at P9 and cannot receive the move command for this step. Only one command is required, so AGV_1 is assigned to move to P9, maximizing finished product flow and following the production line logic.'
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 552
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with 2 finished products load...'
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:20,683 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:20,684 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:20,684 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:20,684 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538420.684321}
2025-07-26 22:00:20,684 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:20,786 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:20,786 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:21,626 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:21,884 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse), not carrying a load, and thus ready to continue production. The highest-priority action, according to your logic and the current factory state, is to load the next specified raw material from P0‚Äî"prod_2_dae91068". The command includes the required product_id. AGV_2 is available but unused since only one action is permitted per request and there are no higher-priority tasks for AGV_2 at this time.'
2025-07-26 22:00:21,885 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:21,885 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 592
2025-07-26 22:00:21,885 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse), not car...'
2025-07-26 22:00:21,885 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:21,885 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:21,885 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:21,885 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:21,885 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:21,885 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538421.885755}
2025-07-26 22:00:21,886 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:21,944 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:21,987 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:21,987 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:22,130 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one unit of raw material still loaded. As per the production flow and decision priorities, the next action must be to unload raw material at StationA, enabling processing to continue. AGV_1 remains idle at P8 with a load, but there is no finished product at QualityCheck needing attention, nor any other higher-priority need. This makes AGV_2's unload at P1 the correct and most efficient next step.'
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 546
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one unit of raw material still loaded. As per the pro...'
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:22,135 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:22,135 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:22,135 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:22,136 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538422.135882}
2025-07-26 22:00:22,136 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:22,238 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:22,239 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:22,931 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:23,455 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:23,801 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:24,088 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with a load of 2 finished products, making it the best choice for delivering these items to the warehouse (P9). Moving finished products is the top workflow priority. AGV_2 is already at P9 with a load, so while it's available, AGV_1 is the proper AGV for this move action. Only one command is permitted per cycle, thus AGV_1 is assigned to move to P9. This supports uninterrupted finished goods output and aligns perfectly with decision logic.'
2025-07-26 22:00:24,089 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:24,089 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 615
2025-07-26 22:00:24,089 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with a load of 2 finished pro...'
2025-07-26 22:00:24,089 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:24,089 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:24,089 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:24,089 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:24,089 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:24,090 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538424.089876}
2025-07-26 22:00:24,090 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:24,191 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:24,193 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:25,771 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:25,865 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has one raw material loaded. The next logical and required action is to unload this raw material at P1 for further processing, as per your decision priorities and the production flow. AGV_1 is at P8 with a load, but there is no finished product requiring pick-up or other higher-priority action right now. Therefore, AGV_2 should proceed with the unload at P1.'
2025-07-26 22:00:25,865 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:25,865 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 506
2025-07-26 22:00:25,865 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has one raw material loaded. The next logical and requ...'
2025-07-26 22:00:25,865 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:25,866 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:25,866 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:25,866 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:25,866 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:25,866 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538425.866202}
2025-07-26 22:00:25,866 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:25,967 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:25,968 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:26,279 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:26,284 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is available, idle, and at P0 (RawMaterial warehouse) with no current load. The workflow dictates that the next high-priority action is to load the next raw material, "prod_2_dae91068", which must be specified by exact product_id. AGV_2 is also available, but only one command is allowed per request and there are no higher-priority actions for AGV_2 right now. This keeps the production process efficient and follows the rules provided.'
2025-07-26 22:00:26,284 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:26,284 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 591
2025-07-26 22:00:26,284 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is available, idle, and at P0 (RawMaterial war...'
2025-07-26 22:00:26,284 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:26,284 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:26,285 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:26,285 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:26,285 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:26,285 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538426.285725}
2025-07-26 22:00:26,286 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:26,387 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:26,388 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:27,327 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with 2 finished products loaded. According to the priority rules and workflow, finished products should be delivered to the warehouse (P9). AGV_2 is available, but already at P9 and loaded, so AGV_1 should be tasked with the move. Only one action is specified for this request; thus, AGV_1 is assigned to move to P9, maximizing product throughput and adhering to the decision logic.'
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 553
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) with 2 finished products load...'
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:28,745 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:28,745 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:28,745 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:28,745 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538428.745763}
2025-07-26 22:00:28,745 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:28,847 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:28,847 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:28,925 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has one raw material loaded. The correct next step based on decision logic is to unload this raw material at P1, so production can proceed. AGV_1 is at P8, but there is no finished product at QualityCheck, so unloading at P1 is the single required action needed to maintain production flow.'
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 436
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) and has one raw material loaded. The correct next step bas...'
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:28,927 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:28,927 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:28,927 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538428.927567}
2025-07-26 22:00:28,927 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:29,029 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:29,029 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:29,419 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:29,424 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle and available at P0 (RawMaterial warehouse) with no current load. The most important action from the workflow is to load the next raw material for production, which is "prod_2_dae91068." This load command specifies the correct product_id as required. AGV_2 is also available, but only one command per request is allowed, and there are no pending higher-priority tasks for it. This keeps the production process efficient and rule-compliant.'
2025-07-26 22:00:29,425 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:29,425 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 601
2025-07-26 22:00:29,425 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle and available at P0 (RawMaterial wareh...'
2025-07-26 22:00:29,425 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:29,425 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:29,425 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:29,425 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:29,426 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:29,426 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538429.426226}
2025-07-26 22:00:29,426 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:29,528 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: new_order (severity: high)
2025-07-26 22:00:29,529 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:31,848 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:32,032 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:32,036 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is currently idle at StationA (P1) with one raw material still loaded. According to the workflow and priorities, the next step is to unload at P1 so StationA can receive material for processing. There is no finished product needing pickup and AGV_1 is not required for any immediate action. Thus, AGV_2's unload at P1 is the critical single action needed to maintain line flow.'
2025-07-26 22:00:32,037 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:32,037 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 494
2025-07-26 22:00:32,037 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is currently idle at StationA (P1) with one raw material still loaded. According to...'
2025-07-26 22:00:32,037 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:32,037 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:32,037 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:32,038 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:32,038 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:32,038 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538432.038233}
2025-07-26 22:00:32,038 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:32,140 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 22:00:32,141 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:32,908 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:33,942 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not carrying any load. The highest priority action in the current queue is to load the next raw material, "prod_2_dae91068", and the command specifies the product_id as required by your process rules. AGV_2 is available but not needed for this step since only one command can be sent per request and no higher-priority actions require its use. This maintains efficient and rule-compliant ops for the line.'
2025-07-26 22:00:33,942 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:33,943 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 601
2025-07-26 22:00:33,943 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]

**Explanation:**  
AGV_1 is idle at P0 (RawMaterial warehouse) and not ...'
2025-07-26 22:00:33,943 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:33,943 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240624_load_prod2_dae91068","action":"load","target":"AGV_1","params":{"product_id":"prod_2_dae91068"}}]'
2025-07-26 22:00:33,943 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:33,943 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:00:33,943 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line1
2025-07-26 22:00:33,943 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240624_load_prod2_dae91068', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_dae91068'}, 'timestamp': 1753538433.943505}
2025-07-26 22:00:33,943 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240624_load_prod2_dae91068 - load for AGV_1
2025-07-26 22:00:34,045 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:34,045 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line1 needs product types: ['P2', 'P1', 'P1', 'P1', 'P1', 'P3', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P2', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:36,312 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:00:36,564 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one unit of raw material loaded. According to the workflow and decision logic, the highest-priority action is for AGV_2 to unload at P1, ensuring StationA receives materials for further processing. There are no finished products or higher-priority tasks, and AGV_1 is not at a location where an immediate action is necessary. Thus, AGV_2 should execute the unload at P1 to support continued production flow.'
2025-07-26 22:00:36,565 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:36,565 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 554
2025-07-26 22:00:36,565 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]

Explanation:  
AGV_2 is idle at StationA (P1) with one unit of raw material loaded. According to the wor...'
2025-07-26 22:00:36,565 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:36,565 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240618_unload_AGV2_P1","action":"unload","target":"AGV_2","params":{}}]'
2025-07-26 22:00:36,565 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:36,565 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:00:36,565 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line3
2025-07-26 22:00:36,565 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240618_unload_AGV2_P1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753538436.565508}
2025-07-26 22:00:36,565 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240618_unload_AGV2_P1 - unload for AGV_2
2025-07-26 22:00:36,667 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:36,667 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line3 needs product types: ['P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P3', 'P3', 'P2', 'P1', 'P1', 'P3', 'P1', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P3', 'P2', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:156] - Raw AI output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) and carrying 2 finished products, which makes it the top candidate for delivery to P9 (Warehouse) as per workflow priorities. AGV_2 is already at P9 with a load and cannot execute the same move. As only one action is to be issued this cycle, AGV_1 is selected to move to P9. This ensures continued and efficient transfer of finished goods to warehouse storage.'
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:157] - AI output type: <class 'str'>
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:158] - AI output length: 531
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:635] - Attempting to parse string output: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]

Explanation:  
AGV_1 is idle at P8 (QualityCheck output) and carrying 2 finished produ...'
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:649] - Extracting JSON from mixed content
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:654] - Extracted JSON: '[{"command_id":"flow_20240628_agv1_move_p9", "action":"move", "target":"AGV_1", "params":{"target_point":"P9"}}]'
2025-07-26 22:00:36,791 - src.product_flow_agent - INFO - [product_flow_agent.py:168] - Generated 1 commands for available AGVs
2025-07-26 22:00:36,791 - src.line_commander - INFO - [line_commander.py:382] - Generated 1 commands for available AGVs for for line2
2025-07-26 22:00:36,791 - src.line_commander - INFO - [line_commander.py:400] - Executing 1 commands for different AGVs for line2
2025-07-26 22:00:36,791 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20240628_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753538436.791744}
2025-07-26 22:00:36,791 - src.line_commander - INFO - [line_commander.py:426] - Executed command: flow_20240628_agv1_move_p9 - move for AGV_1
2025-07-26 22:00:36,893 - src.line_commander - INFO - [line_commander.py:362] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:00:36,894 - src.product_flow_agent - INFO - [product_flow_agent.py:519] - Line line2 needs product types: ['P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P2', 'P2', 'P3', 'P2', 'P1', 'P1', 'P1', 'P3', 'P2', 'P2', 'P2', 'P2', 'P3', 'P2', 'P3', 'P3', 'P1', 'P1', 'P2', 'P1', 'P3', 'P1', 'P3', 'P1', 'P1', 'P2', 'P2', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:00:37,227 - __main__ - INFO - [main.py:207] - Received signal 2, initiating shutdown...
2025-07-26 22:00:38,100 - __main__ - INFO - [main.py:136] - Initiating graceful shutdown of all production lines...
2025-07-26 22:00:38,101 - __main__ - INFO - [main.py:144] - Stopping line1...
2025-07-26 22:00:38,102 - src.utils.mqtt_client - INFO - [mqtt_client.py:73] - Disconnecting from MQTT Broker.
2025-07-26 22:00:38,682 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:39,059 - src.utils.mqtt_client - WARNING - [mqtt_client.py:40] - Disconnected from MQTT Broker with reason code: 0. Reconnecting...
2025-07-26 22:00:39,059 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:428] - MQTT listener manager stopped
2025-07-26 22:00:39,060 - src.line_commander - INFO - [line_commander.py:440] - Line Commander line1 stopped
2025-07-26 22:00:39,060 - __main__ - INFO - [main.py:146] - ‚úÖ line1 stopped
2025-07-26 22:00:39,060 - __main__ - INFO - [main.py:144] - Stopping line2...
2025-07-26 22:00:39,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:73] - Disconnecting from MQTT Broker.
2025-07-26 22:00:39,486 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:00:39,712 - src.utils.mqtt_client - WARNING - [mqtt_client.py:40] - Disconnected from MQTT Broker with reason code: 0. Reconnecting...
2025-07-26 22:00:39,712 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:428] - MQTT listener manager stopped
2025-07-26 22:00:39,712 - src.line_commander - INFO - [line_commander.py:440] - Line Commander line2 stopped
2025-07-26 22:00:39,712 - __main__ - INFO - [main.py:146] - ‚úÖ line2 stopped
2025-07-26 22:00:39,712 - __main__ - INFO - [main.py:144] - Stopping line3...
2025-07-26 22:00:39,712 - src.utils.mqtt_client - INFO - [mqtt_client.py:73] - Disconnecting from MQTT Broker.
2025-07-26 22:00:40,686 - src.utils.mqtt_client - WARNING - [mqtt_client.py:40] - Disconnected from MQTT Broker with reason code: 0. Reconnecting...
2025-07-26 22:00:40,686 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:428] - MQTT listener manager stopped
2025-07-26 22:00:40,687 - src.line_commander - INFO - [line_commander.py:440] - Line Commander line3 stopped
2025-07-26 22:00:40,687 - __main__ - INFO - [main.py:146] - ‚úÖ line3 stopped
2025-07-26 22:00:40,687 - __main__ - INFO - [main.py:152] - Cancelling 3 running tasks...
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:136] - Initiating graceful shutdown of all production lines...
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:144] - Stopping line1...
2025-07-26 22:00:40,688 - src.line_commander - INFO - [line_commander.py:440] - Line Commander line1 stopped
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:146] - ‚úÖ line1 stopped
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:144] - Stopping line2...
2025-07-26 22:00:40,688 - src.line_commander - INFO - [line_commander.py:440] - Line Commander line2 stopped
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:146] - ‚úÖ line2 stopped
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:144] - Stopping line3...
2025-07-26 22:00:40,688 - src.line_commander - INFO - [line_commander.py:440] - Line Commander line3 stopped
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:146] - ‚úÖ line3 stopped
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:152] - Cancelling 3 running tasks...
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:163] - üõë All production lines have been shut down
2025-07-26 22:00:40,688 - __main__ - INFO - [main.py:163] - üõë All production lines have been shut down
2025-07-26 22:00:41,614 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:00,911 - __main__ - INFO - [main.py:233] - üè≠ Starting Multi-Line Factory Automation System
2025-07-26 22:50:00,912 - __main__ - INFO - [main.py:234] -    Topic Root: yangzhi
2025-07-26 22:50:00,912 - __main__ - INFO - [main.py:235] -    Max Orders Per Cycle: 2
2025-07-26 22:50:00,912 - __main__ - INFO - [main.py:236] -    Production Lines: line1, line2, line3
2025-07-26 22:50:00,912 - __main__ - INFO - [main.py:237] -    Total AGVs: 6 (2 per line)
2025-07-26 22:50:00,912 - __main__ - INFO - [main.py:56] - Initializing Line Commanders for all production lines...
2025-07-26 22:50:00,912 - __main__ - INFO - [main.py:60] - Creating Line Commander for line1...
2025-07-26 22:50:00,912 - shared_order_manager - INFO - [shared_order_manager.py:38] - SharedOrderManager initialized
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for station_status
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for agv_status
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for conveyor_status
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for warehouse_status
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for alerts
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for orders
2025-07-26 22:50:00,915 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for responses
2025-07-26 22:50:00,915 - __main__ - INFO - [main.py:65] - ‚úÖ Line Commander for line1 created successfully
2025-07-26 22:50:00,915 - __main__ - INFO - [main.py:60] - Creating Line Commander for line2...
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for station_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for agv_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for conveyor_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for warehouse_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for alerts
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for orders
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for responses
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:65] - ‚úÖ Line Commander for line2 created successfully
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:60] - Creating Line Commander for line3...
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for station_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for agv_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for conveyor_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for warehouse_status
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for alerts
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for orders
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:86] - Registered handler for responses
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:65] - ‚úÖ Line Commander for line3 created successfully
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:71] - üéâ All 3 Line Commanders initialized successfully
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:77] - Starting operations for all production lines...
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:84] - Starting operations for line1...
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:90] - ‚úÖ line1 operations started
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:84] - Starting operations for line2...
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:90] - ‚úÖ line2 operations started
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:84] - Starting operations for line3...
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:90] - ‚úÖ line3 operations started
2025-07-26 22:50:00,916 - __main__ - INFO - [main.py:96] - üöÄ All 3 production lines are now operational!
2025-07-26 22:50:00,916 - src.line_commander - INFO - [line_commander.py:308] - Starting Line Commander for line1
2025-07-26 22:50:00,916 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:93] - Starting MQTT listener manager...
2025-07-26 22:50:00,916 - src.utils.mqtt_client - INFO - [mqtt_client.py:62] - Connecting to MQTT Broker at supos-ce-instance4.supos.app:1883...
2025-07-26 22:50:01,059 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/station/+/status
2025-07-26 22:50:01,059 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:112] - Subscribed to station status: yangzhi/line1/station/+/status
2025-07-26 22:50:01,059 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/agv/+/status
2025-07-26 22:50:01,059 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:117] - Subscribed to AGV status: yangzhi/line1/agv/+/status
2025-07-26 22:50:01,059 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/conveyor/+/status
2025-07-26 22:50:01,059 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:122] - Subscribed to conveyor status: yangzhi/line1/conveyor/+/status
2025-07-26 22:50:01,059 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/warehouse/RawMaterial/status
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:127] - Subscribed to Rawmaterial warehouse status: yangzhi/warehouse/RawMaterial/status
2025-07-26 22:50:01,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line1/alerts
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:132] - Subscribed to alerts: yangzhi/line1/alerts
2025-07-26 22:50:01,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/orders/status
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:137] - Subscribed to orders: yangzhi/orders/status
2025-07-26 22:50:01,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/response/line1
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:142] - Subscribed to responses: yangzhi/response/line1
2025-07-26 22:50:01,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/kpi/status
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:147] - Subscribed to KPI: yangzhi/kpi/status
2025-07-26 22:50:01,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/result/status
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:152] - Subscribed to results: yangzhi/result/status
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:100] - MQTT listener manager started successfully
2025-07-26 22:50:01,060 - src.line_commander - INFO - [line_commander.py:308] - Starting Line Commander for line2
2025-07-26 22:50:01,060 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:93] - Starting MQTT listener manager...
2025-07-26 22:50:01,060 - src.utils.mqtt_client - INFO - [mqtt_client.py:62] - Connecting to MQTT Broker at supos-ce-instance4.supos.app:1883...
2025-07-26 22:50:01,179 - src.utils.mqtt_client - INFO - [mqtt_client.py:31] - Successfully connected to MQTT Broker at supos-ce-instance4.supos.app:1883
2025-07-26 22:50:06,064 - src.utils.mqtt_client - ERROR - [mqtt_client.py:66] - Error connecting to MQTT Broker: timed out
2025-07-26 22:50:06,064 - src.mqtt_listener_manager - ERROR - [mqtt_listener_manager.py:103] - Failed to start MQTT listener: timed out
2025-07-26 22:50:06,065 - src.line_commander - INFO - [line_commander.py:308] - Starting Line Commander for line3
2025-07-26 22:50:06,065 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:93] - Starting MQTT listener manager...
2025-07-26 22:50:06,065 - src.utils.mqtt_client - INFO - [mqtt_client.py:62] - Connecting to MQTT Broker at supos-ce-instance4.supos.app:1883...
2025-07-26 22:50:07,402 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/station/+/status
2025-07-26 22:50:07,403 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:112] - Subscribed to station status: yangzhi/line3/station/+/status
2025-07-26 22:50:07,403 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/agv/+/status
2025-07-26 22:50:07,403 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:117] - Subscribed to AGV status: yangzhi/line3/agv/+/status
2025-07-26 22:50:07,403 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/conveyor/+/status
2025-07-26 22:50:07,403 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:122] - Subscribed to conveyor status: yangzhi/line3/conveyor/+/status
2025-07-26 22:50:07,403 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/warehouse/RawMaterial/status
2025-07-26 22:50:07,403 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:127] - Subscribed to Rawmaterial warehouse status: yangzhi/warehouse/RawMaterial/status
2025-07-26 22:50:07,403 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/line3/alerts
2025-07-26 22:50:07,403 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:132] - Subscribed to alerts: yangzhi/line3/alerts
2025-07-26 22:50:07,404 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/orders/status
2025-07-26 22:50:07,404 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:137] - Subscribed to orders: yangzhi/orders/status
2025-07-26 22:50:07,404 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/response/line3
2025-07-26 22:50:07,404 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:142] - Subscribed to responses: yangzhi/response/line3
2025-07-26 22:50:07,404 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/kpi/status
2025-07-26 22:50:07,404 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:147] - Subscribed to KPI: yangzhi/kpi/status
2025-07-26 22:50:07,404 - src.utils.mqtt_client - INFO - [mqtt_client.py:92] - Subscribing to topic: yangzhi/result/status
2025-07-26 22:50:07,404 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:152] - Subscribed to results: yangzhi/result/status
2025-07-26 22:50:07,404 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:100] - MQTT listener manager started successfully
2025-07-26 22:50:07,404 - __main__ - INFO - [main.py:102] - Starting line monitoring...
2025-07-26 22:50:07,404 - __main__ - ERROR - [main.py:116] - ‚ùå LineCommander_line2 failed with error: timed out
2025-07-26 22:50:07,404 - __main__ - WARNING - [main.py:123] - ‚ö†Ô∏è  1 line(s) stopped. Remaining active: 2
2025-07-26 22:50:07,405 - src.line_commander - INFO - [line_commander.py:332] - Starting main decision cycle for line1...
2025-07-26 22:50:07,406 - src.line_commander - INFO - [line_commander.py:344] - Starting reactive decision processor for line1...
2025-07-26 22:50:07,406 - src.line_commander - INFO - [line_commander.py:332] - Starting main decision cycle for line3...
2025-07-26 22:50:07,407 - src.line_commander - INFO - [line_commander.py:344] - Starting reactive decision processor for line3...
2025-07-26 22:50:10,012 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8c9906c4', 'created_at': 20.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1850.0}
2025-07-26 22:50:10,012 - order - INFO - [order.py:245] - Created order order_8c9906c4 with 3 products
2025-07-26 22:50:10,013 - order - INFO - [order.py:339] - Assigned 3 products from order order_8c9906c4 to line1
2025-07-26 22:50:10,013 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_8c9906c4 with 3 products to line1
2025-07-26 22:50:10,013 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 3, 'completed_orders': 0, 'active_orders': 3, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:10,466 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d10e5811', 'created_at': 20.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 500.0}
2025-07-26 22:50:10,467 - order - INFO - [order.py:245] - Created order order_d10e5811 with 1 products
2025-07-26 22:50:10,467 - order - INFO - [order.py:339] - Assigned 1 products from order order_d10e5811 to line2
2025-07-26 22:50:10,467 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_d10e5811 with 1 products to line2
2025-07-26 22:50:10,468 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 20.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 4, 'completed_orders': 0, 'active_orders': 4, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:11,093 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:11,094 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:11,094 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:11,094 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3']
2025-07-26 22:50:12,200 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
No commands are required at this time because there are no actions needed according to the line status and current state. Both AGVs are available at startup, all stations and conveyors are idle, and there are no raw materials, finished products, or P3 products awaiting transfer. Therefore, no movement or operations are necessary.'
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 351
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
No commands are required at this time because there are no actions needed according to the line status and current state. Both AGVs are available at startup, all stations and conve...'
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:50:12,506 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:50:12,507 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:50:12,507 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:50:12,507 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 0, Finished products: 0
2025-07-26 22:50:13,644 - src.utils.mqtt_client - INFO - [mqtt_client.py:31] - Successfully connected to MQTT Broker at supos-ce-instance4.supos.app:1883
2025-07-26 22:50:14,424 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv1_rawmat","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
Both AGV_1 and AGV_2 are available and idle. The reactive event is the arrival of new raw materials at P0 (RawMaterial warehouse), making handling raw material the top priority (high severity). According to the decision logic, AGV_1 is sent to P0 to begin the process of supplying raw material for production. This prepares AGV_1 to load the first available product ("prod_1_495dbb33") in the next step. Only one action was required by the prompt, so only AGV_1 is given this command.'
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 607
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv1_rawmat","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
Both AGV_1 and AGV_2 are available and idle. The reactive event is the arriva...'
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv1_rawmat","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]'
2025-07-26 22:50:14,581 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:14,582 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:14,582 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:14,582 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv1_rawmat', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541414.582122}
2025-07-26 22:50:14,582 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv1_rawmat - move for AGV_1
2025-07-26 22:50:14,684 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:14,684 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:14,685 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3']
2025-07-26 22:50:15,125 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:16,478 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:16,929 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
A new batch of raw materials has become available at the RawMaterial warehouse (P0), and there is a high-priority need to begin the next production cycle. Both AGVs are available at startup, but only one action is required now. AGV_1 is being sent to P0 so it can start the process of supplying raw materials (starting with "prod_1_495dbb33" as the next product in queue). This move prepares AGV_1 for the subsequent load and delivery steps. AGV_2 remains idle for future parallel tasks as needed.'
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 621
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
A new batch of raw materials has become available at the RawMaterial warehou...'
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]'
2025-07-26 22:50:16,931 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:16,931 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:16,931 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:16,931 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541416.93161}
2025-07-26 22:50:16,931 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv1_move_p0 - move for AGV_1
2025-07-26 22:50:17,033 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:17,033 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:17,033 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3']
2025-07-26 22:50:18,326 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
No actions are currently required for either AGV since both AGVs are available, started up, and there are no pending actions at any station, conveyor, or buffer. There are no raw materials, finished products, or P3 special handling required, and the batteries are not below the critical threshold. Therefore, no commands need to be issued at this time.'
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 372
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
No actions are currently required for either AGV since both AGVs are available, started up, and there are no pending actions at any station, conveyor, or buffer. There are no raw m...'
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:50:18,327 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:50:18,328 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:50:18,328 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 0, Finished products: 0
2025-07-26 22:50:20,507 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3']
2025-07-26 22:50:20,509 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:20,509 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:20,509 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: []
2025-07-26 22:50:21,042 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_328c8d44', 'created_at': 30.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1740.0}
2025-07-26 22:50:21,043 - order - INFO - [order.py:245] - Created order order_328c8d44 with 3 products
2025-07-26 22:50:21,043 - order - INFO - [order.py:339] - Assigned 3 products from order order_328c8d44 to line3
2025-07-26 22:50:21,043 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_328c8d44 with 3 products to line3
2025-07-26 22:50:21,603 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 5, 'completed_orders': 0, 'active_orders': 5, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:21,603 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_0b0710bc', 'created_at': 30.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2010.0}
2025-07-26 22:50:21,603 - order - INFO - [order.py:245] - Created order order_0b0710bc with 3 products
2025-07-26 22:50:21,603 - order - INFO - [order.py:339] - Assigned 3 products from order order_0b0710bc to line1
2025-07-26 22:50:21,603 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_0b0710bc with 3 products to line1
2025-07-26 22:50:21,702 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:22,145 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_328c8d44', 'created_at': 30.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1740.0}
2025-07-26 22:50:22,148 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 5, 'completed_orders': 0, 'active_orders': 5, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:22,152 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_0b0710bc', 'created_at': 30.0, 'items': [{'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2010.0}
2025-07-26 22:50:22,261 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 30.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 0.0, 'first_pass_rate': 0.0, 'total_production_cost': 0.0, 'material_costs': 0.0, 'energy_costs': 0.0, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 0.0, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:22,967 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 33.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.64, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.36, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:22,967 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 33.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 2.64, 'first_pass_rate': 0.0, 'total_production_cost': 1.79, 'material_costs': 0.0, 'energy_costs': 1.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 26.36, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:23,191 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 33.949999, 'command_id': 'flow_20.0_agv1_rawmat', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 22:50:23,192 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv1_rawmat response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 22:50:23,284 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:23,496 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:23,499 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:
AGV_1 is currently moving and not at the correct location to execute a raw material pickup, so it cannot be assigned a new command. AGV_2 is available at startup and idle, making it the best candidate for raw material handling. The high-priority action is to supply raw material for production, and the next required operation is to move AGV_2 to the RawMaterial warehouse (P0) to prepare for picking the next raw material ("prod_1_495dbb33"). Therefore, the command directs AGV_2 to P0.'
2025-07-26 22:50:23,500 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:23,500 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 611
2025-07-26 22:50:23,500 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:
AGV_1 is currently moving and not at the correct location to execute a raw m...'
2025-07-26 22:50:23,500 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:23,500 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:50:23,500 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:23,500 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:23,500 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:23,500 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv2_move_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541423.500621}
2025-07-26 22:50:23,500 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv2_move_p0 - move for AGV_2
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:
A new high-severity event indicates more raw materials are available at P0. AGV_1 is currently moving and not fully available for a new command. AGV_2, however, is available and idle at startup, so it is commanded to move to P0 to handle the new raw materials supply (with the next product being "prod_1_495dbb33"). This ensures that raw material handling proceeds with no delay using the next available AGV, in accordance with the priority logic. Only one command is issued, as required.'
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 612
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:
A new high-severity event indicates more raw materials are available at P0. ...'
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:50:23,501 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:23,501 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:23,501 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:23,501 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv2_move_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541423.501656}
2025-07-26 22:50:23,501 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv2_move_p0 - move for AGV_2
2025-07-26 22:50:23,602 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:50:23,602 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:50:23,602 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3']
2025-07-26 22:50:24,013 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:24,537 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:24,797 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:  
A high-severity event has triggered the supply of raw materials to the RawMaterial warehouse at P0 (including products of types P1, P2, and P3). According to the decision logic, after ensuring there are no battery emergencies or finished products for immediate transfer, the next high-priority action is to begin new production by moving AGVs to the raw material source (P0). Both AGVs are available and idle, so each is dispatched to P0 to begin the process of loading raw materials for further production flows. This reactive move allows both AGVs to simultaneously pick up raw materials, enabling efficient start of production for orders across all product types.'
2025-07-26 22:50:24,797 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:24,797 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 901
2025-07-26 22:50:24,797 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:50:24,798 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:24,798 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:50:24,798 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:24,798 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:24,798 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:24,799 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_move_to_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541424.798901}
2025-07-26 22:50:24,799 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_move_to_p0 - move for AGV_1
2025-07-26 22:50:24,900 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_move_to_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541424.900283}
2025-07-26 22:50:24,900 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_move_to_p0 - move for AGV_2
2025-07-26 22:50:25,001 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:25,001 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:25,001 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1']
2025-07-26 22:50:25,060 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:25,854 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:25,878 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 36.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.84, 'first_pass_rate': 0.0, 'total_production_cost': 3.58, 'material_costs': 0.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 48.44, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:25,878 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 36.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.84, 'first_pass_rate': 0.0, 'total_production_cost': 3.58, 'material_costs': 0.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 48.44, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:26,305 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 36.949999, 'command_id': 'flow_20.0_agv1_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 45.4%'}
2025-07-26 22:50:26,305 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv1_move_p0 response: Successfully arrived at path point P0, remaining battery: 45.4%
2025-07-26 22:50:26,329 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1']
2025-07-26 22:50:27,682 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:27,828 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:  
The reactive event indicates that raw materials are available at the RawMaterial warehouse (P0), and both AGVs are available and idle. According to the decision logic, the highest relevant priority is to start new production by collecting raw materials. The appropriate first action is to move both AGVs to P0 to prepare for loading specific product IDs (such as prod_1_495dbb33, prod_3_4d122871, and prod_1_fa0a15ba) for the production process. This ensures an efficient start to moving raw materials into the line and leverages all available AGV capacity.'
2025-07-26 22:50:27,829 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:27,829 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 792
2025-07-26 22:50:27,829 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:50:27,829 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:27,829 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:50:27,829 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:27,829 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:27,829 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:27,829 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_move_to_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541427.829554}
2025-07-26 22:50:27,829 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_move_to_p0 - move for AGV_1
2025-07-26 22:50:27,931 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_move_to_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541427.93112}
2025-07-26 22:50:27,932 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_move_to_p0 - move for AGV_2
2025-07-26 22:50:28,034 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:28,034 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:28,034 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1']
2025-07-26 22:50:28,733 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:28,844 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv1_load_rawmat_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}}
]

Explanation:
AGV_1 is idle and already located at P0 (RawMaterial warehouse) with no payload, making it ready to load raw material. The highest priority action (after charging, which is not needed) is handling raw materials for the new order. According to the event details, the next product to load is "prod_1_495dbb33". Therefore, AGV_1 is commanded to load this product at P0, immediately initiating the supply chain for the new order. AGV_2 remains available for parallel or future tasks as required.'
2025-07-26 22:50:28,844 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:28,845 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 646
2025-07-26 22:50:28,845 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv1_load_rawmat_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}}
]

Explanation:
AGV_1 is idle and already located at P0 (RawM...'
2025-07-26 22:50:28,845 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:28,845 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv1_load_rawmat_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}}
]'
2025-07-26 22:50:28,845 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:28,845 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:28,845 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:28,845 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv1_load_rawmat_prod_1_495dbb33', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_495dbb33'}, 'timestamp': 1753541428.845408}
2025-07-26 22:50:28,845 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv1_load_rawmat_prod_1_495dbb33 - load for AGV_1
2025-07-26 22:50:28,851 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}},
  {"command_id":"flow_30_agv2_load_prod_3_4d122871","action":"load","target":"AGV_2","params":{"product_id":"prod_3_4d122871"}}
]

Explanation:  
Both AGVs are now at the RawMaterial warehouse (P0) and raw materials are available for loading. According to the decision logic, it's high priority to start new production by loading specific product IDs. AGV_1 is assigned to load the next P1 raw material (prod_1_495dbb33), and AGV_2 is assigned to load the next P3 raw material (prod_3_4d122871). The commands reflect that each AGV loads a specific product, enabling efficient and parallel progression for both single-pass and double-pass production lines.'
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 786
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}},
  {"command_id":"flow_30_agv2_load_prod_3_4d122871","action":"load","...'
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}},
  {"command_id":"flow_30_agv2_load_prod_3_4d122871","action":"load","target":"AGV_2","params":{"product_id":"prod_3_4d122871"}}
]'
2025-07-26 22:50:28,853 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:28,853 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:28,853 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:28,853 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_1_495dbb33', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_495dbb33'}, 'timestamp': 1753541428.853814}
2025-07-26 22:50:28,853 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_1_495dbb33 - load for AGV_1
2025-07-26 22:50:28,946 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:28,947 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3']
2025-07-26 22:50:28,954 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_3_4d122871', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_3_4d122871'}, 'timestamp': 1753541428.954773}
2025-07-26 22:50:28,955 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_3_4d122871 - load for AGV_2
2025-07-26 22:50:29,597 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 40.0, 'command_id': 'flow_30_agv1_load_prod_1_495dbb33', 'response': 'No device can be operated for AGV_1 at position P10'}
2025-07-26 22:50:29,597 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_1_495dbb33 response: No device can be operated for AGV_1 at position P10
2025-07-26 22:50:29,597 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 40.0, 'command_id': 'flow_30_agv2_load_prod_3_4d122871', 'response': 'No device can be operated for AGV_2 at position P10'}
2025-07-26 22:50:29,597 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_3_4d122871 response: No device can be operated for AGV_2 at position P10
2025-07-26 22:50:30,411 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.47, 'first_pass_rate': 0.0, 'total_production_cost': 13.58, 'material_costs': 10.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.75, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:30,449 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.47, 'first_pass_rate': 0.0, 'total_production_cost': 13.58, 'material_costs': 10.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.75, 'total_orders': 6, 'completed_orders': 0, 'active_orders': 6, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:30,450 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4c346b00', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 520.0}
2025-07-26 22:50:30,450 - order - INFO - [order.py:245] - Created order order_4c346b00 with 1 products
2025-07-26 22:50:30,451 - order - INFO - [order.py:339] - Assigned 1 products from order order_4c346b00 to line2
2025-07-26 22:50:30,451 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_4c346b00 with 1 products to line2
2025-07-26 22:50:30,451 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.47, 'first_pass_rate': 0.0, 'total_production_cost': 13.58, 'material_costs': 10.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.75, 'total_orders': 7, 'completed_orders': 0, 'active_orders': 7, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:30,559 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_53aaab70', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 360.0}
2025-07-26 22:50:30,560 - order - INFO - [order.py:245] - Created order order_53aaab70 with 1 products
2025-07-26 22:50:30,560 - order - INFO - [order.py:339] - Assigned 1 products from order order_53aaab70 to line3
2025-07-26 22:50:30,560 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_53aaab70 with 1 products to line3
2025-07-26 22:50:30,560 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.47, 'first_pass_rate': 0.0, 'total_production_cost': 13.58, 'material_costs': 10.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.75, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:31,161 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
Although there is a high-priority event (raw materials available), both AGVs are currently in a "MOVING" state and not ready to receive new commands. You can only send a command to an AGV when it is both AVAILABLE and idle (not moving). Wait until either AGV_1 or AGV_2 arrives at its destination and becomes idle before issuing the next command (likely a LOAD command for a specific product from P0).'
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 421
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
Although there is a high-priority event (raw materials available), both AGVs are currently in a "MOVING" state and not ready to receive new commands. You can only send a command to...'
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:50:31,165 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:50:31,166 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:50:31,166 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 14, Finished products: 0
2025-07-26 22:50:31,166 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.MOVING at P10, battery 50.0%
2025-07-26 22:50:31,166 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.MOVING at P10, battery 50.0%
2025-07-26 22:50:31,166 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:50:31,166 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:50:31,166 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:31,354 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:31,562 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4c346b00', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 520.0}
2025-07-26 22:50:31,562 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.47, 'first_pass_rate': 0.0, 'total_production_cost': 13.58, 'material_costs': 10.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.75, 'total_orders': 7, 'completed_orders': 0, 'active_orders': 7, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:31,562 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_53aaab70', 'created_at': 40.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 360.0}
2025-07-26 22:50:31,563 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 40.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 4.47, 'first_pass_rate': 0.0, 'total_production_cost': 13.58, 'material_costs': 10.0, 'energy_costs': 3.58, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.75, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:31,602 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3']
2025-07-26 22:50:31,877 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 41.0, 'command_id': 'flow_20.0_agv1_load_rawmat_prod_1_495dbb33', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_495dbb33Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%'}
2025-07-26 22:50:31,878 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv1_load_rawmat_prod_1_495dbb33 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_495dbb33Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%
2025-07-26 22:50:32,928 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv1_load_rawmat_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}}
]

Explanation:
AGV_1 is currently idle at P0 (RawMaterial warehouse) with no payload, making it ready to handle the highest-priority action: supplying raw materials. The next product to be loaded is "prod_1_495dbb33", so the command instructs AGV_1 to load this specific product. AGV_2 is currently moving and cannot receive a new command at this time. This approach ensures the production line receives its raw material input with no delay, in alignment with the decision logic and event priority.'
2025-07-26 22:50:32,928 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:32,928 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 638
2025-07-26 22:50:32,929 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv1_load_rawmat_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}}
]

Explanation:
AGV_1 is currently idle at P0 (RawMaterial wa...'
2025-07-26 22:50:32,929 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:32,929 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv1_load_rawmat_prod_1_495dbb33","action":"load","target":"AGV_1","params":{"product_id":"prod_1_495dbb33"}}
]'
2025-07-26 22:50:32,929 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:32,929 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:32,929 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:32,929 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv1_load_rawmat_prod_1_495dbb33', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_495dbb33'}, 'timestamp': 1753541432.929376}
2025-07-26 22:50:32,929 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv1_load_rawmat_prod_1_495dbb33 - load for AGV_1
2025-07-26 22:50:33,031 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:50:33,031 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:50:33,031 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3']
2025-07-26 22:50:33,040 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 43.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.55, 'first_pass_rate': 0.0, 'total_production_cost': 15.37, 'material_costs': 10.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 30.55, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:33,040 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 43.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 5.55, 'first_pass_rate': 0.0, 'total_production_cost': 15.37, 'material_costs': 10.0, 'energy_costs': 5.37, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 30.55, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:33,154 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 43.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.41, 'first_pass_rate': 0.0, 'total_production_cost': 17.16, 'material_costs': 10.0, 'energy_costs': 7.16, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.73, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:33,165 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 43.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 7.41, 'first_pass_rate': 0.0, 'total_production_cost': 17.16, 'material_costs': 10.0, 'energy_costs': 7.16, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.73, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:33,166 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 43.949999, 'command_id': 'flow_20.0_agv2_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 40.6%'}
2025-07-26 22:50:33,166 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv2_move_p0 response: Successfully arrived at path point P0, remaining battery: 40.6%
2025-07-26 22:50:33,166 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 43.949999, 'command_id': 'flow_20.0_agv2_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 31.1%'}
2025-07-26 22:50:33,166 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv2_move_p0 response: Successfully arrived at path point P0, remaining battery: 31.1%
2025-07-26 22:50:33,972 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 44.0, 'command_id': 'flow_20.0_agv1_load_rawmat_prod_1_495dbb33', 'response': 'Product with id prod_1_495dbb33 not found in warehouse buffer.'}
2025-07-26 22:50:33,973 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv1_load_rawmat_prod_1_495dbb33 response: Product with id prod_1_495dbb33 not found in warehouse buffer.
2025-07-26 22:50:34,785 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:35,022 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 45.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.12, 'first_pass_rate': 0.0, 'total_production_cost': 18.95, 'material_costs': 10.0, 'energy_costs': 8.95, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.46, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:35,022 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 45.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.12, 'first_pass_rate': 0.0, 'total_production_cost': 18.95, 'material_costs': 10.0, 'energy_costs': 8.95, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.46, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:35,022 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 45.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.99, 'first_pass_rate': 0.0, 'total_production_cost': 20.74, 'material_costs': 10.0, 'energy_costs': 10.74, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 29.22, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:35,385 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 45.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 8.99, 'first_pass_rate': 0.0, 'total_production_cost': 20.74, 'material_costs': 10.0, 'energy_costs': 10.74, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 29.22, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:35,385 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 45.949999, 'command_id': 'flow_30_agv1_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 22:50:35,385 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 22:50:35,386 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 45.949999, 'command_id': 'flow_30_agv2_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 47.7%'}
2025-07-26 22:50:35,386 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 47.7%
2025-07-26 22:50:35,632 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv1_move_p1_with_prod_1_495dbb33","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is idle at P0 and already loaded with raw material (prod_1_495dbb33). The next required action according to the workflow is to transport that raw material to StationA (P1). Thus, AGV_1 is commanded to move to P1 for the delivery.  
AGV_2 is currently moving and not available for a new command, so only AGV_1 receives a command at this time. Once AGV_2 becomes available, it can handle the next raw material or additional actions as required.'
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 593
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv1_move_p1_with_prod_1_495dbb33","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is idle at P0 and already loaded with raw materia...'
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv1_move_p1_with_prod_1_495dbb33","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]'
2025-07-26 22:50:35,887 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:35,887 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:35,887 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:35,888 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv1_move_p1_with_prod_1_495dbb33', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541435.887897}
2025-07-26 22:50:35,888 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv1_move_p1_with_prod_1_495dbb33 - move for AGV_1
2025-07-26 22:50:36,375 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:36,426 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
Both AGVs (AGV_1 and AGV_2) are in a "MOVING" state, which means they are not idle or ready to accept new commands. According to the critical rule, AGVs must be available and not currently executing any command (including movement) before issuing further instructions. Wait until at least one AGV arrives at its destination and becomes idle before proceeding to the next required action, such as loading raw materials for the new order. No new commands are issued at this moment.'
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 499
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs (AGV_1 and AGV_2) are in a "MOVING" state, which means they are not idle or ready to accept new commands. According to the critical rule, AGVs must be available and not c...'
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 13, Finished products: 0
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P0, battery 47.7100002%
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P0, battery 47.7100002%
2025-07-26 22:50:36,596 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:36,596 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:36,672 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:36,932 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 47.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.05, 'first_pass_rate': 0.0, 'total_production_cost': 22.53, 'material_costs': 10.0, 'energy_costs': 12.53, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.66, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:36,932 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 47.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.05, 'first_pass_rate': 0.0, 'total_production_cost': 22.53, 'material_costs': 10.0, 'energy_costs': 12.53, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 32.66, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:37,057 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:37,137 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_20.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
Two actions are needed, but only AGV_1 is ready for a command (AGV_2 is still moving and cannot be assigned a new command right now). AGV_1 is idle at P0 and carrying a payload ("prod_1_495dbb33") that needs to be delivered to StationA (P1) according to the raw material flow. The correct next action is to send a move command for AGV_1 to P1. After arriving at P1, an unload command will be needed, but per the rules, only one command can be assigned now per AGV. AGV_2 will be handled when it becomes available for new actions.'
2025-07-26 22:50:37,137 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:37,137 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 653
2025-07-26 22:50:37,137 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_20.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
Two actions are needed, but only AGV_1 is ready for a command (AGV_2 is stil...'
2025-07-26 22:50:37,137 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:37,137 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_20.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]'
2025-07-26 22:50:37,138 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:50:37,138 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:50:37,138 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:50:37,138 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_20.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541437.138136}
2025-07-26 22:50:37,138 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_20.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:50:37,240 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:37,240 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:37,240 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3']
2025-07-26 22:50:37,384 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:37,814 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 47.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.49, 'first_pass_rate': 0.0, 'total_production_cost': 24.32, 'material_costs': 10.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.33, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:37,833 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:38,169 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 47.95, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.49, 'first_pass_rate': 0.0, 'total_production_cost': 24.32, 'material_costs': 10.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.33, 'total_orders': 8, 'completed_orders': 0, 'active_orders': 8, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:38,692 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 47.949999, 'command_id': 'flow_30_agv1_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 45.4%'}
2025-07-26 22:50:38,692 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 45.4%
2025-07-26 22:50:38,692 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 47.949999, 'command_id': 'flow_30_agv2_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 45.4%'}
2025-07-26 22:50:38,692 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 45.4%
2025-07-26 22:50:39,878 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:39,884 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","target":"AGV_2","params":{"product_id":"prod_1_fa0a15ba"}}
]

Explanation:  
Both AGV_1 and AGV_2 are now idle and present at the raw material warehouse (P0), ready to load raw materials. The system must prioritize starting new production using the specific product IDs available for the next actions: AGV_1 will load the P3 product (`prod_3_4d122871`) and AGV_2 will load the P1 product (`prod_1_fa0a15ba`). This approach maximizes parallel throughput and aligns with both order and production priorities.'
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 706
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","...'
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","target":"AGV_2","params":{"product_id":"prod_1_fa0a15ba"}}
]'
2025-07-26 22:50:40,005 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:40,005 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:40,005 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:40,006 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_3_4d122871', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_3_4d122871'}, 'timestamp': 1753541440.005927}
2025-07-26 22:50:40,006 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_3_4d122871 - load for AGV_1
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","target":"AGV_2","params":{"product_id":"prod_1_fa0a15ba"}}
]

Explanation:  
Both AGVs are now idle and available at P0 (RawMaterial warehouse) with no payload. The highest-priority action is to start production by loading raw materials. According to the buffer order, AGV_1 will load prod_3_4d122871 (P3 product for double pass), and AGV_2 will load prod_1_fa0a15ba (P1 product for single pass). This efficiently begins the production process for both product types based on the current demand and buffer availability, following the critical rule of specifying the exact product_id when loading from P0.'
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 804
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","...'
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","target":"AGV_2","params":{"product_id":"prod_1_fa0a15ba"}}
]'
2025-07-26 22:50:40,017 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:40,017 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:40,017 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:40,017 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_3_4d122871', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_3_4d122871'}, 'timestamp': 1753541440.017661}
2025-07-26 22:50:40,017 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_3_4d122871 - load for AGV_1
2025-07-26 22:50:40,069 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8fdaa9d5', 'created_at': 50.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 950.0}
2025-07-26 22:50:40,069 - order - INFO - [order.py:245] - Created order order_8fdaa9d5 with 2 products
2025-07-26 22:50:40,069 - order - INFO - [order.py:339] - Assigned 2 products from order order_8fdaa9d5 to line1
2025-07-26 22:50:40,069 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_8fdaa9d5 with 2 products to line1
2025-07-26 22:50:40,070 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.02, 'first_pass_rate': 0.0, 'total_production_cost': 24.32, 'material_costs': 10.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.8, 'total_orders': 9, 'completed_orders': 0, 'active_orders': 9, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:40,070 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3c050798', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 530.0}
2025-07-26 22:50:40,070 - order - INFO - [order.py:245] - Created order order_3c050798 with 1 products
2025-07-26 22:50:40,070 - order - INFO - [order.py:339] - Assigned 1 products from order order_3c050798 to line2
2025-07-26 22:50:40,070 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_3c050798 with 1 products to line2
2025-07-26 22:50:40,070 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.02, 'first_pass_rate': 0.0, 'total_production_cost': 24.32, 'material_costs': 10.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.8, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:40,107 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_1_fa0a15ba', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_fa0a15ba'}, 'timestamp': 1753541440.107477}
2025-07-26 22:50:40,108 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_1_fa0a15ba - load for AGV_2
2025-07-26 22:50:40,119 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_1_fa0a15ba', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_fa0a15ba'}, 'timestamp': 1753541440.118966}
2025-07-26 22:50:40,119 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_1_fa0a15ba - load for AGV_2
2025-07-26 22:50:40,220 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:40,221 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:40,221 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:40,896 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:41,015 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30.0_agv2_load_rawmat_prod_2_de59ee53","action":"load","target":"AGV_2","params":{"product_id":"prod_2_de59ee53"}}
]

Explanation:
- AGV_1 is at P0, loaded with "prod_1_495dbb33", and idle. According to the workflow, its next step is to deliver to StationA (P1). The command directs AGV_1 to move to P1 for unloading.
- AGV_2 is now available at P0, idle, and empty. It can start loading the next raw material. The product at the front of the queue is "prod_2_de59ee53", so AGV_2 is commanded to load it.

Both AGVs are available and can advance the processing of raw material orders simultaneously, maximizing throughput as per the line's high-priority logic.'
2025-07-26 22:50:41,015 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:41,015 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 791
2025-07-26 22:50:41,016 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30.0_agv2_load_rawmat_prod_2_de59ee53","action":"load","target":"AGV_...'
2025-07-26 22:50:41,016 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:41,016 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30.0_agv2_load_rawmat_prod_2_de59ee53","action":"load","target":"AGV_2","params":{"product_id":"prod_2_de59ee53"}}
]'
2025-07-26 22:50:41,016 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:41,016 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:50:41,016 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:50:41,016 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541441.016336}
2025-07-26 22:50:41,016 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:50:41,117 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_load_rawmat_prod_2_de59ee53', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_de59ee53'}, 'timestamp': 1753541441.117078}
2025-07-26 22:50:41,118 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_load_rawmat_prod_2_de59ee53 - load for AGV_2
2025-07-26 22:50:41,219 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:41,219 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:41,219 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3']
2025-07-26 22:50:41,529 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 51.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.8, 'first_pass_rate': 0.0, 'total_production_cost': 44.32, 'material_costs': 30.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.1, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:41,530 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8fdaa9d5', 'created_at': 50.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 950.0}
2025-07-26 22:50:41,530 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.02, 'first_pass_rate': 0.0, 'total_production_cost': 24.32, 'material_costs': 10.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.8, 'total_orders': 9, 'completed_orders': 0, 'active_orders': 9, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:41,637 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3c050798', 'created_at': 50.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 530.0}
2025-07-26 22:50:41,638 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 50.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.02, 'first_pass_rate': 0.0, 'total_production_cost': 24.32, 'material_costs': 10.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.8, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:41,969 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 51.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.8, 'first_pass_rate': 0.0, 'total_production_cost': 54.32, 'material_costs': 40.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.1, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:41,970 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 51.0, 'command_id': 'flow_30_agv1_load_prod_3_4d122871', 'response': 'Product with id prod_3_4d122871 not found in warehouse buffer.'}
2025-07-26 22:50:41,970 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_3_4d122871 response: Product with id prod_3_4d122871 not found in warehouse buffer.
2025-07-26 22:50:41,971 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 51.0, 'command_id': 'flow_30_agv2_load_prod_1_fa0a15ba', 'response': 'Product with id prod_1_fa0a15ba not found in warehouse buffer.'}
2025-07-26 22:50:41,971 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_1_fa0a15ba response: Product with id prod_1_fa0a15ba not found in warehouse buffer.
2025-07-26 22:50:41,971 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 52.0, 'command_id': 'flow_30_agv1_load_prod_3_4d122871', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_4d122871Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%'}
2025-07-26 22:50:41,971 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_3_4d122871 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_4d122871Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%
2025-07-26 22:50:42,121 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 52.0, 'command_id': 'flow_30_agv2_load_prod_1_fa0a15ba', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_fa0a15baÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%'}
2025-07-26 22:50:42,122 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_1_fa0a15ba response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_fa0a15baÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.9%
2025-07-26 22:50:43,146 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 51.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.8, 'first_pass_rate': 0.0, 'total_production_cost': 44.32, 'material_costs': 30.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.1, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:43,148 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 51.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.8, 'first_pass_rate': 0.0, 'total_production_cost': 54.32, 'material_costs': 40.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.1, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:43,532 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 53.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.39, 'first_pass_rate': 0.0, 'total_production_cost': 69.32, 'material_costs': 55.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 33.77, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:43,648 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 53.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.39, 'first_pass_rate': 0.0, 'total_production_cost': 69.32, 'material_costs': 55.0, 'energy_costs': 14.32, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 33.77, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:43,990 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3']
2025-07-26 22:50:44,061 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:44,465 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:44,808 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:45,090 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","target":"AGV_2","params":{"product_id":"prod_1_fa0a15ba"}}
]

Explanation:  
Both AGVs are idle at P0 (RawMaterial warehouse), ready for loading operations. The buffer and order priorities dictate that AGV_1 should load the P3 material (prod_3_4d122871), and AGV_2 should load the next P1 material (prod_1_fa0a15ba). This continues the optimized, parallel loading for simultaneous production initiation, as prioritized by the high-severity raw materials event and station requirements. Product IDs are explicitly included as required.'
2025-07-26 22:50:45,091 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:45,091 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 734
2025-07-26 22:50:45,091 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","...'
2025-07-26 22:50:45,091 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:45,091 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_3_4d122871","action":"load","target":"AGV_1","params":{"product_id":"prod_3_4d122871"}},
  {"command_id":"flow_30_agv2_load_prod_1_fa0a15ba","action":"load","target":"AGV_2","params":{"product_id":"prod_1_fa0a15ba"}}
]'
2025-07-26 22:50:45,091 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:45,091 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:45,091 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:45,092 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_3_4d122871', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_3_4d122871'}, 'timestamp': 1753541445.091786}
2025-07-26 22:50:45,092 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_3_4d122871 - load for AGV_1
2025-07-26 22:50:45,162 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 54.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.86, 'first_pass_rate': 0.0, 'total_production_cost': 70.5, 'material_costs': 55.0, 'energy_costs': 15.5, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.29, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:45,193 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_1_fa0a15ba', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_fa0a15ba'}, 'timestamp': 1753541445.193317}
2025-07-26 22:50:45,194 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_1_fa0a15ba - load for AGV_2
2025-07-26 22:50:45,295 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:45,295 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:45,295 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:45,509 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 54.0, 'command_id': 'flow_30.0_agv2_load_rawmat_prod_2_de59ee53', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_de59ee53Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 30.6%'}
2025-07-26 22:50:45,509 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_load_rawmat_prod_2_de59ee53 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_de59ee53Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 30.6%
2025-07-26 22:50:45,509 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 54.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.86, 'first_pass_rate': 0.0, 'total_production_cost': 70.5, 'material_costs': 55.0, 'energy_costs': 15.5, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.29, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:47,191 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 54.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.69, 'first_pass_rate': 0.0, 'total_production_cost': 71.69, 'material_costs': 55.0, 'energy_costs': 16.69, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.98, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:47,605 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 54.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.69, 'first_pass_rate': 0.0, 'total_production_cost': 71.69, 'material_costs': 55.0, 'energy_costs': 16.69, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.98, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:47,606 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 54.91666651, 'command_id': 'flow_20.0_agv1_move_p1_with_prod_1_495dbb33', 'response': 'Successfully arrived at path point P1, remaining battery: 43.2%'}
2025-07-26 22:50:47,606 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv1_move_p1_with_prod_1_495dbb33 response: Successfully arrived at path point P1, remaining battery: 43.2%
2025-07-26 22:50:47,606 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 54.91666651, 'command_id': 'flow_20.0_agv1_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 41.6%'}
2025-07-26 22:50:47,606 - src.line_commander - INFO - [line_commander.py:278] - Command flow_20.0_agv1_move_p1 response: Successfully arrived at path point P1, remaining battery: 41.6%
2025-07-26 22:50:47,971 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
Although there are two actions needed, only AGV_1 is available, and it is currently in a MOVING state (traveling from P0 to P1 as per the previous command and flow state). Commands can only be sent when the AGV is idle at its destination or ready for the next action. AGV_2 is busy and thus not available for any new instruction. Therefore, no new command is issued at this step. The next commands will be generated once either AGV completes its current task and becomes available.'
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 501
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
Although there are two actions needed, only AGV_1 is available, and it is currently in a MOVING state (traveling from P0 to P1 as per the previous command and flow state). Commands...'
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 15, Finished products: 0
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P1, battery 43.236667098000005%
2025-07-26 22:50:47,973 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P0, battery 30.600002000000003%
2025-07-26 22:50:48,130 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 58.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.67, 'first_pass_rate': 0.0, 'total_production_cost': 72.87, 'material_costs': 55.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.91, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:48,131 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 58.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.67, 'first_pass_rate': 0.0, 'total_production_cost': 72.87, 'material_costs': 55.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.91, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:48,133 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:48,210 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:48,242 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 58.91666651, 'command_id': 'flow_30.0_agv1_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 39.9%'}
2025-07-26 22:50:48,242 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_move_p1 response: Successfully arrived at path point P1, remaining battery: 39.9%
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","target":"AGV_2","params":{"product_id":"prod_1_bc72e76c"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle and positioned at P0 (RawMaterial warehouse) with no payload. The current priority is to continue processing available raw materials. AGV_1 will load the next P3 product (prod_3_63af60ae) to ensure P3 double-pass workflow can begin, and AGV_2 will load the next P1 product (prod_1_bc72e76c) to keep single-pass orders flowing. This solution maximizes production throughput and maintains a steady process for both product types, using the highest priorities and specifying the exact product_id for each AGV as required.'
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 825
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","...'
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","target":"AGV_2","params":{"product_id":"prod_1_bc72e76c"}}
]'
2025-07-26 22:50:48,659 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:48,660 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:48,660 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:48,660 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_3_63af60ae', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_3_63af60ae'}, 'timestamp': 1753541448.660125}
2025-07-26 22:50:48,660 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_3_63af60ae - load for AGV_1
2025-07-26 22:50:48,762 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_1_bc72e76c', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_bc72e76c'}, 'timestamp': 1753541448.761753}
2025-07-26 22:50:48,762 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_1_bc72e76c - load for AGV_2
2025-07-26 22:50:48,864 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:50:48,864 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:50:48,865 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1']
2025-07-26 22:50:49,992 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 92.87, 'material_costs': 75.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:50,228 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:50,229 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_825cf7c9', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 380.0}
2025-07-26 22:50:50,229 - order - INFO - [order.py:245] - Created order order_825cf7c9 with 1 products
2025-07-26 22:50:50,229 - order - INFO - [order.py:339] - Assigned 1 products from order order_825cf7c9 to line3
2025-07-26 22:50:50,229 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_825cf7c9 with 1 products to line3
2025-07-26 22:50:50,229 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 11, 'completed_orders': 0, 'active_orders': 11, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:50,229 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_977302fc', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1020.0}
2025-07-26 22:50:50,229 - order - INFO - [order.py:245] - Created order order_977302fc with 2 products
2025-07-26 22:50:50,230 - order - INFO - [order.py:339] - Assigned 2 products from order order_977302fc to line1
2025-07-26 22:50:50,230 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_977302fc with 2 products to line1
2025-07-26 22:50:50,230 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:50,464 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:50,752 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30.0_agv2_load_rawmat_prod_2_de59ee53","action":"load","target":"AGV_2","params":{"product_id":"prod_2_de59ee53"}}
]

Explanation:
AGV_1 is at P0, is idle, and is carrying "prod_1_495dbb33" raw material. Following the workflow, it must transport this material to StationA (P1). The first command sends AGV_1 to P1.
AGV_2 is also idle and available at P0 with no payload, so it can load the next available raw material. The next item in the raw material buffer is "prod_2_de59ee53"; thus, AGV_2 is instructed to load this product. 

This parallel execution maximizes responsiveness to the high-priority raw material availability event, efficiently progressing two new production starts at once.'
2025-07-26 22:50:50,752 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:50,752 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 824
2025-07-26 22:50:50,752 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30.0_agv2_load_rawmat_prod_2_de59ee53","action":"load","target":"AGV_...'
2025-07-26 22:50:50,752 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:50,753 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30.0_agv2_load_rawmat_prod_2_de59ee53","action":"load","target":"AGV_2","params":{"product_id":"prod_2_de59ee53"}}
]'
2025-07-26 22:50:50,753 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:50,753 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:50:50,753 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:50:50,753 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541450.75322}
2025-07-26 22:50:50,753 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:50:50,854 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_load_rawmat_prod_2_de59ee53', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_2_de59ee53'}, 'timestamp': 1753541450.85455}
2025-07-26 22:50:50,854 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_load_rawmat_prod_2_de59ee53 - load for AGV_2
2025-07-26 22:50:50,956 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:50,956 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:50,956 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:50:51,800 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:52,848 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:52,849 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 61.0, 'command_id': 'flow_30.0_agv1_move_p1', 'response': 'Can not find path from P1 to P1'}
2025-07-26 22:50:52,850 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_move_p1 response: Can not find path from P1 to P1
2025-07-26 22:50:52,854 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","target":"AGV_2","params":{"product_id":"prod_1_bc72e76c"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at the raw material warehouse (P0) and ready to load materials. The next available raw materials are prod_3_63af60ae (P3 product) and prod_1_bc72e76c (P1 product). Assigning one raw material to each AGV enables parallel loading and keeps production flow moving efficiently. Product IDs are specified correctly as required for the load action at P0.'
2025-07-26 22:50:52,854 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:52,854 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 655
2025-07-26 22:50:52,854 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","...'
2025-07-26 22:50:52,854 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:52,854 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","target":"AGV_2","params":{"product_id":"prod_1_bc72e76c"}}
]'
2025-07-26 22:50:52,855 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:52,855 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:52,855 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:52,856 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_3_63af60ae', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_3_63af60ae'}, 'timestamp': 1753541452.855816}
2025-07-26 22:50:52,856 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_3_63af60ae - load for AGV_1
2025-07-26 22:50:52,939 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 92.87, 'material_costs': 75.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:52,940 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 10, 'completed_orders': 0, 'active_orders': 10, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:52,957 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_1_bc72e76c', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_bc72e76c'}, 'timestamp': 1753541452.957413}
2025-07-26 22:50:52,957 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_1_bc72e76c - load for AGV_2
2025-07-26 22:50:53,141 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:53,151 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_825cf7c9', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 380.0}
2025-07-26 22:50:53,151 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 11, 'completed_orders': 0, 'active_orders': 11, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:53,152 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_977302fc', 'created_at': 60.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1020.0}
2025-07-26 22:50:53,152 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 60.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.46, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.23, 'total_orders': 12, 'completed_orders': 0, 'active_orders': 12, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:50:53,152 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 60.0, 'command_id': 'flow_30_agv1_load_prod_3_4d122871', 'response': 'Product with id prod_3_4d122871 not found in warehouse buffer.'}
2025-07-26 22:50:53,152 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_3_4d122871 response: Product with id prod_3_4d122871 not found in warehouse buffer.
2025-07-26 22:50:53,152 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 60.0, 'command_id': 'flow_30_agv2_load_prod_1_fa0a15ba', 'response': 'Product with id prod_1_fa0a15ba not found in warehouse buffer.'}
2025-07-26 22:50:53,153 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_1_fa0a15ba response: Product with id prod_1_fa0a15ba not found in warehouse buffer.
2025-07-26 22:50:53,722 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:54,622 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:50:55,627 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 61.0, 'command_id': 'flow_30_agv1_load_prod_3_63af60ae', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_63af60aeÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%'}
2025-07-26 22:50:55,627 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_3_63af60ae response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_63af60aeÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%
2025-07-26 22:50:55,628 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 61.0, 'command_id': 'flow_30_agv2_load_prod_1_bc72e76c', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_bc72e76cÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%'}
2025-07-26 22:50:55,628 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_1_bc72e76c response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_bc72e76cÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 44.4%
2025-07-26 22:50:55,974 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:50:56,518 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 66.0, 'command_id': 'flow_30_agv1_load_prod_3_63af60ae', 'response': 'Can not load. AGV AGV_1 is not available or payload is full.'}
2025-07-26 22:50:56,518 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_3_63af60ae response: Can not load. AGV AGV_1 is not available or payload is full.
2025-07-26 22:50:56,622 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 66.0, 'command_id': 'flow_30.0_agv2_load_rawmat_prod_2_de59ee53', 'response': 'Product with id prod_2_de59ee53 not found in warehouse buffer.'}
2025-07-26 22:50:56,622 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_load_rawmat_prod_2_de59ee53 response: Product with id prod_2_de59ee53 not found in warehouse buffer.
2025-07-26 22:50:56,622 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 66.0, 'command_id': 'flow_30_agv2_load_prod_1_bc72e76c', 'response': 'Can not load. AGV AGV_2 is not available or payload is full.'}
2025-07-26 22:50:56,622 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_1_bc72e76c response: Can not load. AGV AGV_2 is not available or payload is full.
2025-07-26 22:50:57,384 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:
- AGV_1 is idle at P1 (StationA) with a payload ("prod_1_495dbb33") and should promptly unload its cargo to continue the production flow. The command for AGV_1 is to unload at P1.
- AGV_2 is idle at P0 with a raw material payload ("prod_2_de59ee53"). The next required step for AGV_2 is to move its raw material to StationA (P1) for delivery, so AGV_2 is commanded to move to P1.

Both AGVs will continue the high-priority raw material delivery for new production, making the process efficient and workflow-compliant. Only one command per AGV is issued, in accordance with the rules.'
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 799
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
...'
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:50:58,099 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:58,099 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:50:58,099 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:50:58,100 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541458.100252}
2025-07-26 22:50:58,100 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:50:58,202 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_move_p1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541458.202026}
2025-07-26 22:50:58,203 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_move_p1 - move for AGV_2
2025-07-26 22:50:58,303 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:50:58,304 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:50:58,304 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:50:58,901 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","target":"AGV_2","params":{"product_id":"prod_1_bc72e76c"}}
]

Explanation:  
This high-severity event (new order) with both AGVs idle at P0 means the line can immediately act on order fulfillment. The next available raw materials that match the order and buffer sequence are selected. AGV_1 is sent to load prod_3_63af60ae (P3 double-pass), supporting both the order and P3 priority, and AGV_2 is assigned to load prod_1_bc72e76c (P1 single-pass). This ensures the fastest start for meeting new order demand by aligning AGV loading with raw material and order priorities. All commands use explicit product IDs, as required by the rules.'
2025-07-26 22:50:58,901 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:58,901 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 836
2025-07-26 22:50:58,901 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","...'
2025-07-26 22:50:58,901 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:58,902 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_load_prod_3_63af60ae","action":"load","target":"AGV_1","params":{"product_id":"prod_3_63af60ae"}},
  {"command_id":"flow_30_agv2_load_prod_1_bc72e76c","action":"load","target":"AGV_2","params":{"product_id":"prod_1_bc72e76c"}}
]'
2025-07-26 22:50:58,902 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:58,902 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:50:58,902 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:50:58,902 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_load_prod_3_63af60ae', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_3_63af60ae'}, 'timestamp': 1753541458.902457}
2025-07-26 22:50:58,902 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_load_prod_3_63af60ae - load for AGV_1
2025-07-26 22:50:59,004 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_load_prod_1_bc72e76c', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_bc72e76c'}, 'timestamp': 1753541459.003897}
2025-07-26 22:50:59,004 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_load_prod_1_bc72e76c - load for AGV_2
2025-07-26 22:50:59,105 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:50:59,106 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:50:59,107 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1']
2025-07-26 22:50:59,813 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:50:59,817 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:
- AGV_1 is idle at P1, loaded with "prod_1_495dbb33". It must unload this raw material at StationA (P1), so the first command instructs AGV_1 to unload.
- AGV_2 is idle at P0 carrying "prod_2_de59ee53". According to the process flow, AGV_2 should move to P1 to deliver this raw material. The second command sends AGV_2 to P1 for delivery.

Both actions progress the supply of raw materials in parallel, efficiently utilizing available AGV resources according to the high-priority production logic.'
2025-07-26 22:50:59,817 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:50:59,817 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 713
2025-07-26 22:50:59,817 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
...'
2025-07-26 22:50:59,817 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:50:59,818 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:50:59,818 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:50:59,818 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:50:59,818 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:50:59,818 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541459.818302}
2025-07-26 22:50:59,818 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:50:59,919 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_move_p1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541459.919258}
2025-07-26 22:50:59,919 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_move_p1 - move for AGV_2
2025-07-26 22:51:00,031 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 70.0, 'command_id': 'flow_30_agv1_load_prod_3_63af60ae', 'response': 'Can not load. AGV AGV_1 is not available or payload is full.'}
2025-07-26 22:51:00,031 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_load_prod_3_63af60ae response: Can not load. AGV AGV_1 is not available or payload is full.
2025-07-26 22:51:00,032 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 70.0, 'command_id': 'flow_30_agv2_load_prod_1_bc72e76c', 'response': 'Can not load. AGV AGV_2 is not available or payload is full.'}
2025-07-26 22:51:00,032 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_load_prod_1_bc72e76c response: Can not load. AGV AGV_2 is not available or payload is full.
2025-07-26 22:51:00,188 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_caba21c7', 'created_at': 70.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 550.0}
2025-07-26 22:51:00,188 - order - INFO - [order.py:245] - Created order order_caba21c7 with 1 products
2025-07-26 22:51:00,188 - order - INFO - [order.py:339] - Assigned 1 products from order order_caba21c7 to line2
2025-07-26 22:51:00,188 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_caba21c7 with 1 products to line2
2025-07-26 22:51:00,188 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.82, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.91, 'total_orders': 13, 'completed_orders': 0, 'active_orders': 13, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:00,302 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5d48ca8e', 'created_at': 70.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1150.0}
2025-07-26 22:51:00,303 - order - INFO - [order.py:245] - Created order order_5d48ca8e with 2 products
2025-07-26 22:51:00,303 - order - INFO - [order.py:339] - Assigned 2 products from order order_5d48ca8e to line3
2025-07-26 22:51:00,303 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_5d48ca8e with 2 products to line3
2025-07-26 22:51:00,303 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.82, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.91, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:00,965 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_caba21c7', 'created_at': 70.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 550.0}
2025-07-26 22:51:00,965 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.82, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.91, 'total_orders': 13, 'completed_orders': 0, 'active_orders': 13, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:00,966 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5d48ca8e', 'created_at': 70.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1150.0}
2025-07-26 22:51:00,966 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 70.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.82, 'first_pass_rate': 0.0, 'total_production_cost': 102.87, 'material_costs': 85.0, 'energy_costs': 17.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.91, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:00,966 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 70.0, 'command_id': 'flow_30.0_agv1_unload_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_1_495dbb33Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 39.4%'}
2025-07-26 22:51:00,966 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_unload_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_1_495dbb33Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 39.4%
2025-07-26 22:51:01,060 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:01,344 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:
- AGV_1 is idle at P1, loaded with "prod_1_495dbb33". The immediate required action is to unload this payload at StationA, so AGV_1 is assigned an unload command.
- AGV_2 is idle at P0, loaded with "prod_2_de59ee53". The next action for AGV_2 is to deliver its payload to StationA (P1) as part of the raw material flow, so AGV_2 receives a move command to P1.

These commands ensure raw material is provided in sequence to StationA, supporting efficient order fulfillment for high-priority new orders. One command is assigned per AGV as required by the flow constraints.'
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 786
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
...'
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_30.0_agv2_move_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:51:01,346 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:01,346 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:01,346 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:01,346 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541461.346583}
2025-07-26 22:51:01,346 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:51:01,448 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_move_p1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541461.447873}
2025-07-26 22:51:01,448 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_move_p1 - move for AGV_2
2025-07-26 22:51:01,549 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:01,549 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:01,549 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:51:01,761 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 71.0, 'command_id': 'flow_30.0_agv1_unload_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:01,762 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_unload_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:02,403 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_40_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:  
Both AGVs are idle at P0 (RawMaterial warehouse) and each is loaded with 2 raw materials. The next high-priority step is to deliver these materials to StationA (P1) so production can begin. According to the workflow, they must move to P1 before unloading their payload. This directly supports the critical flow rules: AGVs with payload have high priority, and station actions take precedence over new loading until the payload is delivered. Each AGV receives a single command to move to P1. No new load commands are issued, as both AGVs are already full.'
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 789
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_40_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_40_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:51:02,450 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:02,450 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:02,450 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:02,450 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv1_move_to_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541462.450723}
2025-07-26 22:51:02,450 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv1_move_to_p1 - move for AGV_1
2025-07-26 22:51:02,552 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv2_move_to_p1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541462.552599}
2025-07-26 22:51:02,552 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv2_move_to_p1 - move for AGV_2
2025-07-26 22:51:02,654 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:02,654 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:02,654 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:04,493 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 74.0, 'command_id': 'flow_30.0_agv1_unload_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:04,493 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_unload_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:04,494 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 74.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.11, 'first_pass_rate': 0.0, 'total_production_cost': 103.87, 'material_costs': 85.0, 'energy_costs': 18.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 30.19, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:04,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 74.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.57, 'first_pass_rate': 0.0, 'total_production_cost': 105.05, 'material_costs': 85.0, 'energy_costs': 20.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.79, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:04,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 74.91666651, 'command_id': 'flow_30.0_agv2_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 24.2%'}
2025-07-26 22:51:04,607 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_move_p1 response: Successfully arrived at path point P1, remaining battery: 24.2%
2025-07-26 22:51:04,633 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 74.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.11, 'first_pass_rate': 0.0, 'total_production_cost': 103.87, 'material_costs': 85.0, 'energy_costs': 18.87, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 30.19, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:04,633 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 74.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.57, 'first_pass_rate': 0.0, 'total_production_cost': 105.05, 'material_costs': 85.0, 'energy_costs': 20.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.79, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:05,150 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:05,763 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:06,082 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:06,287 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
AGV_1 is idle at P1 without a payload. According to the high-priority flow and since StationA is processing, AGV_1 should return to the RawMaterial warehouse (P0) to prepare for the next raw material pickup ("prod_2_ee0e250f" or as required by future actions). AGV_2, though listed as available, is currently moving and therefore cannot be assigned a new command at this time. Only AGV_1 receives an action now; AGV_2 will be ready for a command once it is idle at its destination. This keeps material flow seamless and ensures both AGVs are actively contributing to production as soon as possible.'
2025-07-26 22:51:06,288 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:06,288 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 722
2025-07-26 22:51:06,288 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
AGV_1 is idle at P1 without a payload. According to the high-priority flow a...'
2025-07-26 22:51:06,288 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:06,288 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]'
2025-07-26 22:51:06,288 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:06,288 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:06,288 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:06,289 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541466.288848}
2025-07-26 22:51:06,289 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_move_p0 - move for AGV_1
2025-07-26 22:51:06,391 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:06,391 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:06,392 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:51:06,700 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:06,794 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:06,798 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_40_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at P0 (RawMaterial warehouse) and already carrying raw materials (AGV_1: prod_3_4d122871, prod_3_63af60ae; AGV_2: prod_1_fa0a15ba, prod_1_bc72e76c). According to the critical rule, when AGVs are idle and have payloads, they should immediately proceed to deliver their payloads before any new loading or retrieval actions are initiated. The next step is to move both AGVs to StationA (P1), where they will later unload their raw materials to start the production process. This follows correct sequencing and ensures production flow is not blocked by idle payloads.'
2025-07-26 22:51:06,798 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:06,799 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 828
2025-07-26 22:51:06,799 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_40_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:51:06,799 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:06,799 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_40_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:51:06,799 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:06,799 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:06,799 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:06,800 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv1_move_to_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541466.799528}
2025-07-26 22:51:06,800 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv1_move_to_p1 - move for AGV_1
2025-07-26 22:51:06,902 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv2_move_to_p1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541466.901879}
2025-07-26 22:51:06,903 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv2_move_to_p1 - move for AGV_2
2025-07-26 22:51:07,003 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:51:07,003 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:51:07,003 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:07,357 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30_agv1_move_to_p1_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle and loaded with raw materials at P0 (AGV_1: P3 products, AGV_2: P1 products). Per decision logic, an idle AGV with payload should immediately deliver to the next step‚ÄîStationA (P1) for unloading. Each AGV receives a MOVE command to P1; once at P1, unload commands will be issued. This ensures raw materials reach the production process as quickly as possible, maximizing line throughput and minimizing idle time.'
2025-07-26 22:51:07,358 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:07,358 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 703
2025-07-26 22:51:07,358 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30_agv1_move_to_p1_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30_agv2_move_to_p1_with_payload","action":"move","targe...'
2025-07-26 22:51:07,358 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:07,358 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30_agv1_move_to_p1_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_30_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:51:07,358 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:07,358 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:07,358 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:07,358 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv1_move_to_p1_with_payload', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541467.358639}
2025-07-26 22:51:07,358 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv1_move_to_p1_with_payload - move for AGV_1
2025-07-26 22:51:07,460 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30_agv2_move_to_p1_with_payload', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541467.46023}
2025-07-26 22:51:07,461 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30_agv2_move_to_p1_with_payload - move for AGV_2
2025-07-26 22:51:08,022 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:51:09,216 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.6, 'first_pass_rate': 0.0, 'total_production_cost': 106.05, 'material_costs': 85.0, 'energy_costs': 21.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 30.11, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,216 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 9.6, 'first_pass_rate': 0.0, 'total_production_cost': 106.05, 'material_costs': 85.0, 'energy_costs': 21.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 30.11, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,216 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.04, 'first_pass_rate': 0.0, 'total_production_cost': 107.24, 'material_costs': 85.0, 'energy_costs': 22.24, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.65, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,353 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.04, 'first_pass_rate': 0.0, 'total_production_cost': 107.24, 'material_costs': 85.0, 'energy_costs': 22.24, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 31.65, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,354 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.57, 'first_pass_rate': 0.0, 'total_production_cost': 108.42, 'material_costs': 85.0, 'energy_costs': 23.42, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 33.5, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,471 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.09, 'first_pass_rate': 0.0, 'total_production_cost': 109.6, 'material_costs': 85.0, 'energy_costs': 24.6, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.35, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,472 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.62, 'first_pass_rate': 0.0, 'total_production_cost': 110.79, 'material_costs': 85.0, 'energy_costs': 25.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.21, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,473 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 79.91666651, 'command_id': 'flow_30.0_agv2_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 17.8%'}
2025-07-26 22:51:09,473 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_move_p1 response: Successfully arrived at path point P1, remaining battery: 17.8%
2025-07-26 22:51:09,473 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 79.91666651, 'command_id': 'flow_30.0_agv2_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 11.4%'}
2025-07-26 22:51:09,473 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_move_p1 response: Successfully arrived at path point P1, remaining battery: 11.4%
2025-07-26 22:51:09,622 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 10.57, 'first_pass_rate': 0.0, 'total_production_cost': 108.42, 'material_costs': 85.0, 'energy_costs': 23.42, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 33.5, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,623 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.09, 'first_pass_rate': 0.0, 'total_production_cost': 109.6, 'material_costs': 85.0, 'energy_costs': 24.6, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 35.35, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,623 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 79.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.62, 'first_pass_rate': 0.0, 'total_production_cost': 110.79, 'material_costs': 85.0, 'energy_costs': 25.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.21, 'total_orders': 14, 'completed_orders': 0, 'active_orders': 14, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:09,623 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 79.91666651, 'command_id': 'flow_40_agv1_move_to_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 42.7%'}
2025-07-26 22:51:09,623 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv1_move_to_p1 response: Successfully arrived at path point P1, remaining battery: 42.7%
2025-07-26 22:51:09,623 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 79.91666651, 'command_id': 'flow_40_agv2_move_to_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 42.7%'}
2025-07-26 22:51:09,624 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv2_move_to_p1 response: Successfully arrived at path point P1, remaining battery: 42.7%
2025-07-26 22:51:09,867 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
- AGV_1 is idle at P1 and has no load. To keep raw materials flowing, it should move to P0 (RawMaterial warehouse) to prepare for the next loading operation. The first command sends AGV_1 to P0.
- AGV_2 is idle at P1, but it is carrying "prod_2_de59ee53". According to the workflow, this payload must be unloaded at StationA (P1). The second command instructs AGV_2 to unload at P1.

Both AGVs receive a command, optimizing the raw material delivery and prepping both for the next steps in execution, consistent with the current production and event needs.'
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 772
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
...'
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:09,870 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:09,870 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:09,870 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:09,871 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541469.870977}
2025-07-26 22:51:09,871 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_move_p0 - move for AGV_1
2025-07-26 22:51:09,972 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_unload_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541469.972538}
2025-07-26 22:51:09,973 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_unload_p1 - unload for AGV_2
2025-07-26 22:51:10,074 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:10,074 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:10,074 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1']
2025-07-26 22:51:10,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5924fd77', 'created_at': 80.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 830.0}
2025-07-26 22:51:10,155 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5924fd77', 'created_at': 80.0, 'items': [{'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 830.0}
2025-07-26 22:51:10,155 - order - INFO - [order.py:245] - Created order order_5924fd77 with 1 products
2025-07-26 22:51:10,155 - order - INFO - [order.py:339] - Assigned 1 products from order order_5924fd77 to line1
2025-07-26 22:51:10,156 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_5924fd77 with 1 products to line1
2025-07-26 22:51:10,156 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.61, 'first_pass_rate': 0.0, 'total_production_cost': 110.79, 'material_costs': 85.0, 'energy_costs': 25.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.17, 'total_orders': 15, 'completed_orders': 0, 'active_orders': 15, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:10,263 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.61, 'first_pass_rate': 0.0, 'total_production_cost': 110.79, 'material_costs': 85.0, 'energy_costs': 25.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.17, 'total_orders': 15, 'completed_orders': 0, 'active_orders': 15, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:10,382 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:10,481 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5dd3fe90', 'created_at': 80.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1160.0}
2025-07-26 22:51:10,481 - order - INFO - [order.py:245] - Created order order_5dd3fe90 with 2 products
2025-07-26 22:51:10,481 - order - INFO - [order.py:339] - Assigned 2 products from order order_5dd3fe90 to line2
2025-07-26 22:51:10,482 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_5dd3fe90 with 2 products to line2
2025-07-26 22:51:10,482 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.61, 'first_pass_rate': 0.0, 'total_production_cost': 110.79, 'material_costs': 85.0, 'energy_costs': 25.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.17, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:10,792 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5dd3fe90', 'created_at': 80.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1160.0}
2025-07-26 22:51:10,792 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 80.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.61, 'first_pass_rate': 0.0, 'total_production_cost': 110.79, 'material_costs': 85.0, 'energy_costs': 25.79, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.17, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:11,333 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
Both AGVs are currently MOVING with loaded payloads and are not available to receive new commands. Per the critical rule, you can only issue one command per AGV and only when they are available (idle). You must wait until an AGV completes its current movement (likely to P1) and becomes idle before issuing further commands (such as UNLOAD at P1 or new loading tasks).'
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 388
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs are currently MOVING with loaded payloads and are not available to receive new commands. Per the critical rule, you can only issue one command per AGV and only when they ...'
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:51:11,334 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:51:11,335 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 19, Finished products: 0
2025-07-26 22:51:11,335 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P1, battery 42.736667098000005%
2025-07-26 22:51:11,335 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P1, battery 42.736667098000005%
2025-07-26 22:51:11,335 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:11,335 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:11,335 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:11,998 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
- AGV_1 is idle at P1 and empty. To maintain efficient raw material supply, it should return to the RawMaterial warehouse (P0) to pick up the next item ("prod_2_ee0e250f") as per the actions queue.
- AGV_2 is idle at P1 but still carrying "prod_2_de59ee53". The immediate required step is to unload this product at StationA (P1).

This sequence ensures continuous supply for production and efficient AGV utilization in line with the plant's process logic. Each AGV receives only one command as required.'
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 719
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
...'
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:12,000 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:12,000 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:12,000 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:12,000 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541472.000505}
2025-07-26 22:51:12,000 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_move_p0 - move for AGV_1
2025-07-26 22:51:12,102 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_unload_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541472.101882}
2025-07-26 22:51:12,102 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_unload_p1 - unload for AGV_2
2025-07-26 22:51:12,365 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 82.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.68, 'first_pass_rate': 0.0, 'total_production_cost': 111.97, 'material_costs': 85.0, 'energy_costs': 26.97, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.64, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:12,613 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 82.0, 'command_id': 'flow_30.0_agv2_unload_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_de59ee53Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 10.9%'}
2025-07-26 22:51:12,614 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_unload_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_de59ee53Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 10.9%
2025-07-26 22:51:12,614 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 82.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 11.68, 'first_pass_rate': 0.0, 'total_production_cost': 111.97, 'material_costs': 85.0, 'energy_costs': 26.97, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.64, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:12,614 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 82.91666651, 'command_id': 'flow_30.0_agv1_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 37.7%'}
2025-07-26 22:51:12,614 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_move_p0 response: Successfully arrived at path point P0, remaining battery: 37.7%
2025-07-26 22:51:13,093 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 83.0, 'command_id': 'flow_30.0_agv2_unload_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:13,093 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.06, 'first_pass_rate': 0.0, 'total_production_cost': 113.15, 'material_costs': 85.0, 'energy_costs': 28.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.96, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,093 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_unload_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:13,094 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 83.0, 'command_id': 'flow_30.0_agv1_move_p0', 'response': 'Can not find path from P0 to P0'}
2025-07-26 22:51:13,094 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_move_p0 response: Can not find path from P0 to P0
2025-07-26 22:51:13,094 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.06, 'first_pass_rate': 0.0, 'total_production_cost': 113.15, 'material_costs': 85.0, 'energy_costs': 28.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.96, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,295 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.56, 'first_pass_rate': 0.0, 'total_production_cost': 114.34, 'material_costs': 85.0, 'energy_costs': 29.34, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.72, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,296 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.07, 'first_pass_rate': 0.0, 'total_production_cost': 115.52, 'material_costs': 85.0, 'energy_costs': 30.52, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.48, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,819 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.56, 'first_pass_rate': 0.0, 'total_production_cost': 114.34, 'material_costs': 85.0, 'energy_costs': 29.34, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.72, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,819 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.07, 'first_pass_rate': 0.0, 'total_production_cost': 115.52, 'material_costs': 85.0, 'energy_costs': 30.52, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.48, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,820 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.57, 'first_pass_rate': 0.0, 'total_production_cost': 116.7, 'material_costs': 85.0, 'energy_costs': 31.7, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.25, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:13,820 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 83.91666651, 'command_id': 'flow_40_agv1_move_to_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 41.1%'}
2025-07-26 22:51:13,821 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv1_move_to_p1 response: Successfully arrived at path point P1, remaining battery: 41.1%
2025-07-26 22:51:13,853 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:14,344 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 83.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.57, 'first_pass_rate': 0.0, 'total_production_cost': 116.7, 'material_costs': 85.0, 'energy_costs': 31.7, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.25, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:14,345 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 83.91666651, 'command_id': 'flow_40_agv2_move_to_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 41.1%'}
2025-07-26 22:51:14,346 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv2_move_to_p1 response: Successfully arrived at path point P1, remaining battery: 41.1%
2025-07-26 22:51:14,346 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 83.91666651, 'command_id': 'flow_30_agv1_move_to_p1_with_payload', 'response': 'Successfully arrived at path point P1, remaining battery: 39.4%'}
2025-07-26 22:51:14,347 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 84.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.02, 'first_pass_rate': 0.0, 'total_production_cost': 117.7, 'material_costs': 85.0, 'energy_costs': 32.7, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.1, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:14,347 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv1_move_to_p1_with_payload response: Successfully arrived at path point P1, remaining battery: 39.4%
2025-07-26 22:51:14,347 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 83.91666651, 'command_id': 'flow_30_agv2_move_to_p1_with_payload', 'response': 'Successfully arrived at path point P1, remaining battery: 39.4%'}
2025-07-26 22:51:14,347 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30_agv2_move_to_p1_with_payload response: Successfully arrived at path point P1, remaining battery: 39.4%
2025-07-26 22:51:14,348 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 84.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.02, 'first_pass_rate': 0.0, 'total_production_cost': 117.7, 'material_costs': 85.0, 'energy_costs': 32.7, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.1, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:14,457 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:14,869 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:15,396 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
Only AGV_2 is currently idle and available for a command. It is at P1 (StationA), loaded with "prod_2_de59ee53", and needs to unload this raw material to advance the production flow. AGV_1, although available and scheduled to move, is currently in a MOVING state and cannot be assigned a new command until it becomes idle at its next location. Thus, only AGV_2 receives an unload command at P1 to keep the raw materials flowing and support the high-priority reactive event.'
2025-07-26 22:51:15,397 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:15,397 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 582
2025-07-26 22:51:15,397 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
Only AGV_2 is currently idle and available for a command. It is at P1 (StationA), loaded wi...'
2025-07-26 22:51:15,397 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:15,397 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:15,397 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:15,397 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:15,397 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:15,397 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_unload_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541475.397743}
2025-07-26 22:51:15,398 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_unload_p1 - unload for AGV_2
2025-07-26 22:51:15,499 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:51:15,499 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:51:15,499 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:15,563 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:16,801 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 86.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.21, 'first_pass_rate': 0.0, 'total_production_cost': 118.7, 'material_costs': 85.0, 'energy_costs': 33.7, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 43.12, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:16,802 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 86.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.43, 'first_pass_rate': 0.0, 'total_production_cost': 119.89, 'material_costs': 85.0, 'energy_costs': 34.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.42, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:16,965 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 86.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.21, 'first_pass_rate': 0.0, 'total_production_cost': 118.7, 'material_costs': 85.0, 'energy_costs': 33.7, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 43.12, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:17,593 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 86.92, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.43, 'first_pass_rate': 0.0, 'total_production_cost': 119.89, 'material_costs': 85.0, 'energy_costs': 34.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 44.42, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:17,593 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 86.91666651, 'command_id': 'flow_30.0_agv1_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 36.0%'}
2025-07-26 22:51:17,594 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_move_p0 response: Successfully arrived at path point P0, remaining battery: 36.0%
2025-07-26 22:51:18,539 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:18,623 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]

Explanation:
AGV_2's battery is at 10.85%, which is below the critical threshold of 20%. According to the decision logic, emergency charging takes absolute priority over all other tasks. Therefore, AGV_2 is immediately instructed to begin charging to a safe operational level (80%). AGV_1 is available at P0 and can be tasked with raw material movement in the next cycle, but only one command per AGV is allowed per request, and emergency charge for AGV_2 is the first priority.'
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 592
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]

Explanation:
AGV_2's battery is at 10.85%, which is below the critical threshold of 20...'
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]'
2025-07-26 22:51:18,629 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:18,629 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:18,629 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:18,630 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv2_charge_80', 'action': 'charge', 'target': 'AGV_2', 'params': {'target_level': 80}, 'timestamp': 1753541478.629918}
2025-07-26 22:51:18,630 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv2_charge_80 - charge for AGV_2
2025-07-26 22:51:18,732 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_available (severity: low)
2025-07-26 22:51:18,732 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_available (severity: low)
2025-07-26 22:51:18,733 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:19,177 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 89.0, 'command_id': 'flow_30.0_agv2_unload_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:19,178 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 89.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.53, 'first_pass_rate': 0.0, 'total_production_cost': 120.89, 'material_costs': 85.0, 'energy_costs': 35.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 43.23, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:19,178 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_unload_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:19,708 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:19,710 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40_agv1_unload_p1_materials","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1_materials","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 have completed their move and are now idle at P1 (StationA) with payloads of raw materials. According to the logic, the next priority for AGVs with payload at a station is to unload their materials to start production. Only one command per AGV is issued, so both AGVs receive an UNLOAD command at P1. This keeps the production line flowing by ensuring raw materials are transferred from AGV storage into the processing station for the next manufacturing steps.'
2025-07-26 22:51:19,710 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:19,710 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 700
2025-07-26 22:51:19,710 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40_agv1_unload_p1_materials","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1_materials","action":"unload","target":"AGV_2","params":{}}...'
2025-07-26 22:51:19,710 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:19,711 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40_agv1_unload_p1_materials","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1_materials","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:19,711 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:19,711 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:19,711 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:19,711 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv1_unload_p1_materials', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541479.711201}
2025-07-26 22:51:19,711 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv1_unload_p1_materials - unload for AGV_1
2025-07-26 22:51:19,714 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 89.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.53, 'first_pass_rate': 0.0, 'total_production_cost': 120.89, 'material_costs': 85.0, 'energy_costs': 35.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 43.23, 'total_orders': 16, 'completed_orders': 0, 'active_orders': 16, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 are now idle at StationA (P1) and still fully loaded with raw materials. The correct next action is to unload their cargo at P1 so that the raw materials can enter the production process. According to the decision rules, unloading comes immediately after arrival to the designated unloading point if AGV is carrying payload. Both AGVs receive an unload command, one for each, ensuring the fastest possible transition to production.'
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 651
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
B...'
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:19,780 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:19,780 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:19,781 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:19,781 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541479.781053}
2025-07-26 22:51:19,781 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:51:19,812 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv2_unload_p1_materials', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541479.812587}
2025-07-26 22:51:19,812 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv2_unload_p1_materials - unload for AGV_2
2025-07-26 22:51:19,882 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv2_unload_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541479.882464}
2025-07-26 22:51:19,883 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv2_unload_p1 - unload for AGV_2
2025-07-26 22:51:19,914 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:51:19,914 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:51:19,914 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:20,205 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:20,876 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_15e3baef', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 570.0}
2025-07-26 22:51:20,876 - order - INFO - [order.py:245] - Created order order_15e3baef with 1 products
2025-07-26 22:51:20,876 - order - INFO - [order.py:339] - Assigned 1 products from order order_15e3baef to line3
2025-07-26 22:51:20,876 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_15e3baef with 1 products to line3
2025-07-26 22:51:20,877 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.44, 'first_pass_rate': 0.0, 'total_production_cost': 120.89, 'material_costs': 85.0, 'energy_costs': 35.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.9, 'total_orders': 17, 'completed_orders': 0, 'active_orders': 17, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:20,877 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d9370805', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1800.0}
2025-07-26 22:51:20,877 - order - INFO - [order.py:245] - Created order order_d9370805 with 3 products
2025-07-26 22:51:20,877 - order - INFO - [order.py:339] - Assigned 3 products from order order_d9370805 to line1
2025-07-26 22:51:20,877 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_d9370805 with 3 products to line1
2025-07-26 22:51:20,990 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.44, 'first_pass_rate': 0.0, 'total_production_cost': 120.89, 'material_costs': 85.0, 'energy_costs': 35.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.9, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:21,269 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 91.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.57, 'first_pass_rate': 0.0, 'total_production_cost': 121.89, 'material_costs': 85.0, 'energy_costs': 36.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.33, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:21,463 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:21,876 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:23,779 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_33.95_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}},
  {"command_id":"flow_33.95_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]

Explanation:
- AGV_1 is idle and available at P0 (RawMaterial warehouse) with no load. The top priority after emergency charging is to keep raw materials flowing into production. The next available product in the buffer is "prod_2_ee0e250f", so AGV_1 is instructed to load it.
- AGV_2 is idle at P1 with a critically low battery (10.85%), well below the emergency threshold (20%). Emergency charging takes absolute priority, so AGV_2 is instructed to begin charging to at least 80%.

This approach ensures raw material flow is maintained and AGV_2 will be operational once its battery recovers, as per the plant‚Äôs critical prioritization rules.'
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 898
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_33.95_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}},
  {"command_id":"flow_33.95_agv2_charge_80","action":"charg...'
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_33.95_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}},
  {"command_id":"flow_33.95_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]'
2025-07-26 22:51:23,781 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:23,781 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:23,781 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:23,781 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_33.95_agv1_load_rawmat_prod_2_ee0e250f', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_ee0e250f'}, 'timestamp': 1753541483.781485}
2025-07-26 22:51:23,781 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_33.95_agv1_load_rawmat_prod_2_ee0e250f - load for AGV_1
2025-07-26 22:51:23,882 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_33.95_agv2_charge_80', 'action': 'charge', 'target': 'AGV_2', 'params': {'target_level': 80}, 'timestamp': 1753541483.882758}
2025-07-26 22:51:23,883 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_33.95_agv2_charge_80 - charge for AGV_2
2025-07-26 22:51:23,984 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:23,985 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:23,985 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:25,354 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_30.0_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}}
]

Explanation:
AGV_1 is idle, located at P0 (raw material warehouse), and has no load. The next high-priority action is to supply raw materials for ongoing production. The next product in the buffer is "prod_2_ee0e250f". AGV_2 is currently busy charging (battery < 20%) and cannot execute new commands. As a result, AGV_1 is tasked to load this specific raw material, keeping the production workflow moving efficiently.'
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 559
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_30.0_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}}
]

Explanation:
AGV_1 is idle, located at P0 (raw material wa...'
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_30.0_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}}
]'
2025-07-26 22:51:25,613 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:25,613 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:25,613 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:25,613 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_30.0_agv1_load_rawmat_prod_2_ee0e250f', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_ee0e250f'}, 'timestamp': 1753541485.613711}
2025-07-26 22:51:25,613 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_30.0_agv1_load_rawmat_prod_2_ee0e250f - load for AGV_1
2025-07-26 22:51:25,641 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 94.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.69, 'first_pass_rate': 0.0, 'total_production_cost': 122.89, 'material_costs': 85.0, 'energy_costs': 37.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.9, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:25,982 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 95.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.63, 'first_pass_rate': 0.0, 'total_production_cost': 137.89, 'material_costs': 100.0, 'energy_costs': 37.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.64, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:25,983 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 95.0, 'command_id': 'flow_33.95_agv2_charge_80', 'response': 'already charging'}
2025-07-26 22:51:25,983 - src.line_commander - INFO - [line_commander.py:278] - Command flow_33.95_agv2_charge_80 response: already charging
2025-07-26 22:51:25,983 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 95.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.19, 'first_pass_rate': 0.0, 'total_production_cost': 138.89, 'material_costs': 100.0, 'energy_costs': 38.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.6, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:26,581 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 96.0, 'command_id': 'flow_30.0_agv1_load_rawmat_prod_2_ee0e250f', 'response': 'Product with id prod_2_ee0e250f not found in warehouse buffer.'}
2025-07-26 22:51:26,581 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv1_load_rawmat_prod_2_ee0e250f response: Product with id prod_2_ee0e250f not found in warehouse buffer.
2025-07-26 22:51:26,581 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 96.0, 'command_id': 'flow_33.95_agv1_load_rawmat_prod_2_ee0e250f', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_ee0e250fÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 35.5%'}
2025-07-26 22:51:26,581 - src.line_commander - INFO - [line_commander.py:278] - Command flow_33.95_agv1_load_rawmat_prod_2_ee0e250f response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_ee0e250fÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 35.5%
2025-07-26 22:51:26,706 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 96.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.42, 'first_pass_rate': 0.0, 'total_production_cost': 139.89, 'material_costs': 100.0, 'energy_costs': 39.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.09, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:27,985 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1']
2025-07-26 22:51:28,069 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40.0_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}}
]

Explanation:
AGV_1 is idle at P0 (RawMaterial warehouse) with no load and is the only available AGV. The immediate high-priority action is to continue the flow of raw materials for production. The next available raw material in the buffer is "prod_2_ee0e250f", so AGV_1 is commanded to load this specific product. AGV_2 is currently charging with a critically low battery and is not available for other actions. This keeps the production supply chain active and resource utilization efficient.'
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 635
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40.0_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}}
]

Explanation:
AGV_1 is idle at P0 (RawMaterial warehouse) w...'
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40.0_agv1_load_rawmat_prod_2_ee0e250f","action":"load","target":"AGV_1","params":{"product_id":"prod_2_ee0e250f"}}
]'
2025-07-26 22:51:28,071 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:28,072 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:28,072 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:28,072 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv1_load_rawmat_prod_2_ee0e250f', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_ee0e250f'}, 'timestamp': 1753541488.072075}
2025-07-26 22:51:28,072 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv1_load_rawmat_prod_2_ee0e250f - load for AGV_1
2025-07-26 22:51:28,173 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:28,174 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:28,174 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:29,185 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 99.0, 'command_id': 'flow_40.0_agv1_load_rawmat_prod_2_ee0e250f', 'response': 'Product with id prod_2_ee0e250f not found in warehouse buffer.'}
2025-07-26 22:51:29,185 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv1_load_rawmat_prod_2_ee0e250f response: Product with id prod_2_ee0e250f not found in warehouse buffer.
2025-07-26 22:51:29,548 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 99.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.35, 'first_pass_rate': 0.0, 'total_production_cost': 140.89, 'material_costs': 100.0, 'energy_costs': 40.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.8, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:29,550 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:29,556 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at StationA (P1) and each is still fully loaded with raw materials. The next required action is for each AGV to unload its payload, enabling the start of the production process for the carried products. This matches the critical rule: when an AGV is at the delivery station and holding payload, unload must happen immediately before any other logic (including handling new orders or additional raw material loading). Both AGVs are therefore instructed to UNLOAD at P1.'
2025-07-26 22:51:29,556 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:29,556 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 697
2025-07-26 22:51:29,556 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
B...'
2025-07-26 22:51:29,556 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:29,557 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:29,557 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:29,557 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:29,557 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:29,557 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541489.557324}
2025-07-26 22:51:29,557 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:51:29,659 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv2_unload_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541489.658853}
2025-07-26 22:51:29,659 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv2_unload_p1 - unload for AGV_2
2025-07-26 22:51:29,761 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_available (severity: low)
2025-07-26 22:51:29,761 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_available (severity: low)
2025-07-26 22:51:29,761 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1']
2025-07-26 22:51:30,199 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_97512028', 'created_at': 100.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 22:51:30,200 - order - INFO - [order.py:245] - Created order order_97512028 with 1 products
2025-07-26 22:51:30,200 - order - INFO - [order.py:339] - Assigned 1 products from order order_97512028 to line2
2025-07-26 22:51:30,200 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_97512028 with 1 products to line2
2025-07-26 22:51:30,200 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.31, 'first_pass_rate': 0.0, 'total_production_cost': 140.89, 'material_costs': 100.0, 'energy_costs': 40.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.61, 'total_orders': 19, 'completed_orders': 0, 'active_orders': 19, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:30,319 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_94bd82db', 'created_at': 100.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 700.0}
2025-07-26 22:51:30,320 - order - INFO - [order.py:245] - Created order order_94bd82db with 1 products
2025-07-26 22:51:30,320 - order - INFO - [order.py:339] - Assigned 1 products from order order_94bd82db to line3
2025-07-26 22:51:30,320 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_94bd82db with 1 products to line3
2025-07-26 22:51:30,320 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.31, 'first_pass_rate': 0.0, 'total_production_cost': 140.89, 'material_costs': 100.0, 'energy_costs': 40.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.61, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:30,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.48, 'first_pass_rate': 0.0, 'total_production_cost': 141.89, 'material_costs': 100.0, 'energy_costs': 41.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.57, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:30,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.73, 'first_pass_rate': 0.0, 'total_production_cost': 142.89, 'material_costs': 100.0, 'energy_costs': 42.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.53, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:30,686 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:30,966 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:30,968 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at StationA (P1) and still carrying two raw materials each. According to the critical rule, AGVs that are at their destination with payload must unload their cargo immediately. Issuing unload commands for both AGVs allows raw materials to enter the line for processing as soon as possible, maintaining the highest operational throughput and keeping production flow efficient. This action directly follows priority rules for handling AGVs with payload.'
2025-07-26 22:51:30,969 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:30,969 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 686
2025-07-26 22:51:30,969 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanatio...'
2025-07-26 22:51:30,969 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:30,969 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:30,969 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:30,969 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:30,969 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:30,969 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv1_unload_at_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541490.969455}
2025-07-26 22:51:30,969 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv1_unload_at_p1 - unload for AGV_1
2025-07-26 22:51:31,071 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40_agv2_unload_at_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541491.071053}
2025-07-26 22:51:31,072 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40_agv2_unload_at_p1 - unload for AGV_2
2025-07-26 22:51:31,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_15e3baef', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 570.0}
2025-07-26 22:51:31,321 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.44, 'first_pass_rate': 0.0, 'total_production_cost': 120.89, 'material_costs': 85.0, 'energy_costs': 35.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.9, 'total_orders': 17, 'completed_orders': 0, 'active_orders': 17, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:31,463 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is at P0, loaded with "prod_2_ee0e250f", and is the only available AGV. According to the workflow, the next step is to transport this raw material to StationA (P1) for unloading. AGV_2 is still charging and not available for tasks. Therefore, AGV_1 is commanded to move to P1 so production supply flow continues efficiently. Only one command is issued because only one AGV is available.'
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 516
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is at P0, loaded with "prod_2_ee0e250f", and is the only available AGV...'
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]'
2025-07-26 22:51:31,464 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:31,464 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:31,464 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:31,465 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541491.465004}
2025-07-26 22:51:31,465 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:51:31,566 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:51:31,566 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:51:31,566 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:31,648 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 101.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.92, 'first_pass_rate': 0.0, 'total_production_cost': 143.89, 'material_costs': 100.0, 'energy_costs': 43.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.08, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:31,767 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d9370805', 'created_at': 90.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1800.0}
2025-07-26 22:51:31,768 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 90.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.44, 'first_pass_rate': 0.0, 'total_production_cost': 120.89, 'material_costs': 85.0, 'energy_costs': 35.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.9, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:31,769 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 91.0, 'command_id': 'flow_40_agv1_unload_p1_materials', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_3_4d122871Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.9%'}
2025-07-26 22:51:31,769 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv1_unload_p1_materials response: Â∑≤Â∞Ü‰∫ßÂìÅprod_3_4d122871Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.9%
2025-07-26 22:51:31,769 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 91.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.57, 'first_pass_rate': 0.0, 'total_production_cost': 121.89, 'material_costs': 85.0, 'energy_costs': 36.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 42.33, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:31,936 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:32,019 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 94.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.69, 'first_pass_rate': 0.0, 'total_production_cost': 122.89, 'material_costs': 85.0, 'energy_costs': 37.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.9, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:32,022 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 95.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.63, 'first_pass_rate': 0.0, 'total_production_cost': 137.89, 'material_costs': 100.0, 'energy_costs': 37.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.64, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:32,370 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:32,374 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:32,519 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_45_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_45_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at StationA (P1) and both are fully loaded with raw materials. According to the logic and rules, when an AGV is idle at a delivery station (P1) with payload, the immediate required action is to unload its cargo. This initiates processing of the raw materials by the station, clearing both AGVs for their next transport tasks. Both AGVs therefore receive an unload command at P1.'
2025-07-26 22:51:32,520 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:32,520 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 613
2025-07-26 22:51:32,520 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_45_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_45_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanatio...'
2025-07-26 22:51:32,520 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:32,520 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_45_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_45_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:51:32,520 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:32,520 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:32,520 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:32,520 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_45_agv1_unload_at_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541492.520646}
2025-07-26 22:51:32,521 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_45_agv1_unload_at_p1 - unload for AGV_1
2025-07-26 22:51:32,622 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_45_agv2_unload_at_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541492.622333}
2025-07-26 22:51:32,622 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_45_agv2_unload_at_p1 - unload for AGV_2
2025-07-26 22:51:32,724 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_available (severity: low)
2025-07-26 22:51:32,725 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_available (severity: low)
2025-07-26 22:51:32,725 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2']
2025-07-26 22:51:33,716 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:34,388 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.6, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.21, 'first_pass_rate': 100.0, 'total_production_cost': 144.89, 'material_costs': 100.0, 'energy_costs': 44.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.91, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:35,316 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 105.1, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.44, 'first_pass_rate': 100.0, 'total_production_cost': 145.89, 'material_costs': 100.0, 'energy_costs': 45.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.73, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:35,837 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:35,971 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:36,364 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 105.2, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.67, 'first_pass_rate': 100.0, 'total_production_cost': 146.89, 'material_costs': 100.0, 'energy_costs': 46.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.7, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:36,365 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 105.3, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.25, 'first_pass_rate': 100.0, 'total_production_cost': 147.89, 'material_costs': 100.0, 'energy_costs': 47.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.67, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:36,473 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 106.5, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.44, 'first_pass_rate': 100.0, 'total_production_cost': 148.89, 'material_costs': 100.0, 'energy_costs': 48.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.25, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:36,697 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is available at P0, loaded with "prod_2_ee0e250f". The highest priority for available AGVs (other than charging) is completing the delivery of raw materials. The required action is to deliver this payload to StationA (P1), so AGV_1 is instructed to move to P1. AGV_2 remains unavailable while charging. Only AGV_1 receives a new command because only one AGV is available for assignment. This command sustains the production flow and prioritizes new order fulfillment.'
2025-07-26 22:51:36,697 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:36,697 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 597
2025-07-26 22:51:36,697 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is available at P0, loaded with "prod_2_ee0e250f". The highest priorit...'
2025-07-26 22:51:36,698 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:36,698 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]'
2025-07-26 22:51:36,698 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:36,698 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:36,698 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:36,698 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541496.69846}
2025-07-26 22:51:36,698 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:51:36,800 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:36,801 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:36,801 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3']
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
No command is issued at this step because AGV_1 is currently in a MOVING state (traveling from P0 to P1) and cannot be assigned a new action until it arrives and is idle again. AGV_2 is still busy charging and is not available for any commands. The system waits until an AGV is idle and ready for its next operation.'
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 333
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
No command is issued at this step because AGV_1 is currently in a MOVING state (traveling from P0 to P1) and cannot be assigned a new action until it arrives and is idle again. AGV_2 ...'
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:51:36,888 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 27, Finished products: 1
2025-07-26 22:51:36,889 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.MOVING at P0, battery 35.50333389%
2025-07-26 22:51:36,889 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.CHARGING at P1, battery 10.850002470000007%
2025-07-26 22:51:38,057 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 107.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.57, 'first_pass_rate': 100.0, 'total_production_cost': 150.07, 'material_costs': 100.0, 'energy_costs': 50.07, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.15, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:38,057 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 107.91666651, 'command_id': 'flow_40.0_agv1_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 33.8%'}
2025-07-26 22:51:38,057 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv1_move_p1 response: Successfully arrived at path point P1, remaining battery: 33.8%
2025-07-26 22:51:38,227 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 95.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.19, 'first_pass_rate': 0.0, 'total_production_cost': 138.89, 'material_costs': 100.0, 'energy_costs': 38.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.6, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:38,459 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 96.0, 'command_id': 'flow_40_agv1_unload_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_3_63af60aeÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.4%'}
2025-07-26 22:51:38,459 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv1_unload_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_3_63af60aeÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.4%
2025-07-26 22:51:38,459 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 96.0, 'command_id': 'flow_40_agv2_unload_p1_materials', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_1_fa0a15baÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.9%'}
2025-07-26 22:51:38,459 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv2_unload_p1_materials response: Â∑≤Â∞Ü‰∫ßÂìÅprod_1_fa0a15baÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.9%
2025-07-26 22:51:38,459 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 96.09999999999916, 'command_id': 'flow_40_agv2_unload_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_1_bc72e76cÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.4%'}
2025-07-26 22:51:38,459 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv2_unload_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_1_bc72e76cÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 38.4%
2025-07-26 22:51:38,836 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:38,985 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 96.3, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.42, 'first_pass_rate': 0.0, 'total_production_cost': 139.89, 'material_costs': 100.0, 'energy_costs': 39.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 40.09, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:38,986 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 99.5, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.35, 'first_pass_rate': 0.0, 'total_production_cost': 140.89, 'material_costs': 100.0, 'energy_costs': 40.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.8, 'total_orders': 18, 'completed_orders': 0, 'active_orders': 18, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:38,986 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 100.0, 'command_id': 'flow_40_agv1_unload_p1', 'response': 'Can not unload. StationA is full.'}
2025-07-26 22:51:38,986 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv1_unload_p1 response: Can not unload. StationA is full.
2025-07-26 22:51:38,987 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 100.0, 'command_id': 'flow_40_agv2_unload_p1', 'response': 'Can not unload. StationA is full.'}
2025-07-26 22:51:38,987 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv2_unload_p1 response: Can not unload. StationA is full.
2025-07-26 22:51:39,104 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_97512028', 'created_at': 100.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 420.0}
2025-07-26 22:51:39,105 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.31, 'first_pass_rate': 0.0, 'total_production_cost': 140.89, 'material_costs': 100.0, 'energy_costs': 40.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.61, 'total_orders': 19, 'completed_orders': 0, 'active_orders': 19, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:39,107 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_94bd82db', 'created_at': 100.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 700.0}
2025-07-26 22:51:39,107 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.0, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.31, 'first_pass_rate': 0.0, 'total_production_cost': 140.89, 'material_costs': 100.0, 'energy_costs': 40.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.61, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:39,174 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2']
2025-07-26 22:51:39,222 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.1, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.48, 'first_pass_rate': 0.0, 'total_production_cost': 141.89, 'material_costs': 100.0, 'energy_costs': 41.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.57, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:39,222 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 100.2, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.73, 'first_pass_rate': 0.0, 'total_production_cost': 142.89, 'material_costs': 100.0, 'energy_costs': 42.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.53, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:39,251 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.77, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.44, 'first_pass_rate': 100.0, 'total_production_cost': 150.07, 'material_costs': 100.0, 'energy_costs': 50.07, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.78, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:39,352 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 101.4, 'order_completion_rate': 0.0, 'average_production_cycle': 0.0, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.92, 'first_pass_rate': 0.0, 'total_production_cost': 143.89, 'material_costs': 100.0, 'energy_costs': 43.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 38.08, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 0, 'active_faults': 0}
2025-07-26 22:51:39,354 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 102.0, 'command_id': 'flow_40_agv1_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:39,354 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv1_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:39,354 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 102.0, 'command_id': 'flow_40_agv2_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:39,354 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40_agv2_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:39,354 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 103.0, 'command_id': 'flow_45_agv1_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:39,354 - src.line_commander - INFO - [line_commander.py:278] - Command flow_45_agv1_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:39,510 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 103.0, 'command_id': 'flow_45_agv2_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:39,510 - src.line_commander - INFO - [line_commander.py:278] - Command flow_45_agv2_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:39,511 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 104.6, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.21, 'first_pass_rate': 100.0, 'total_production_cost': 144.89, 'material_costs': 100.0, 'energy_costs': 44.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.91, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:39,512 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 105.1, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.44, 'first_pass_rate': 100.0, 'total_production_cost': 145.89, 'material_costs': 100.0, 'energy_costs': 45.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.73, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:39,561 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.77, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.76, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.78, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:39,619 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 105.2, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.67, 'first_pass_rate': 100.0, 'total_production_cost': 146.89, 'material_costs': 100.0, 'energy_costs': 46.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.7, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:39,620 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 105.3, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.25, 'first_pass_rate': 100.0, 'total_production_cost': 147.89, 'material_costs': 100.0, 'energy_costs': 47.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.67, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:39,666 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 109.76576502402402, 'command_id': 'flow_30.0_agv2_charge_80', 'response': 'ÂÖÖÁîµÂÆåÊàêÔºåÂΩìÂâçÁîµÈáè: 80.0%'}
2025-07-26 22:51:39,667 - src.line_commander - INFO - [line_commander.py:278] - Command flow_30.0_agv2_charge_80 response: ÂÖÖÁîµÂÆåÊàêÔºåÂΩìÂâçÁîµÈáè: 80.0%
2025-07-26 22:51:40,262 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_59cbba6e', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 510.0}
2025-07-26 22:51:40,262 - order - INFO - [order.py:245] - Created order order_59cbba6e with 1 products
2025-07-26 22:51:40,262 - order - INFO - [order.py:339] - Assigned 1 products from order order_59cbba6e to line1
2025-07-26 22:51:40,263 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_59cbba6e with 1 products to line1
2025-07-26 22:51:40,369 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.74, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.7, 'total_orders': 21, 'completed_orders': 0, 'active_orders': 21, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,370 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 106.5, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.44, 'first_pass_rate': 100.0, 'total_production_cost': 148.89, 'material_costs': 100.0, 'energy_costs': 48.89, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 36.25, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,371 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 107.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.57, 'first_pass_rate': 100.0, 'total_production_cost': 150.07, 'material_costs': 100.0, 'energy_costs': 50.07, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 0.0, 'agv_energy_efficiency': 0.0, 'agv_utilization': 37.15, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,371 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.77, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.44, 'first_pass_rate': 100.0, 'total_production_cost': 150.07, 'material_costs': 100.0, 'energy_costs': 50.07, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.78, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,627 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:40,678 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 109.77, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.76, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.78, 'total_orders': 20, 'completed_orders': 0, 'active_orders': 20, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,679 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_59cbba6e', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 510.0}
2025-07-26 22:51:40,679 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.45, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.74, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.7, 'total_orders': 21, 'completed_orders': 0, 'active_orders': 21, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,754 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5cfadadc', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1940.0}
2025-07-26 22:51:40,754 - order - INFO - [order.py:245] - Created order order_5cfadadc with 3 products
2025-07-26 22:51:40,754 - order - INFO - [order.py:339] - Assigned 3 products from order order_5cfadadc to line2
2025-07-26 22:51:40,754 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_5cfadadc with 3 products to line2
2025-07-26 22:51:40,755 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.67, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.74, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.7, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,755 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.7, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.7, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,757 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.1, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.81, 'first_pass_rate': 100.0, 'total_production_cost': 155.22, 'material_costs': 100.0, 'energy_costs': 55.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.66, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,796 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_5cfadadc', 'created_at': 110.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1940.0}
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
Although three actions are needed (including finished products handling and raw materials transport), only one AGV (AGV_1) is available, and it is currently in a MOVING state with a payload (en route from P0 to P1). According to the rules, no new command can be sent to an AGV while it is moving; commands can only be sent when the AGV is idle at its target. AGV_2 is still charging and not available for a new command. Thus, no command is issued in this cycle; next commands will be generated once an AGV is idle and ready for instruction.'
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 557
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
Although three actions are needed (including finished products handling and raw materials transport), only one AGV (AGV_1) is available, and it is currently in a MOVING state with a p...'
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 27, Finished products: 1
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P1, battery 33.820000588%
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P1, battery 80.0%
2025-07-26 22:51:40,806 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:51:40,806 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2']
2025-07-26 22:51:40,910 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.67, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.74, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.7, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:40,910 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.0, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.7, 'first_pass_rate': 100.0, 'total_production_cost': 154.22, 'material_costs': 100.0, 'energy_costs': 54.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.7, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,201 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.2, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.99, 'first_pass_rate': 100.0, 'total_production_cost': 156.22, 'material_costs': 100.0, 'energy_costs': 56.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.63, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,202 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.3, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.22, 'first_pass_rate': 100.0, 'total_production_cost': 157.22, 'material_costs': 100.0, 'energy_costs': 57.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.59, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,203 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.4, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.42, 'first_pass_rate': 100.0, 'total_production_cost': 158.22, 'material_costs': 100.0, 'energy_costs': 58.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.56, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.1, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.81, 'first_pass_rate': 100.0, 'total_production_cost': 155.22, 'material_costs': 100.0, 'energy_costs': 55.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.66, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 111.6, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.56, 'first_pass_rate': 100.0, 'total_production_cost': 159.22, 'material_costs': 100.0, 'energy_costs': 59.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.14, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,608 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.2, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 12.99, 'first_pass_rate': 100.0, 'total_production_cost': 156.22, 'material_costs': 100.0, 'energy_costs': 56.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.63, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,609 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.3, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.22, 'first_pass_rate': 100.0, 'total_production_cost': 157.22, 'material_costs': 100.0, 'energy_costs': 57.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.59, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,721 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 110.4, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.42, 'first_pass_rate': 100.0, 'total_production_cost': 158.22, 'material_costs': 100.0, 'energy_costs': 58.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.56, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:41,840 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 111.6, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.56, 'first_pass_rate': 100.0, 'total_production_cost': 159.22, 'material_costs': 100.0, 'energy_costs': 59.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.56, 'agv_utilization': 37.14, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:42,276 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 112.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.46, 'first_pass_rate': 100.0, 'total_production_cost': 159.22, 'material_costs': 100.0, 'energy_costs': 59.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 36.69, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:42,276 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 112.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.46, 'first_pass_rate': 100.0, 'total_production_cost': 159.22, 'material_costs': 100.0, 'energy_costs': 59.22, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 36.69, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:42,446 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:42,451 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_46_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_46_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at P1 (StationA) and do not have any payload. Since there are raw materials available at P0 (RawMaterial warehouse) and no finished product or P3 special upper buffer situation, the next priority is to position idle AGVs to load fresh materials. Both AGVs are therefore sent to P0 to prepare for the next LOAD commands, maximizing production efficiency and keeping the flow of raw materials continuous. Each AGV receives a MOVE command to P0, as required by the sequence logic.'
2025-07-26 22:51:42,451 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:42,453 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 742
2025-07-26 22:51:42,454 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_46_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_46_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:51:42,454 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:42,454 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_46_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_46_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:51:42,454 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:42,454 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:42,454 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:42,455 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_46_agv1_move_to_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541502.454856}
2025-07-26 22:51:42,455 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_46_agv1_move_to_p0 - move for AGV_1
2025-07-26 22:51:42,557 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_46_agv2_move_to_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541502.556509}
2025-07-26 22:51:42,557 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_46_agv2_move_to_p0 - move for AGV_2
2025-07-26 22:51:42,764 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 112.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.72, 'first_pass_rate': 100.0, 'total_production_cost': 160.41, 'material_costs': 100.0, 'energy_costs': 60.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 38.0, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:43,013 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 112.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.72, 'first_pass_rate': 100.0, 'total_production_cost': 160.41, 'material_costs': 100.0, 'energy_costs': 60.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 38.0, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:43,192 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 112.91666651, 'command_id': 'flow_40.0_agv1_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 32.1%'}
2025-07-26 22:51:43,193 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv1_move_p1 response: Successfully arrived at path point P1, remaining battery: 32.1%
2025-07-26 22:51:44,889 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2']
2025-07-26 22:51:45,386 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.2, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.79, 'first_pass_rate': 100.0, 'total_production_cost': 161.41, 'material_costs': 100.0, 'energy_costs': 61.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.22, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:45,800 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.2, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.79, 'first_pass_rate': 100.0, 'total_production_cost': 161.41, 'material_costs': 100.0, 'energy_costs': 61.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.22, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:45,801 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:45,997 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]

Explanation:
- AGV_1 is idle at P1 and loaded with "prod_2_ee0e250f". Its immediate next step, according to the raw material delivery procedure, is to unload its payload at StationA (P1), so it is assigned an unload command.
- AGV_2 is idle at P1 with no payload. There is a finished product waiting at QualityCheck output (P8), so AGV_2 should move to P8 for collection. This ensures finished products are prioritized for shipment as per the high-priority event/actions.

This maintains optimal workflow by simultaneously supporting both supply of raw material and prompt handling of finished goods. Each AGV is issued only one command.'
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 840
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
...'
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]'
2025-07-26 22:51:45,999 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:45,999 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:45,999 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:45,999 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541505.999768}
2025-07-26 22:51:45,999 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:51:46,101 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv2_move_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753541506.101299}
2025-07-26 22:51:46,102 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv2_move_p8 - move for AGV_2
2025-07-26 22:51:46,203 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 22:51:46,203 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_loaded_idle (severity: high)
2025-07-26 22:51:46,204 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2']
2025-07-26 22:51:46,323 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.3, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.01, 'first_pass_rate': 100.0, 'total_production_cost': 162.41, 'material_costs': 100.0, 'energy_costs': 62.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.19, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:46,323 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.4, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.2, 'first_pass_rate': 100.0, 'total_production_cost': 163.41, 'material_costs': 100.0, 'energy_costs': 63.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.15, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:46,323 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.5, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.72, 'first_pass_rate': 100.0, 'total_production_cost': 164.41, 'material_costs': 100.0, 'energy_costs': 64.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.12, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:46,417 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.3, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.01, 'first_pass_rate': 100.0, 'total_production_cost': 162.41, 'material_costs': 100.0, 'energy_costs': 62.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.19, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:46,559 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 116.7, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.87, 'first_pass_rate': 100.0, 'total_production_cost': 165.41, 'material_costs': 100.0, 'energy_costs': 65.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 36.72, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:46,609 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:46,865 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.4, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.2, 'first_pass_rate': 100.0, 'total_production_cost': 163.41, 'material_costs': 100.0, 'energy_costs': 63.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.15, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:46,986 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 115.5, 'order_completion_rate': 0.0, 'average_production_cycle': 7.34, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.72, 'first_pass_rate': 100.0, 'total_production_cost': 164.41, 'material_costs': 100.0, 'energy_costs': 64.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 37.12, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 1, 'active_faults': 0}
2025-07-26 22:51:47,101 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 116.7, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.87, 'first_pass_rate': 100.0, 'total_production_cost': 165.41, 'material_costs': 100.0, 'energy_costs': 65.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.63, 'agv_utilization': 36.72, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:47,596 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:48,424 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 118.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.68, 'first_pass_rate': 100.0, 'total_production_cost': 165.41, 'material_costs': 100.0, 'energy_costs': 65.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.69, 'agv_utilization': 36.02, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:48,425 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 118.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.92, 'first_pass_rate': 100.0, 'total_production_cost': 166.59, 'material_costs': 100.0, 'energy_costs': 66.59, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.69, 'agv_utilization': 37.26, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:48,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 118.0, 'command_id': 'flow_40.0_agv1_unload_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_ee0e250fÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 31.6%'}
2025-07-26 22:51:48,544 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv1_unload_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_ee0e250fÂç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 31.6%
2025-07-26 22:51:48,545 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 118.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.68, 'first_pass_rate': 100.0, 'total_production_cost': 165.41, 'material_costs': 100.0, 'energy_costs': 65.41, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.69, 'agv_utilization': 36.02, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:48,546 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 118.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.92, 'first_pass_rate': 100.0, 'total_production_cost': 166.59, 'material_costs': 100.0, 'energy_costs': 66.59, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.69, 'agv_utilization': 37.26, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:48,547 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 118.91666651, 'command_id': 'flow_46_agv1_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 36.7%'}
2025-07-26 22:51:48,547 - src.line_commander - INFO - [line_commander.py:278] - Command flow_46_agv1_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 36.7%
2025-07-26 22:51:48,609 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:48,615 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:
- AGV_1 is idle at P1, loaded with "prod_2_ee0e250f". According to the workflow, it must unload this raw material at P1 (StationA) before taking any further actions. The command to AGV_1 is to unload at P1.
- AGV_2 is idle at P1, fully charged, and has no payload. To keep the raw material supply flowing, AGV_2 should proceed to the RawMaterial warehouse (P0) to prepare for loading the next product in line (e.g., "prod_2_97fc9b53"). The command to AGV_2 is to move to P0.

These commands keep both AGVs utilized and the material flow running efficiently, supporting both immediate delivery and preparation for further raw materials movement.'
2025-07-26 22:51:48,615 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:48,615 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 860
2025-07-26 22:51:48,616 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
...'
2025-07-26 22:51:48,616 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:48,616 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40.0_agv1_unload_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_40.0_agv2_move_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:51:48,616 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:48,616 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:48,616 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:48,617 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv1_unload_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541508.616785}
2025-07-26 22:51:48,617 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv1_unload_p1 - unload for AGV_1
2025-07-26 22:51:48,719 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv2_move_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541508.718715}
2025-07-26 22:51:48,720 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv2_move_p0 - move for AGV_2
2025-07-26 22:51:49,312 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.85, 'first_pass_rate': 100.0, 'total_production_cost': 166.59, 'material_costs': 100.0, 'energy_costs': 66.59, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.94, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:49,472 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 13.85, 'first_pass_rate': 100.0, 'total_production_cost': 166.59, 'material_costs': 100.0, 'energy_costs': 66.59, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.94, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:49,708 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.09, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.17, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:49,708 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 119.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.09, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.17, 'total_orders': 22, 'completed_orders': 0, 'active_orders': 22, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:49,709 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 119.91666651, 'command_id': 'flow_46_agv2_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 36.7%'}
2025-07-26 22:51:49,709 - src.line_commander - INFO - [line_commander.py:278] - Command flow_46_agv2_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 36.7%
2025-07-26 22:51:50,520 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_1fa1057d', 'created_at': 120.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 600.0}
2025-07-26 22:51:50,521 - order - INFO - [order.py:245] - Created order order_1fa1057d with 1 products
2025-07-26 22:51:50,521 - order - INFO - [order.py:339] - Assigned 1 products from order order_1fa1057d to line3
2025-07-26 22:51:50,521 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_1fa1057d with 1 products to line3
2025-07-26 22:51:50,522 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.08, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.15, 'total_orders': 23, 'completed_orders': 0, 'active_orders': 23, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:50,522 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a57cc002', 'created_at': 120.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1830.0}
2025-07-26 22:51:50,523 - order - INFO - [order.py:245] - Created order order_a57cc002 with 3 products
2025-07-26 22:51:50,523 - order - INFO - [order.py:339] - Assigned 3 products from order order_a57cc002 to line1
2025-07-26 22:51:50,523 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_a57cc002 with 3 products to line1
2025-07-26 22:51:50,635 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.43, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.08, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.15, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:50,637 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:50,637 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.05, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.15, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:50,639 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.3, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.05, 'first_pass_rate': 100.0, 'total_production_cost': 168.77, 'material_costs': 100.0, 'energy_costs': 68.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.05, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_40.0_agv1_move_p9","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_40.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]

Explanation:
- AGV_1 is idle at P1 with a payload ("prod_2_ee0e250f"). According to the CRITICAL PRIORITY RULE, it must complete its payload delivery immediately. Since it is not at P9 (Warehouse), it must move there so it can unload. Command: move AGV_1 to P9.
- AGV_2 is idle at P1 with no load, and there is a finished product at QualityCheck output (P8). Following the HIGH priority for finished products, AGV_2 is dispatched to P8 to collect finished products for delivery. 

This ensures urgent payload movement for AGV_1 and simultaneous, prioritized collection of finished goods with AGV_2. Only one command per AGV is issued.'
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 852
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_40.0_agv1_move_p9","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_40.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target...'
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_40.0_agv1_move_p9","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_40.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]'
2025-07-26 22:51:50,643 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:50,643 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:51:50,643 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:51:50,644 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753541510.643852}
2025-07-26 22:51:50,644 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv1_move_p9 - move for AGV_1
2025-07-26 22:51:50,660 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:50,719 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 120.0, 'command_id': 'flow_40.0_agv1_unload_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:51:50,719 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv1_unload_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:51:50,720 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_1fa1057d', 'created_at': 120.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 600.0}
2025-07-26 22:51:50,720 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.08, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.15, 'total_orders': 23, 'completed_orders': 0, 'active_orders': 23, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:50,745 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_40.0_agv2_move_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753541510.745457}
2025-07-26 22:51:50,745 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_40.0_agv2_move_p8 - move for AGV_2
2025-07-26 22:51:50,847 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_available (severity: low)
2025-07-26 22:51:50,847 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_available (severity: low)
2025-07-26 22:51:50,847 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1']
2025-07-26 22:51:51,043 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.4, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.21, 'first_pass_rate': 100.0, 'total_production_cost': 169.77, 'material_costs': 100.0, 'energy_costs': 69.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.02, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,692 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.5, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.41, 'first_pass_rate': 100.0, 'total_production_cost': 170.77, 'material_costs': 100.0, 'energy_costs': 70.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 37.98, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,693 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a57cc002', 'created_at': 120.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P3', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1830.0}
2025-07-26 22:51:51,695 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.43, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.08, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.15, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,695 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.05, 'first_pass_rate': 100.0, 'total_production_cost': 167.77, 'material_costs': 100.0, 'energy_costs': 67.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.15, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,696 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.3, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.05, 'first_pass_rate': 100.0, 'total_production_cost': 168.77, 'material_costs': 100.0, 'energy_costs': 68.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.05, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,696 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.6, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.58, 'first_pass_rate': 100.0, 'total_production_cost': 171.77, 'material_costs': 100.0, 'energy_costs': 71.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 37.95, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,697 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.4, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.21, 'first_pass_rate': 100.0, 'total_production_cost': 169.77, 'material_costs': 100.0, 'energy_costs': 69.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 38.02, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:51,697 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.5, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.41, 'first_pass_rate': 100.0, 'total_production_cost': 170.77, 'material_costs': 100.0, 'energy_costs': 70.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 37.98, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:52,433 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 120.6, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.58, 'first_pass_rate': 100.0, 'total_production_cost': 171.77, 'material_costs': 100.0, 'energy_costs': 71.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 37.95, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:52,617 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 122.1, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.76, 'first_pass_rate': 100.0, 'total_production_cost': 172.77, 'material_costs': 100.0, 'energy_costs': 72.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 37.47, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:53,141 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 122.1, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.76, 'first_pass_rate': 100.0, 'total_production_cost': 172.77, 'material_costs': 100.0, 'energy_costs': 72.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 37.47, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:54,228 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:55,343 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.4, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.51, 'first_pass_rate': 100.0, 'total_production_cost': 173.77, 'material_costs': 100.0, 'energy_costs': 73.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.45, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:55,344 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.4, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.51, 'first_pass_rate': 100.0, 'total_production_cost': 173.77, 'material_costs': 100.0, 'energy_costs': 73.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.45, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:55,562 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_47_agv1_load_prod_2_97fc9b53","action":"load","target":"AGV_1","params":{"product_id":"prod_2_97fc9b53"}},
  {"command_id":"flow_47_agv2_load_prod_3_8e711d58","action":"load","target":"AGV_2","params":{"product_id":"prod_3_8e711d58"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at P0 (RawMaterial warehouse) with no payload. The highest priority is to continue feeding raw materials into the production flow. According to the buffer, the next available products are prod_2_97fc9b53 (P2 type) and prod_3_8e711d58 (P3 type). AGV_1 is tasked to load prod_2_97fc9b53, and AGV_2 is tasked to load prod_3_8e711d58. This approach ensures both AGVs are immediately active and advancing production of distinct product types, maximizing throughput and line balance.'
2025-07-26 22:51:55,562 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:55,562 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 784
2025-07-26 22:51:55,563 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_47_agv1_load_prod_2_97fc9b53","action":"load","target":"AGV_1","params":{"product_id":"prod_2_97fc9b53"}},
  {"command_id":"flow_47_agv2_load_prod_3_8e711d58","action":"load","...'
2025-07-26 22:51:55,563 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:55,563 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_47_agv1_load_prod_2_97fc9b53","action":"load","target":"AGV_1","params":{"product_id":"prod_2_97fc9b53"}},
  {"command_id":"flow_47_agv2_load_prod_3_8e711d58","action":"load","target":"AGV_2","params":{"product_id":"prod_3_8e711d58"}}
]'
2025-07-26 22:51:55,563 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:51:55,563 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:51:55,563 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:51:55,563 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_47_agv1_load_prod_2_97fc9b53', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_2_97fc9b53'}, 'timestamp': 1753541515.56332}
2025-07-26 22:51:55,563 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_47_agv1_load_prod_2_97fc9b53 - load for AGV_1
2025-07-26 22:51:55,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_47_agv2_load_prod_3_8e711d58', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_3_8e711d58'}, 'timestamp': 1753541515.664923}
2025-07-26 22:51:55,665 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_47_agv2_load_prod_3_8e711d58 - load for AGV_2
2025-07-26 22:51:55,764 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:56,017 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.5, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.71, 'first_pass_rate': 100.0, 'total_production_cost': 174.77, 'material_costs': 100.0, 'energy_costs': 74.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.43, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,017 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.6, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.87, 'first_pass_rate': 100.0, 'total_production_cost': 175.77, 'material_costs': 100.0, 'energy_costs': 75.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.4, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,283 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.86, 'first_pass_rate': 100.0, 'total_production_cost': 175.77, 'material_costs': 100.0, 'energy_costs': 75.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.3, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,283 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.08, 'first_pass_rate': 100.0, 'total_production_cost': 176.96, 'material_costs': 100.0, 'energy_costs': 76.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.63, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,283 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 125.91666651, 'command_id': 'flow_40.0_agv2_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 73.6%'}
2025-07-26 22:51:56,283 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv2_move_p0 response: Successfully arrived at path point P0, remaining battery: 73.6%
2025-07-26 22:51:56,297 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:56,396 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.5, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.71, 'first_pass_rate': 100.0, 'total_production_cost': 174.77, 'material_costs': 100.0, 'energy_costs': 74.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.43, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_43.95_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
AGV_1 is idle at P1 with no payload. To maintain continuous production flow and prepare for raw material transport, it should move to the RawMaterial warehouse (P0) to be ready for the next load command. AGV_2, although reported as available at P0 in the event details, is shown as MOVING at P1 in the current AGV status, so it cannot receive a command until it is idle. Therefore, only AGV_1 is assigned a command in this cycle, keeping resource utilization high and production uninterrupted.'
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 618
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_43.95_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]

Explanation:
AGV_1 is idle at P1 with no payload. To maintain continuous production flow...'
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_43.95_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}}
]'
2025-07-26 22:51:56,462 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:51:56,462 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:51:56,462 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:51:56,462 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_43.95_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541516.462779}
2025-07-26 22:51:56,462 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_43.95_agv1_move_p0 - move for AGV_1
2025-07-26 22:51:56,505 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 126.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.07, 'first_pass_rate': 100.0, 'total_production_cost': 191.96, 'material_costs': 115.0, 'energy_costs': 76.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.61, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,564 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:56,564 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:56,564 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1']
2025-07-26 22:51:56,616 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.6, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.87, 'first_pass_rate': 100.0, 'total_production_cost': 175.77, 'material_costs': 100.0, 'energy_costs': 75.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.76, 'agv_utilization': 36.4, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,616 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.86, 'first_pass_rate': 100.0, 'total_production_cost': 175.77, 'material_costs': 100.0, 'energy_costs': 75.77, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.3, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,811 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 125.92, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.08, 'first_pass_rate': 100.0, 'total_production_cost': 176.96, 'material_costs': 100.0, 'energy_costs': 76.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.63, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,813 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 126.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.07, 'first_pass_rate': 100.0, 'total_production_cost': 191.96, 'material_costs': 115.0, 'energy_costs': 76.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.61, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:56,824 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1']
2025-07-26 22:51:57,151 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:57,450 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 127.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.01, 'first_pass_rate': 100.0, 'total_production_cost': 211.96, 'material_costs': 135.0, 'energy_costs': 76.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.3, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:57,452 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 127.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.01, 'first_pass_rate': 100.0, 'total_production_cost': 211.96, 'material_costs': 135.0, 'energy_costs': 76.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.3, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:57,452 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 127.2, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.2, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.24, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:57,571 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 127.0, 'command_id': 'flow_47_agv1_load_prod_2_97fc9b53', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_97fc9b53Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 36.2%'}
2025-07-26 22:51:57,572 - src.line_commander - INFO - [line_commander.py:278] - Command flow_47_agv1_load_prod_2_97fc9b53 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_2_97fc9b53Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 36.2%
2025-07-26 22:51:57,572 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 127.2, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.2, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 37.24, 'total_orders': 24, 'completed_orders': 0, 'active_orders': 24, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:51:58,221 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:51:58,610 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:51:58,614 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:  
Both AGV_1 and AGV_2 are currently BUSY (interacting). According to the critical rule, you can only issue commands to AGVs that are AVAILABLE. No command can be issued until at least one AGV status changes to AVAILABLE and idle. Please wait for the next availability signal before proceeding with load, move, or other actions.'
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 345
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:  
Both AGV_1 and AGV_2 are currently BUSY (interacting). According to the critical rule, you can only issue commands to AGVs that are AVAILABLE. No command can be issued until at leas...'
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:51:58,615 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 25, Finished products: 0
2025-07-26 22:51:58,616 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P0, battery 36.186667192%
2025-07-26 22:51:58,616 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.INTERACTING at P0, battery 36.686667192%
2025-07-26 22:51:58,616 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:51:58,616 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:51:58,616 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.INTERACTING, battery: 36.686667192%)
2025-07-26 22:51:58,616 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:51:58,616 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:51:58,700 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 128.0, 'command_id': 'flow_47_agv2_load_prod_3_8e711d58', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_8e711d58Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 36.2%'}
2025-07-26 22:51:58,700 - src.line_commander - INFO - [line_commander.py:278] - Command flow_47_agv2_load_prod_3_8e711d58 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_8e711d58Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 36.2%
2025-07-26 22:52:00,718 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_1985b804', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 450.0}
2025-07-26 22:52:00,718 - order - INFO - [order.py:245] - Created order order_1985b804 with 1 products
2025-07-26 22:52:00,719 - order - INFO - [order.py:339] - Assigned 1 products from order order_1985b804 to line2
2025-07-26 22:52:00,719 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_1985b804 with 1 products to line2
2025-07-26 22:52:00,719 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.03, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.41, 'total_orders': 25, 'completed_orders': 0, 'active_orders': 25, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:01,123 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_263db0fc', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2290.0}
2025-07-26 22:52:01,124 - order - INFO - [order.py:245] - Created order order_263db0fc with 4 products
2025-07-26 22:52:01,124 - order - INFO - [order.py:339] - Assigned 4 products from order order_263db0fc to line3
2025-07-26 22:52:01,124 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_263db0fc with 4 products to line3
2025-07-26 22:52:01,125 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.99, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.03, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:01,177 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_1985b804', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 450.0}
2025-07-26 22:52:01,285 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.8, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.03, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.41, 'total_orders': 25, 'completed_orders': 0, 'active_orders': 25, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,085 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.99, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,087 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.5, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.94, 'first_pass_rate': 100.0, 'total_production_cost': 213.96, 'material_costs': 135.0, 'energy_costs': 78.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.27, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,088 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:02,088 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.6, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.08, 'first_pass_rate': 100.0, 'total_production_cost': 214.96, 'material_costs': 135.0, 'energy_costs': 79.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.24, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,580 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:02,581 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_263db0fc', 'created_at': 130.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 2290.0}
2025-07-26 22:52:02,582 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 6.99, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.03, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,582 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.0, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.99, 'first_pass_rate': 100.0, 'total_production_cost': 212.96, 'material_costs': 135.0, 'energy_costs': 77.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv2_load_rawmat_prod_3_8e711d58","action":"load","target":"AGV_2","params":{"product_id":"prod_3_8e711d58"}}
]

Explanation:
AGV_2 is idle and available at P0 (RawMaterial warehouse) with no load, making it ready to act. The next raw material in the buffer is "prod_3_8e711d58", so AGV_2 should load this item to keep the raw materials flowing for production. AGV_1 is currently in a MOVING state and cannot be given a new command until it is idle. Only one command can be issued at this step under these conditions.'
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 546
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv2_load_rawmat_prod_3_8e711d58","action":"load","target":"AGV_2","params":{"product_id":"prod_3_8e711d58"}}
]

Explanation:
AGV_2 is idle and available at P0 (RawMateria...'
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv2_load_rawmat_prod_3_8e711d58","action":"load","target":"AGV_2","params":{"product_id":"prod_3_8e711d58"}}
]'
2025-07-26 22:52:02,639 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:02,640 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:02,640 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:02,640 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv2_load_rawmat_prod_3_8e711d58', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_3_8e711d58'}, 'timestamp': 1753541522.640226}
2025-07-26 22:52:02,640 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv2_load_rawmat_prod_3_8e711d58 - load for AGV_2
2025-07-26 22:52:02,692 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.2, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.24, 'first_pass_rate': 100.0, 'total_production_cost': 215.96, 'material_costs': 135.0, 'energy_costs': 80.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 35.79, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,741 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:02,742 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:02,742 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1']
2025-07-26 22:52:02,805 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.0, 'first_pass_rate': 100.0, 'total_production_cost': 215.96, 'material_costs': 135.0, 'energy_costs': 80.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.59, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,805 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.5, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.94, 'first_pass_rate': 100.0, 'total_production_cost': 213.96, 'material_costs': 135.0, 'energy_costs': 78.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.27, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,806 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.21, 'first_pass_rate': 100.0, 'total_production_cost': 217.14, 'material_costs': 135.0, 'energy_costs': 82.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 36.7, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,806 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 130.6, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.08, 'first_pass_rate': 100.0, 'total_production_cost': 214.96, 'material_costs': 135.0, 'energy_costs': 79.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 36.24, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:02,806 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 132.91666651, 'command_id': 'flow_43.95_agv1_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 30.0%'}
2025-07-26 22:52:02,806 - src.line_commander - INFO - [line_commander.py:278] - Command flow_43.95_agv1_move_p0 response: Successfully arrived at path point P0, remaining battery: 30.0%
2025-07-26 22:52:03,291 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.2, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.24, 'first_pass_rate': 100.0, 'total_production_cost': 215.96, 'material_costs': 135.0, 'energy_costs': 80.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.83, 'agv_utilization': 35.79, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:03,291 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.0, 'first_pass_rate': 100.0, 'total_production_cost': 215.96, 'material_costs': 135.0, 'energy_costs': 80.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.59, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:03,291 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 132.92, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.21, 'first_pass_rate': 100.0, 'total_production_cost': 217.14, 'material_costs': 135.0, 'energy_costs': 82.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 36.7, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:03,628 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_44.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]

Explanation:
- AGV_2 is idle at P0 with no payload and there are finished products ready at QualityCheck output (P8). According to the plant‚Äôs priority rules, finished products should be transported first. So, AGV_2 is commanded to move to P8 to collect finished goods for delivery.
- AGV_1 is currently MOVING (traveling between points), so cannot be given a new command until it becomes idle. Only AGV_2 receives a command at this step. This maintains flow for both finished products and upcoming raw material handling.'
2025-07-26 22:52:03,628 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:03,628 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 632
2025-07-26 22:52:03,628 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_44.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]

Explanation:
- AGV_2 is idle at P0 with no payload and there are finished products ready ...'
2025-07-26 22:52:03,628 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:03,629 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_44.0_agv2_move_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]'
2025-07-26 22:52:03,629 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:03,629 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:03,629 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:03,629 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_44.0_agv2_move_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753541523.629237}
2025-07-26 22:52:03,629 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_44.0_agv2_move_p8 - move for AGV_2
2025-07-26 22:52:03,673 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:03,766 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:03,766 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:52:04,934 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:04,936 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 133.0, 'command_id': 'flow_50.0_agv2_load_rawmat_prod_3_8e711d58', 'response': 'Product with id prod_3_8e711d58 not found in warehouse buffer.'}
2025-07-26 22:52:04,937 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv2_load_rawmat_prod_3_8e711d58 response: Product with id prod_3_8e711d58 not found in warehouse buffer.
2025-07-26 22:52:05,374 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:05,386 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 135.6, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.25, 'first_pass_rate': 100.0, 'total_production_cost': 218.14, 'material_costs': 135.0, 'energy_costs': 83.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.95, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:05,386 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 135.6, 'order_completion_rate': 0.0, 'average_production_cycle': 7.37, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.25, 'first_pass_rate': 100.0, 'total_production_cost': 218.14, 'material_costs': 135.0, 'energy_costs': 83.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.95, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 2, 'active_faults': 0}
2025-07-26 22:52:05,723 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 135.7, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.72, 'first_pass_rate': 100.0, 'total_production_cost': 219.14, 'material_costs': 135.0, 'energy_costs': 84.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.93, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:05,940 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 135.7, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.72, 'first_pass_rate': 100.0, 'total_production_cost': 219.14, 'material_costs': 135.0, 'energy_costs': 84.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.93, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,128 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:07,424 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 137.3, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.81, 'first_pass_rate': 100.0, 'total_production_cost': 220.14, 'material_costs': 135.0, 'energy_costs': 85.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.5, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,424 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 137.3, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.81, 'first_pass_rate': 100.0, 'total_production_cost': 220.14, 'material_costs': 135.0, 'energy_costs': 85.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.9, 'agv_utilization': 35.5, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,425 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 137.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.79, 'first_pass_rate': 100.0, 'total_production_cost': 220.14, 'material_costs': 135.0, 'energy_costs': 85.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 35.43, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv2_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_2","params":{"product_id":"prod_1_f6d59d66"}}
]

Explanation:
Only AGV_2 is available for a new command: it is idle at P0 (RawMaterial warehouse) and not carrying any load. The next product in the raw material queue is "prod_1_f6d59d66", so AGV_2 should load this material to keep the supply process moving. AGV_1 is in a MOVING state and cannot receive new instructions until it arrives and is idle. Thus, only a single valid command is issued in this step, ensuring the rules and workflow are followed.'
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 597
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv2_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_2","params":{"product_id":"prod_1_f6d59d66"}}
]

Explanation:
Only AGV_2 is available for a new command: it...'
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv2_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_2","params":{"product_id":"prod_1_f6d59d66"}}
]'
2025-07-26 22:52:07,462 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:07,462 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:07,462 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:07,462 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv2_load_rawmat_prod_1_f6d59d66', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_1_f6d59d66'}, 'timestamp': 1753541527.462676}
2025-07-26 22:52:07,462 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv2_load_rawmat_prod_1_f6d59d66 - load for AGV_2
2025-07-26 22:52:07,545 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 137.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.44, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 39.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,564 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:52:07,564 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:52:07,564 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1']
2025-07-26 22:52:07,820 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 137.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.79, 'first_pass_rate': 100.0, 'total_production_cost': 220.14, 'material_costs': 135.0, 'energy_costs': 85.14, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 35.43, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,820 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 137.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.44, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 39.41, 'total_orders': 26, 'completed_orders': 0, 'active_orders': 26, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:07,931 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 137.56022000000002, 'command_id': 'flow_40.0_agv2_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 53.5%'}
2025-07-26 22:52:07,932 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv2_move_p8 response: Successfully arrived at path point P8, remaining battery: 53.5%
2025-07-26 22:52:09,707 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 139.0, 'command_id': 'flow_50.0_agv2_load_rawmat_prod_1_f6d59d66', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_1_495dbb33Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 53.0%'}
2025-07-26 22:52:09,708 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv2_load_rawmat_prod_1_f6d59d66 response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_1_495dbb33Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 53.0%
2025-07-26 22:52:10,759 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_df66b220', 'created_at': 140.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 740.0}
2025-07-26 22:52:10,760 - order - INFO - [order.py:245] - Created order order_df66b220 with 1 products
2025-07-26 22:52:10,760 - order - INFO - [order.py:339] - Assigned 1 products from order order_df66b220 to line1
2025-07-26 22:52:10,760 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_df66b220 with 1 products to line1
2025-07-26 22:52:10,760 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.31, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 38.7, 'total_orders': 27, 'completed_orders': 0, 'active_orders': 27, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:10,774 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_48_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_48_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at P0 and each is carrying one raw material (AGV_1: prod_2_97fc9b53, AGV_2: prod_3_8e711d58). The highest priority is to deliver these payloads. According to the factory workflow, after loading raw materials at P0, the next step is to move the AGV to StationA (P1) before unloading. Thus, both AGVs are issued MOVE commands to P1. This action aligns with the rule that AGVs with payload should deliver them immediately, maximizing material input to the production process. Further actions (such as unloading or loading new materials) will follow after these MOVE commands are completed.'
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 851
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_48_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_48_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_48_agv1_move_to_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}},
  {"command_id":"flow_48_agv2_move_to_p1","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:52:10,776 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:10,776 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:10,776 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:10,776 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_48_agv1_move_to_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541530.776622}
2025-07-26 22:52:10,776 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_48_agv1_move_to_p1 - move for AGV_1
2025-07-26 22:52:10,878 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_48_agv2_move_to_p1', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541530.87786}
2025-07-26 22:52:10,878 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_48_agv2_move_to_p1 - move for AGV_2
2025-07-26 22:52:10,964 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_660acbfb', 'created_at': 140.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 680.0}
2025-07-26 22:52:10,965 - order - INFO - [order.py:245] - Created order order_660acbfb with 2 products
2025-07-26 22:52:10,965 - order - INFO - [order.py:339] - Assigned 2 products from order order_660acbfb to line2
2025-07-26 22:52:10,965 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_660acbfb with 2 products to line2
2025-07-26 22:52:10,965 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 0.0, 'average_production_cycle': 4.35, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.31, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 38.7, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,073 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 0.0, 'average_production_cycle': 4.57, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.27, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 38.7, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,145 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_df66b220', 'created_at': 140.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 740.0}
2025-07-26 22:52:11,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 0.0, 'average_production_cycle': 4.24, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.31, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 38.7, 'total_orders': 27, 'completed_orders': 0, 'active_orders': 27, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,731 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2']
2025-07-26 22:52:11,780 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_660acbfb', 'created_at': 140.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 680.0}
2025-07-26 22:52:11,780 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 0.0, 'average_production_cycle': 4.35, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.31, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 38.7, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,780 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 140.0, 'order_completion_rate': 0.0, 'average_production_cycle': 4.57, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.27, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.96, 'agv_utilization': 38.7, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,780 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.57, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.98, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 38.25, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.57, 'on_time_delivery_rate': 0.0, 'device_utilization': 14.98, 'first_pass_rate': 100.0, 'total_production_cost': 224.05, 'material_costs': 135.0, 'energy_costs': 89.05, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 38.25, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.57, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.6, 'first_pass_rate': 100.0, 'total_production_cost': 227.96, 'material_costs': 135.0, 'energy_costs': 92.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 42.11, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:11,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 141.56022000000002, 'command_id': 'flow_40.0_agv2_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 33.0%'}
2025-07-26 22:52:11,803 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv2_move_p8 response: Successfully arrived at path point P8, remaining battery: 33.0%
2025-07-26 22:52:11,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.7, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.6, 'first_pass_rate': 100.0, 'total_production_cost': 227.96, 'material_costs': 135.0, 'energy_costs': 92.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 42.07, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:11,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.7, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.76, 'first_pass_rate': 100.0, 'total_production_cost': 228.96, 'material_costs': 135.0, 'energy_costs': 93.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 42.07, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:12,538 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.56, 'order_completion_rate': 0.0, 'average_production_cycle': 4.57, 'on_time_delivery_rate': 0.0, 'device_utilization': 15.6, 'first_pass_rate': 100.0, 'total_production_cost': 227.96, 'material_costs': 135.0, 'energy_costs': 92.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 42.11, 'total_orders': 28, 'completed_orders': 0, 'active_orders': 28, 'total_products': 3, 'active_faults': 0}
2025-07-26 22:52:12,610 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:12,763 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.7, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.6, 'first_pass_rate': 100.0, 'total_production_cost': 227.96, 'material_costs': 135.0, 'energy_costs': 92.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 42.07, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:12,763 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 141.7, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.76, 'first_pass_rate': 100.0, 'total_production_cost': 228.96, 'material_costs': 135.0, 'energy_costs': 93.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 42.07, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:12,764 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 142.3, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.93, 'first_pass_rate': 100.0, 'total_production_cost': 229.96, 'material_costs': 135.0, 'energy_costs': 94.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 41.88, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}}
]

Explanation:
AGV_1 is idle and available at P0, with no load. To maintain high-priority raw material flow in response to the new order, it should load the next required item: "prod_1_f6d59d66". AGV_2 is currently in a MOVING state and cannot receive a new command until it is idle again. Therefore, only AGV_1 receives a command in this cycle, ensuring the supply chain remains continuous and production can progress efficiently.'
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 571
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}}
]

Explanation:
AGV_1 is idle and available at P0, with no lo...'
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}}
]'
2025-07-26 22:52:12,807 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:12,807 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:12,807 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:12,808 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv1_load_rawmat_prod_1_f6d59d66', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_f6d59d66'}, 'timestamp': 1753541532.807968}
2025-07-26 22:52:12,808 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv1_load_rawmat_prod_1_f6d59d66 - load for AGV_1
2025-07-26 22:52:12,909 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:12,910 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:12,910 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2']
2025-07-26 22:52:13,114 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:14,110 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[{"command_id":"flow_50_agv1_move_to_p1_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

Explanation:  
Only AGV_1 is available and it currently has a payload (prod_2_97fc9b53) at P0. According to the decision logic, an AGV with payload must deliver it before any new loading actions. Therefore, AGV_1 should be sent to P1 (StationA) to unload this raw material and keep the production line flowing. AGV_2 is busy and cannot receive a command, so only one command is issued for AGV_1.'
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 516
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[{"command_id":"flow_50_agv1_move_to_p1_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]

Explanation:  
Only AGV_1 is available and it currently has a payload (prod_2_9...'
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[{"command_id":"flow_50_agv1_move_to_p1_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P1"}}]'
2025-07-26 22:52:14,112 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:14,113 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:52:14,113 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line3
2025-07-26 22:52:14,113 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50_agv1_move_to_p1_with_payload', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541534.113097}
2025-07-26 22:52:14,113 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50_agv1_move_to_p1_with_payload - move for AGV_1
2025-07-26 22:52:14,126 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 143.0, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.73, 'first_pass_rate': 100.0, 'total_production_cost': 239.96, 'material_costs': 145.0, 'energy_costs': 94.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 41.67, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:14,127 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 143.45, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.7, 'first_pass_rate': 100.0, 'total_production_cost': 239.96, 'material_costs': 145.0, 'energy_costs': 94.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.1, 'agv_utilization': 41.53, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:14,214 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:14,214 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:14,215 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.MOVING, battery: 36.186667192%)
2025-07-26 22:52:14,215 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:14,215 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:52:14,635 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 143.45, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.42, 'first_pass_rate': 100.0, 'total_production_cost': 244.45, 'material_costs': 145.0, 'energy_costs': 99.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.1, 'agv_utilization': 45.44, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:15,351 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 142.3, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.93, 'first_pass_rate': 100.0, 'total_production_cost': 229.96, 'material_costs': 135.0, 'energy_costs': 94.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 41.88, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:15,353 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 143.0, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.73, 'first_pass_rate': 100.0, 'total_production_cost': 239.96, 'material_costs': 145.0, 'energy_costs': 94.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.03, 'agv_utilization': 41.67, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:15,353 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 143.45, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.7, 'first_pass_rate': 100.0, 'total_production_cost': 239.96, 'material_costs': 145.0, 'energy_costs': 94.96, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.1, 'agv_utilization': 41.53, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:15,354 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 143.45, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.42, 'first_pass_rate': 100.0, 'total_production_cost': 244.45, 'material_costs': 145.0, 'energy_costs': 99.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.1, 'agv_utilization': 45.44, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:15,354 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 143.45022, 'command_id': 'flow_40.0_agv1_move_p9', 'response': 'Successfully arrived at path point P9, remaining battery: 25.0%'}
2025-07-26 22:52:15,354 - src.line_commander - INFO - [line_commander.py:278] - Command flow_40.0_agv1_move_p9 response: Successfully arrived at path point P9, remaining battery: 25.0%
2025-07-26 22:52:15,355 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 144.0, 'command_id': 'flow_50.0_agv1_load_rawmat_prod_1_f6d59d66', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_f6d59d66Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 24.5%'}
2025-07-26 22:52:15,355 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv1_load_rawmat_prod_1_f6d59d66 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_f6d59d66Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 24.5%
2025-07-26 22:52:15,817 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:16,363 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}},
  {"command_id":"flow_50.0_agv2_load_finished_products_p8","action":"load","target":"AGV_2","params":{}}
]

Explanation:
- AGV_1 is idle at P0 (RawMaterial warehouse) without payload, so it should load the next raw material in the queue, which is "prod_1_f6d59d66", to ensure a continuous feed for production.
- AGV_2 is at P8 (QualityCheck output) and already loaded with one finished product. Per the critical flow, when an AGV with a payload is at P8 and more finished products are available, it should load more before delivery. Thus, AGV_2 is commanded to load additional finished products at P8.

This sequence maximizes both raw and finished product flow before initiating delivery or further movement, efficiently utilizing both available AGVs.'
2025-07-26 22:52:16,363 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:16,364 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 892
2025-07-26 22:52:16,364 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}},
  {"command_id":"flow_50.0_agv2_load_finished_products_p8","...'
2025-07-26 22:52:16,364 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:16,364 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}},
  {"command_id":"flow_50.0_agv2_load_finished_products_p8","action":"load","target":"AGV_2","params":{}}
]'
2025-07-26 22:52:16,364 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:16,364 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:52:16,364 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:52:16,364 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv1_load_rawmat_prod_1_f6d59d66', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_f6d59d66'}, 'timestamp': 1753541536.36446}
2025-07-26 22:52:16,364 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv1_load_rawmat_prod_1_f6d59d66 - load for AGV_1
2025-07-26 22:52:16,460 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.21, 'first_pass_rate': 100.0, 'total_production_cost': 244.45, 'material_costs': 145.0, 'energy_costs': 99.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.17, 'agv_utilization': 44.33, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:16,463 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:16,465 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv2_load_finished_products_p8', 'action': 'load', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541536.464948}
2025-07-26 22:52:16,465 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv2_load_finished_products_p8 - load for AGV_2
2025-07-26 22:52:16,569 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.4, 'first_pass_rate': 100.0, 'total_production_cost': 245.64, 'material_costs': 145.0, 'energy_costs': 100.64, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.17, 'agv_utilization': 45.34, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:16,569 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 146.91666651, 'command_id': 'flow_48_agv1_move_to_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 34.5%'}
2025-07-26 22:52:16,569 - src.line_commander - INFO - [line_commander.py:278] - Command flow_48_agv1_move_to_p1 response: Successfully arrived at path point P1, remaining battery: 34.5%
2025-07-26 22:52:16,734 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.21, 'first_pass_rate': 100.0, 'total_production_cost': 244.45, 'material_costs': 145.0, 'energy_costs': 99.45, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.17, 'agv_utilization': 44.33, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:16,734 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 146.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.4, 'first_pass_rate': 100.0, 'total_production_cost': 245.64, 'material_costs': 145.0, 'energy_costs': 100.64, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.17, 'agv_utilization': 45.34, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:16,735 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}},
  {"command_id":"flow_50.0_agv2_load_finished_p8","action":"load","target":"AGV_2","params":{}}
]

Explanation:
- AGV_1 is idle at P0 with no payload. According to the priority logic and the raw materials queue, AGV_1 should load the next raw material for processing, which is "prod_1_f6d59d66".
- AGV_2 is idle at P8 (QualityCheck output) and already carrying a finished product. Since finished products remain at P8 (products(1)), it should attempt to load additional finished products (if available in the buffer) before departing for the warehouse. This ensures maximum efficiency for every AGV trip.

This allocation keeps both AGVs actively advancing high-priority material and finished product flow, leveraging parallel capability per factory workflow best practices.'
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 914
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}},
  {"command_id":"flow_50.0_agv2_load_finished_p8","action":"...'
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv1_load_rawmat_prod_1_f6d59d66","action":"load","target":"AGV_1","params":{"product_id":"prod_1_f6d59d66"}},
  {"command_id":"flow_50.0_agv2_load_finished_p8","action":"load","target":"AGV_2","params":{}}
]'
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:16,737 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:52:16,737 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:52:16,737 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv1_load_rawmat_prod_1_f6d59d66', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_f6d59d66'}, 'timestamp': 1753541536.737496}
2025-07-26 22:52:16,737 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv1_load_rawmat_prod_1_f6d59d66 - load for AGV_1
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:  
Both AGVs are currently in MOVING status and are not available (idle), so no command can be issued at this time. Per the critical rule, commands can only be sent to AGVs that are available and idle. Wait for at least one AGV to become idle before issuing the next instructions (such as payload unloading at P1 or starting finished product delivery from QualityCheck).'
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 386
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:  
Both AGVs are currently in MOVING status and are not available (idle), so no command can be issued at this time. Per the critical rule, commands can only be sent to AGVs that are av...'
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:52:16,737 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:52:16,738 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:52:16,738 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 40, Finished products: 2
2025-07-26 22:52:16,738 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P1, battery 34.50333389%
2025-07-26 22:52:16,738 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.MOVING at P0, battery 36.186667192%
2025-07-26 22:52:16,738 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:52:16,738 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:52:16,738 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.MOVING, battery: 36.186667192%)
2025-07-26 22:52:16,738 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:16,738 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:52:16,838 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv2_load_finished_p8', 'action': 'load', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541536.838075}
2025-07-26 22:52:16,838 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv2_load_finished_p8 - load for AGV_2
2025-07-26 22:52:16,939 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:52:16,939 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:52:16,939 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2']
2025-07-26 22:52:17,456 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 147.0, 'command_id': 'flow_50_agv1_move_to_p1_with_payload', 'response': 'Can not find path from P1 to P1'}
2025-07-26 22:52:17,457 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50_agv1_move_to_p1_with_payload response: Can not find path from P1 to P1
2025-07-26 22:52:17,457 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.4, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.53, 'first_pass_rate': 100.0, 'total_production_cost': 246.64, 'material_costs': 145.0, 'energy_costs': 101.64, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.17, 'agv_utilization': 45.18, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:17,562 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.5, 'first_pass_rate': 100.0, 'total_production_cost': 246.64, 'material_costs': 145.0, 'energy_costs': 101.64, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.02, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:17,563 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.68, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 46.02, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:17,588 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 147.0, 'command_id': 'flow_50.0_agv1_load_rawmat_prod_1_f6d59d66', 'response': '‰∏çÊîØÊåÅÁöÑËÆæÂ§áÁ±ªÂûã: Warehouse'}
2025-07-26 22:52:17,588 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv1_load_rawmat_prod_1_f6d59d66 response: ‰∏çÊîØÊåÅÁöÑËÆæÂ§áÁ±ªÂûã: Warehouse
2025-07-26 22:52:17,589 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 147.0, 'command_id': 'flow_50.0_agv1_load_rawmat_prod_1_f6d59d66', 'response': '‰∏çÊîØÊåÅÁöÑËÆæÂ§áÁ±ªÂûã: Warehouse'}
2025-07-26 22:52:17,589 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv1_load_rawmat_prod_1_f6d59d66 response: ‰∏çÊîØÊåÅÁöÑËÆæÂ§áÁ±ªÂûã: Warehouse
2025-07-26 22:52:17,589 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.4, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.53, 'first_pass_rate': 100.0, 'total_production_cost': 246.64, 'material_costs': 145.0, 'energy_costs': 101.64, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.17, 'agv_utilization': 45.18, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:17,783 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.5, 'first_pass_rate': 100.0, 'total_production_cost': 246.64, 'material_costs': 145.0, 'energy_costs': 101.64, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.02, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:17,783 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 147.92, 'order_completion_rate': 3.57, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.68, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 46.02, 'total_orders': 28, 'completed_orders': 1, 'active_orders': 27, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:18,011 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 147.91666651, 'command_id': 'flow_48_agv2_move_to_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 34.5%'}
2025-07-26 22:52:18,011 - src.line_commander - INFO - [line_commander.py:278] - Command flow_48_agv2_move_to_p1 response: Successfully arrived at path point P1, remaining battery: 34.5%
2025-07-26 22:52:18,967 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 148.0, 'command_id': 'flow_50.0_agv2_load_finished_products_p8', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_de59ee53Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 32.5%'}
2025-07-26 22:52:18,967 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv2_load_finished_products_p8 response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_de59ee53Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 32.5%
2025-07-26 22:52:18,979 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:18,980 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:52:19,881 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[{"command_id":"flow_50_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at P1 (StationA) with one payload (prod_2_97fc9b53). According to the logic, when an AGV is at the unloading destination with payload, the immediate next action is to unload. AGV_2 is still moving and not available for a command. Thus, only one unload command is issued for AGV_1 at P1 to keep the material flow continuous and clear AGV_1 for its next operation.'
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 484
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[{"command_id":"flow_50_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is idle at P1 (StationA) with one payload (prod_2_97fc9b53). According to the logic, w...'
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[{"command_id":"flow_50_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}}]'
2025-07-26 22:52:20,000 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:20,000 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:52:20,001 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line3
2025-07-26 22:52:20,001 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50_agv1_unload_at_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541540.001106}
2025-07-26 22:52:20,001 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50_agv1_unload_at_p1 - unload for AGV_1
2025-07-26 22:52:20,103 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:20,103 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:20,103 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:20,104 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:52:20,727 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c94b85ab', 'created_at': 150.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 550.0}
2025-07-26 22:52:20,728 - order - INFO - [order.py:245] - Created order order_c94b85ab with 1 products
2025-07-26 22:52:20,728 - order - INFO - [order.py:339] - Assigned 1 products from order order_c94b85ab to line3
2025-07-26 22:52:20,728 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_c94b85ab with 1 products to line3
2025-07-26 22:52:20,729 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 3.45, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.56, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.36, 'total_orders': 29, 'completed_orders': 1, 'active_orders': 28, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:20,733 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:20,951 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_c94b85ab', 'created_at': 150.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 550.0}
2025-07-26 22:52:20,951 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 3.45, 'average_production_cycle': 3.17, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.56, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.36, 'total_orders': 29, 'completed_orders': 1, 'active_orders': 28, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:21,039 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_50.0_agv2_load_finished_p8","action":"load","target":"AGV_2","params":{}}
]

Explanation:
- AGV_1 is idle at P9 (Warehouse) and has no payload. To maintain the flow of raw materials for new and pending orders, AGV_1 should return to the RawMaterial warehouse (P0) to be ready to load the next item, which is "prod_1_d1797ee3."
- AGV_2 is at P8 (QualityCheck output) and already loaded with one finished product. There is still one more finished product at P8. Per CRITICAL FLOW, AGV_2 should first attempt to load additional finished products at P8 before departing for delivery, maximizing delivery efficiency.

This ensures both AGVs are utilized for the highest-priority and most efficient workflow: one moving to start a new supply of raw material and the other maximizing finished goods consolidation before warehouse delivery.'
2025-07-26 22:52:21,039 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:21,039 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 963
2025-07-26 22:52:21,039 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_50.0_agv2_load_finished_p8","action":"load","target":"AGV_2","params"...'
2025-07-26 22:52:21,039 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:21,040 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_50.0_agv2_load_finished_p8","action":"load","target":"AGV_2","params":{}}
]'
2025-07-26 22:52:21,040 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:21,040 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:52:21,040 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:52:21,040 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541541.04054}
2025-07-26 22:52:21,040 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv1_move_p0 - move for AGV_1
2025-07-26 22:52:21,142 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv2_load_finished_p8', 'action': 'load', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541541.142064}
2025-07-26 22:52:21,142 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv2_load_finished_p8 - load for AGV_2
2025-07-26 22:52:21,244 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:21,245 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:21,245 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2']
2025-07-26 22:52:21,977 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_fa57bbc5', 'created_at': 150.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1710.0}
2025-07-26 22:52:21,977 - order - INFO - [order.py:245] - Created order order_fa57bbc5 with 3 products
2025-07-26 22:52:21,978 - order - INFO - [order.py:339] - Assigned 3 products from order order_fa57bbc5 to line1
2025-07-26 22:52:21,978 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_fa57bbc5 with 3 products to line1
2025-07-26 22:52:21,978 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 3.33, 'average_production_cycle': 3.24, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.56, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.36, 'total_orders': 30, 'completed_orders': 1, 'active_orders': 29, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:21,979 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 3.33, 'average_production_cycle': 3.4, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.53, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.36, 'total_orders': 30, 'completed_orders': 1, 'active_orders': 29, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:22,590 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:22,612 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 152.0, 'command_id': 'flow_50.0_agv2_load_finished_p8', 'response': 'Can not load. AGV AGV_2 is not available or payload is full.'}
2025-07-26 22:52:22,613 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv2_load_finished_p8 response: Can not load. AGV AGV_2 is not available or payload is full.
2025-07-26 22:52:22,717 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.4, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.2, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 44.62, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:22,717 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.4, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.39, 'first_pass_rate': 100.0, 'total_production_cost': 248.82, 'material_costs': 145.0, 'energy_costs': 103.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 44.62, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:22,811 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.65, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.24, 'first_pass_rate': 100.0, 'total_production_cost': 248.82, 'material_costs': 145.0, 'energy_costs': 103.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.54, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:22,812 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.65, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.74, 'first_pass_rate': 100.0, 'total_production_cost': 252.15, 'material_costs': 145.0, 'energy_costs': 107.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 47.56, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:22,812 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 152.65022, 'command_id': 'flow_44.0_agv2_move_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 15.3%'}
2025-07-26 22:52:22,812 - src.line_commander - INFO - [line_commander.py:278] - Command flow_44.0_agv2_move_p8 response: Successfully arrived at path point P8, remaining battery: 15.3%
2025-07-26 22:52:23,341 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:23,560 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_fa57bbc5', 'created_at': 150.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1710.0}
2025-07-26 22:52:23,560 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 3.33, 'average_production_cycle': 3.24, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.56, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.36, 'total_orders': 30, 'completed_orders': 1, 'active_orders': 29, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:23,561 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 150.0, 'order_completion_rate': 3.33, 'average_production_cycle': 3.4, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.53, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 45.36, 'total_orders': 30, 'completed_orders': 1, 'active_orders': 29, 'total_products': 4, 'active_faults': 0}
2025-07-26 22:52:23,663 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.4, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.2, 'first_pass_rate': 100.0, 'total_production_cost': 247.82, 'material_costs': 145.0, 'energy_costs': 102.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 44.62, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:23,663 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.4, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.39, 'first_pass_rate': 100.0, 'total_production_cost': 248.82, 'material_costs': 145.0, 'energy_costs': 103.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.23, 'agv_utilization': 44.62, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:23,773 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.65, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.24, 'first_pass_rate': 100.0, 'total_production_cost': 248.82, 'material_costs': 145.0, 'energy_costs': 103.82, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.54, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:23,774 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 152.65, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.74, 'first_pass_rate': 100.0, 'total_production_cost': 252.15, 'material_costs': 145.0, 'energy_costs': 107.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 47.56, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:24,073 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 153.0, 'command_id': 'flow_50_agv1_unload_at_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_97fc9b53Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 34.0%'}
2025-07-26 22:52:24,074 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50_agv1_unload_at_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_97fc9b53Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 34.0%
2025-07-26 22:52:24,077 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_50_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGVs are idle at P1 (StationA) and each has one payload to deliver (AGV_1: prod_2_97fc9b53; AGV_2: prod_3_8e711d58). According to the decision logic, an AGV carrying payload at its designated unloading station must immediately unload before any further production tasks are issued‚Äîincluding delivery of finished products, further raw material loads, or P3 second pass handling. This ensures the production line continuously processes input materials and prevents AGV congestion at P1. Each AGV receives an unload command at P1 as the critical next step.'
2025-07-26 22:52:24,077 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:24,077 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 763
2025-07-26 22:52:24,077 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_50_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanatio...'
2025-07-26 22:52:24,077 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:24,078 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_50_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:52:24,078 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:24,078 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:24,078 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:24,078 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50_agv1_unload_at_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541544.078155}
2025-07-26 22:52:24,078 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50_agv1_unload_at_p1 - unload for AGV_1
2025-07-26 22:52:24,105 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:24,180 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50_agv2_unload_at_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541544.180039}
2025-07-26 22:52:24,181 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50_agv2_unload_at_p1 - unload for AGV_2
2025-07-26 22:52:24,283 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:52:24,283 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:52:24,283 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:24,284 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2']
2025-07-26 22:52:24,566 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:52:24,707 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_51_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_51_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at StationA (P1) and each has one piece of raw material, so the highest priority is to unload. According to the critical flow and sequence, AGVs with payload at their destination must unload before taking on new tasks or handling additional products. This keeps the line flowing and ensures maximum throughput. Once empty and available, AGVs can then be assigned to continued raw material delivery, P3 second pass, or finished product handling as needed.'
2025-07-26 22:52:24,707 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:24,707 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 689
2025-07-26 22:52:24,708 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_51_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_51_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanatio...'
2025-07-26 22:52:24,708 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:24,708 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_51_agv1_unload_at_p1","action":"unload","target":"AGV_1","params":{}},
  {"command_id":"flow_51_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:52:24,708 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:24,708 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:24,708 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:24,708 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv1_unload_at_p1', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541544.708229}
2025-07-26 22:52:24,708 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv1_unload_at_p1 - unload for AGV_1
2025-07-26 22:52:24,808 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv2_unload_at_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541544.80864}
2025-07-26 22:52:24,808 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv2_unload_at_p1 - unload for AGV_2
2025-07-26 22:52:25,275 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:25,646 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 155.0, 'command_id': 'flow_50_agv1_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:52:25,647 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50_agv1_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:52:25,703 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:26,694 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 155.0, 'command_id': 'flow_51_agv1_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:52:26,695 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv1_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:52:26,695 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 155.0, 'command_id': 'flow_51_agv2_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:52:26,695 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv2_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:52:27,220 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 156.0, 'command_id': 'flow_50_agv2_unload_at_p1', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_3_8e711d58Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 34.0%'}
2025-07-26 22:52:27,221 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50_agv2_unload_at_p1 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_3_8e711d58Âç∏ËΩΩÂà∞StationAÔºåÂâ©‰ΩôÁîµÈáè: 34.0%
2025-07-26 22:52:27,526 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 157.1, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.69, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 46.16, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:27,743 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 157.1, 'order_completion_rate': 6.67, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.69, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 46.16, 'total_orders': 30, 'completed_orders': 2, 'active_orders': 28, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:27,744 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:30,367 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:30,371 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_50.0_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]

Explanation:
AGV_2 is idle at P8 with a battery level of 15.31%, which is below the 20% emergency threshold. According to the decision logic, the emergency charging action (battery < 20%) takes absolute priority over all other operations. Therefore, AGV_2 is immediately instructed to begin charging up to 80%. AGV_1 is currently moving and cannot receive a new command until it completes its current action. Thus, only one command (for AGV_2 to charge) is issued in this cycle, ensuring safe and reliable AGV operation.'
2025-07-26 22:52:30,372 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:30,372 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 634
2025-07-26 22:52:30,372 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_50.0_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]

Explanation:
AGV_2 is idle at P8 with a battery level of 15.31%, which is below the 20...'
2025-07-26 22:52:30,372 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:30,372 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_50.0_agv2_charge_80","action":"charge","target":"AGV_2","params":{"target_level": 80}}
]'
2025-07-26 22:52:30,372 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:30,372 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:30,372 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:30,373 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_50.0_agv2_charge_80', 'action': 'charge', 'target': 'AGV_2', 'params': {'target_level': 80}, 'timestamp': 1753541550.373019}
2025-07-26 22:52:30,373 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_50.0_agv2_charge_80 - charge for AGV_2
2025-07-26 22:52:30,455 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:30,542 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_fef801fb', 'created_at': 160.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1720.0}
2025-07-26 22:52:30,543 - order - INFO - [order.py:245] - Created order order_fef801fb with 3 products
2025-07-26 22:52:30,543 - order - INFO - [order.py:339] - Assigned 3 products from order order_fef801fb to line2
2025-07-26 22:52:30,543 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_fef801fb with 3 products to line2
2025-07-26 22:52:30,656 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_51_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
AGV_2 is idle at P1 and still carrying a payload (prod_3_8e711d58). Per the decision logic and flow rules, any AGV at its station with a payload must first unload before any further assignment (finished product delivery, new raw material loads, or P3 logic). AGV_1 is already empty and ready for further assignment. Thus, AGV_2 receives the unload command at P1, allowing it to proceed to the next operation.'
2025-07-26 22:52:30,656 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:30,656 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 520
2025-07-26 22:52:30,656 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_51_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]

Explanation:  
AGV_2 is idle at P1 and still carrying a payload (prod_3_8e711d58). Per the decision log...'
2025-07-26 22:52:30,656 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:30,656 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_51_agv2_unload_at_p1","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:52:30,657 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:30,657 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:52:30,657 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line3
2025-07-26 22:52:30,657 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv2_unload_at_p1', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541550.657171}
2025-07-26 22:52:30,657 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv2_unload_at_p1 - unload for AGV_2
2025-07-26 22:52:30,758 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:30,758 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:30,758 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:30,758 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2']
2025-07-26 22:52:30,889 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_fef801fb', 'created_at': 160.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1720.0}
2025-07-26 22:52:30,889 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.45, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.22, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 45.29, 'total_orders': 31, 'completed_orders': 2, 'active_orders': 29, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:30,889 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3cd704c2', 'created_at': 160.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1240.0}
2025-07-26 22:52:30,889 - order - INFO - [order.py:245] - Created order order_3cd704c2 with 2 products
2025-07-26 22:52:30,889 - order - INFO - [order.py:339] - Assigned 2 products from order order_3cd704c2 to line3
2025-07-26 22:52:30,889 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_3cd704c2 with 2 products to line3
2025-07-26 22:52:31,005 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 3.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.22, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 45.29, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:31,005 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.19, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 45.29, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:31,143 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.45, 'average_production_cycle': 2.88, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.22, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 45.29, 'total_orders': 31, 'completed_orders': 2, 'active_orders': 29, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:31,259 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_3cd704c2', 'created_at': 160.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1240.0}
2025-07-26 22:52:31,260 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 3.0, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.22, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 45.29, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:31,531 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 161.36, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.95, 'first_pass_rate': 100.0, 'total_production_cost': 261.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.9, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:31,635 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 160.0, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.19, 'first_pass_rate': 100.0, 'total_production_cost': 253.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 0.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 45.29, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:31,636 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 161.0, 'command_id': 'flow_51_agv2_unload_at_p1', 'response': 'AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ'}
2025-07-26 22:52:31,636 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv2_unload_at_p1 response: AGVË¥ßÁâ©‰∏∫Á©∫ÔºåÊó†Ê≥ïÂç∏ËΩΩ
2025-07-26 22:52:31,750 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 161.36060675126137, 'device_id': 'StationC', 'alert_type': 'fault_injected', 'symptom': 'Station Vibration', 'fault_type': 'station_fault', 'estimated_duration': 38.06046904725413, 'message': 'Device StationC has fault: Station Vibration'}
2025-07-26 22:52:31,751 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 161.36, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.95, 'first_pass_rate': 100.0, 'total_production_cost': 261.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.9, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:52:32,910 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:32,911 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2']
2025-07-26 22:52:33,025 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 162.0, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.92, 'first_pass_rate': 100.0, 'total_production_cost': 261.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.71, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:33,025 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 162.1, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.06, 'first_pass_rate': 100.0, 'total_production_cost': 262.15, 'material_costs': 145.0, 'energy_costs': 109.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.69, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:33,025 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 162.2, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.17, 'first_pass_rate': 100.0, 'total_production_cost': 263.15, 'material_costs': 145.0, 'energy_costs': 110.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.66, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:33,238 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:34,564 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_51.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_51.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:
- AGV_1 is idle at P9 (Warehouse) and empty. It should return to P0 (RawMaterial warehouse) to load the next required raw material ("prod_1_d1797ee3") to keep the supply chain moving.
- AGV_2 is at P8 (QualityCheck output), loaded with two finished products. According to the CRITICAL FLOW, as soon as AGV_2 has finished loading at P8 and is not yet at P9, it must move to P9 (Warehouse) to deliver those finished products.

This instruction set ensures continuous raw material intake and prompt delivery of finished goods, maximizing the efficiency of both AGVs in alignment with production priorities.'
2025-07-26 22:52:34,564 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:34,564 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 834
2025-07-26 22:52:34,564 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_51.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_51.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target...'
2025-07-26 22:52:34,564 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:34,564 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_51.0_agv1_move_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_51.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:52:34,565 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:34,565 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:52:34,565 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:52:34,565 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51.0_agv1_move_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541554.56535}
2025-07-26 22:52:34,565 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51.0_agv1_move_p0 - move for AGV_1
2025-07-26 22:52:34,667 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51.0_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541554.667102}
2025-07-26 22:52:34,668 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51.0_agv2_move_p9 - move for AGV_2
2025-07-26 22:52:34,769 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:34,770 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:34,770 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:52:35,208 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 162.0, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.92, 'first_pass_rate': 100.0, 'total_production_cost': 261.15, 'material_costs': 145.0, 'energy_costs': 108.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.71, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:35,444 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 162.1, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.06, 'first_pass_rate': 100.0, 'total_production_cost': 262.15, 'material_costs': 145.0, 'energy_costs': 109.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.69, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:35,889 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 162.2, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.17, 'first_pass_rate': 100.0, 'total_production_cost': 263.15, 'material_costs': 145.0, 'energy_costs': 110.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 44.66, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:36,694 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:37,547 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 167.2, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.06, 'first_pass_rate': 100.0, 'total_production_cost': 264.15, 'material_costs': 145.0, 'energy_costs': 111.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 43.27, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:37,547 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 167.2, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.06, 'first_pass_rate': 100.0, 'total_production_cost': 264.15, 'material_costs': 145.0, 'energy_costs': 111.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 43.27, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:37,548 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:37,548 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 167.2, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.25, 'first_pass_rate': 100.0, 'total_production_cost': 265.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 43.27, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:37,704 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 167.2, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.25, 'first_pass_rate': 100.0, 'total_production_cost': 265.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 8.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 43.27, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:37,810 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:37,814 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_51_agv1_move_to_p0", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}},
  {"command_id":"flow_51_agv2_move_to_p0", "action":"move", "target":"AGV_2", "params":{"target_point":"P0"}}
]

Explanation:  
Both AGV_1 and AGV_2 are currently idle at P1 and have no payload. The highest remaining priority (with no urgent finished product or P3 buffer actions) is to continue raw material supply. The AGVs must be at P0 to load the next available items. Therefore, both are directed to move to P0 (RawMaterial warehouse) to ensure continuous supply for new production orders as soon as possible. This prepares both AGVs for subsequent load commands and keeps the production line supplied.'
2025-07-26 22:52:37,815 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:37,815 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 721
2025-07-26 22:52:37,815 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_51_agv1_move_to_p0", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}},
  {"command_id":"flow_51_agv2_move_to_p0", "action":"move", "target":"AGV_2", "params":...'
2025-07-26 22:52:37,815 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:37,815 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_51_agv1_move_to_p0", "action":"move", "target":"AGV_1", "params":{"target_point":"P0"}},
  {"command_id":"flow_51_agv2_move_to_p0", "action":"move", "target":"AGV_2", "params":{"target_point":"P0"}}
]'
2025-07-26 22:52:37,815 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:37,815 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:37,815 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:37,816 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv1_move_to_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541557.815873}
2025-07-26 22:52:37,816 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv1_move_to_p0 - move for AGV_1
2025-07-26 22:52:37,918 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv2_move_to_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541557.917974}
2025-07-26 22:52:37,919 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv2_move_to_p0 - move for AGV_2
2025-07-26 22:52:38,020 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:38,020 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:38,020 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:38,021 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2']
2025-07-26 22:52:38,229 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:38,231 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_52_agv1_move_to_p8","action":"move","target":"AGV_1","params":{"target_point":"P8"}},
  {"command_id":"flow_52_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]

Explanation:  
Both AGVs are idle at P1 (StationA) and have no payload. The highest priority action is to handle finished products in QualityCheck. The next step in the command sequence is for AGVs to move to P8 (QualityCheck output) to pick up finished products for delivery to the warehouse. Sending both AGVs at once maximizes throughput, as there are two finished products ready for delivery and two AGVs available to move them efficiently. Only movement commands are issued now; loading occurs after arrival at P8.'
2025-07-26 22:52:38,231 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:38,231 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 739
2025-07-26 22:52:38,231 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_52_agv1_move_to_p8","action":"move","target":"AGV_1","params":{"target_point":"P8"}},
  {"command_id":"flow_52_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:52:38,231 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:38,232 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_52_agv1_move_to_p8","action":"move","target":"AGV_1","params":{"target_point":"P8"}},
  {"command_id":"flow_52_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]'
2025-07-26 22:52:38,232 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:38,232 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:38,232 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:38,232 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_52_agv1_move_to_p8', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P8'}, 'timestamp': 1753541558.232162}
2025-07-26 22:52:38,232 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_52_agv1_move_to_p8 - move for AGV_1
2025-07-26 22:52:38,333 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_52_agv2_move_to_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753541558.333467}
2025-07-26 22:52:38,333 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_52_agv2_move_to_p8 - move for AGV_2
2025-07-26 22:52:38,475 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1']
2025-07-26 22:52:38,837 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:39,802 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 169.44, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.87, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.68, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:39,803 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 169.44, 'order_completion_rate': 6.25, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.87, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.68, 'total_orders': 32, 'completed_orders': 2, 'active_orders': 30, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:40,957 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_9333644a', 'created_at': 170.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 570.0}
2025-07-26 22:52:40,957 - order - INFO - [order.py:245] - Created order order_9333644a with 1 products
2025-07-26 22:52:40,957 - order - INFO - [order.py:339] - Assigned 1 products from order order_9333644a to line1
2025-07-26 22:52:40,957 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_9333644a with 1 products to line1
2025-07-26 22:52:40,958 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 6.06, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.85, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 33, 'completed_orders': 2, 'active_orders': 31, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:40,958 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e26df78c', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 650.0}
2025-07-26 22:52:40,958 - order - INFO - [order.py:245] - Created order order_e26df78c with 1 products
2025-07-26 22:52:40,958 - order - INFO - [order.py:339] - Assigned 1 products from order order_e26df78c to line2
2025-07-26 22:52:40,958 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_e26df78c with 1 products to line2
2025-07-26 22:52:40,958 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 3.19, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.85, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:41,082 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_9333644a', 'created_at': 170.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 570.0}
2025-07-26 22:52:41,082 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 6.06, 'average_production_cycle': 3.13, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.85, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 33, 'completed_orders': 2, 'active_orders': 31, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:41,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.82, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:41,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.66, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.62, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.37, 'agv_utilization': 42.36, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.88, 'first_pass_rate': 100.0, 'total_production_cost': 275.09, 'material_costs': 145.0, 'energy_costs': 114.09, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.37, 'agv_utilization': 43.91, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,639 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_e26df78c', 'created_at': 170.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 650.0}
2025-07-26 22:52:41,640 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 3.19, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.85, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:41,640 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.82, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:52:41,640 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.0, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.66, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.3, 'agv_utilization': 42.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,729 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:41,743 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.62, 'first_pass_rate': 100.0, 'total_production_cost': 273.15, 'material_costs': 145.0, 'energy_costs': 112.15, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.37, 'agv_utilization': 42.36, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,743 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 170.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.88, 'first_pass_rate': 100.0, 'total_production_cost': 275.09, 'material_costs': 145.0, 'energy_costs': 114.09, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.37, 'agv_utilization': 43.91, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,743 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 171.54, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.84, 'first_pass_rate': 100.0, 'total_production_cost': 275.09, 'material_costs': 145.0, 'energy_costs': 114.09, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 43.69, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:41,902 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
No commands are issued this cycle because both AGV_1 and AGV_2 are currently in a MOVING state. Commands can only be sent to AGVs that are idle and available. AGV_2 still needs to be charged after it is next idle (battery < 20%), but per rules, no new instructions can be sent while it is moving. The system will generate the next commands as soon as either AGV is idle.'
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 387
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
No commands are issued this cycle because both AGV_1 and AGV_2 are currently in a MOVING state. Commands can only be sent to AGVs that are idle and available. AGV_2 still needs to be ...'
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 49, Finished products: 0
2025-07-26 22:52:41,903 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.MOVING at P9, battery 24.463289983999996%
2025-07-26 22:52:41,904 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.MOVING at P10, battery 5.612453489999998%
2025-07-26 22:52:42,175 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 171.54, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.36, 'first_pass_rate': 100.0, 'total_production_cost': 279.0, 'material_costs': 145.0, 'energy_costs': 118.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 46.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,014 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 171.54, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 15.84, 'first_pass_rate': 100.0, 'total_production_cost': 275.09, 'material_costs': 145.0, 'energy_costs': 114.09, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 43.69, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,170 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:43,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 171.54, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.36, 'first_pass_rate': 100.0, 'total_production_cost': 279.0, 'material_costs': 145.0, 'energy_costs': 118.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 46.54, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,608 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 171.54022, 'command_id': 'flow_50.0_agv1_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 20.1%'}
2025-07-26 22:52:43,608 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv1_move_p0 response: Successfully arrived at path point P0, remaining battery: 20.1%
2025-07-26 22:52:43,608 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 172.2, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.46, 'first_pass_rate': 100.0, 'total_production_cost': 280.0, 'material_costs': 145.0, 'energy_costs': 119.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 46.35, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,608 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 172.3, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.57, 'first_pass_rate': 100.0, 'total_production_cost': 281.0, 'material_costs': 145.0, 'energy_costs': 120.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 46.32, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,701 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.48, 'first_pass_rate': 100.0, 'total_production_cost': 281.0, 'material_costs': 145.0, 'energy_costs': 120.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.51, 'agv_utilization': 45.88, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,702 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.64, 'first_pass_rate': 100.0, 'total_production_cost': 282.18, 'material_costs': 145.0, 'energy_costs': 121.18, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.51, 'agv_utilization': 46.73, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_51_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_51_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]

Explanation:  
Both AGV_1 and AGV_2 are available, idle, and empty at P1 (StationA). Since there are new raw materials ready at P0 and neither AGV has a higher-priority finished product or P3 buffer task, the optimal action is to send both AGVs to P0 (RawMaterial warehouse) to prepare for loading. This keeps the material flow constant and allows both AGVs to be ready for load, move, and unload cycles.'
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 624
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_51_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_51_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_51_agv1_move_to_p0","action":"move","target":"AGV_1","params":{"target_point":"P0"}},
  {"command_id":"flow_51_agv2_move_to_p0","action":"move","target":"AGV_2","params":{"target_point":"P0"}}
]'
2025-07-26 22:52:43,705 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:43,705 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:43,705 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:43,706 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv1_move_to_p0', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P0'}, 'timestamp': 1753541563.705806}
2025-07-26 22:52:43,706 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv1_move_to_p0 - move for AGV_1
2025-07-26 22:52:43,807 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_51_agv2_move_to_p0', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P0'}, 'timestamp': 1753541563.807223}
2025-07-26 22:52:43,807 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_51_agv2_move_to_p0 - move for AGV_2
2025-07-26 22:52:43,909 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_available (severity: low)
2025-07-26 22:52:43,910 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_available (severity: low)
2025-07-26 22:52:43,910 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.MOVING, battery: 34.00333389%)
2025-07-26 22:52:43,910 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:43,911 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2']
2025-07-26 22:52:43,997 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:44,168 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.64, 'first_pass_rate': 100.0, 'total_production_cost': 282.18, 'material_costs': 145.0, 'energy_costs': 121.18, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.57, 'agv_utilization': 46.73, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:44,168 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.79, 'first_pass_rate': 100.0, 'total_production_cost': 283.37, 'material_costs': 145.0, 'energy_costs': 122.37, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.57, 'agv_utilization': 47.58, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:44,521 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 172.2, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.46, 'first_pass_rate': 100.0, 'total_production_cost': 280.0, 'material_costs': 145.0, 'energy_costs': 119.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 46.35, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:44,522 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 172.3, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.57, 'first_pass_rate': 100.0, 'total_production_cost': 281.0, 'material_costs': 145.0, 'energy_costs': 120.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.44, 'agv_utilization': 46.32, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:44,643 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.48, 'first_pass_rate': 100.0, 'total_production_cost': 281.0, 'material_costs': 145.0, 'energy_costs': 120.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.51, 'agv_utilization': 45.88, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:44,691 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
Both AGV_1 and AGV_2 are currently in a MOVING state (AGV_1 traveling to P9 carrying raw material, AGV_2 traveling to P9 with finished products). According to the command rules, you cannot send a new command to an AGV while it is moving‚Äîcommands can only be issued when an AGV is idle at its destination. Therefore, no new commands can be sent in this cycle. Commands will be generated once either AGV becomes idle and available for its next action.'
2025-07-26 22:52:44,691 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:44,691 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 466
2025-07-26 22:52:44,691 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
Both AGV_1 and AGV_2 are currently in a MOVING state (AGV_1 traveling to P9 carrying raw material, AGV_2 traveling to P9 with finished products). According to the command rules, you c...'
2025-07-26 22:52:44,691 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:44,691 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 49, Finished products: 0
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P0, battery 20.055245983999995%
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.CHARGING at P10, battery 5.112453489999998%
2025-07-26 22:52:44,692 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:44,692 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2']
2025-07-26 22:52:45,242 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.64, 'first_pass_rate': 100.0, 'total_production_cost': 282.18, 'material_costs': 145.0, 'energy_costs': 121.18, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.51, 'agv_utilization': 46.73, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:45,243 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.64, 'first_pass_rate': 100.0, 'total_production_cost': 282.18, 'material_costs': 145.0, 'energy_costs': 121.18, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.57, 'agv_utilization': 46.73, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:45,244 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 173.92, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.79, 'first_pass_rate': 100.0, 'total_production_cost': 283.37, 'material_costs': 145.0, 'energy_costs': 122.37, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.57, 'agv_utilization': 47.58, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:45,244 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 173.91666651, 'command_id': 'flow_51_agv1_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 32.3%'}
2025-07-26 22:52:45,245 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv1_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 32.3%
2025-07-26 22:52:45,245 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 173.91666651, 'command_id': 'flow_51_agv2_move_to_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 32.3%'}
2025-07-26 22:52:45,245 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv2_move_to_p0 response: Successfully arrived at path point P0, remaining battery: 32.3%
2025-07-26 22:52:45,246 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 174.0, 'command_id': 'flow_51_agv1_move_to_p0', 'response': 'Can not find path from P0 to P0'}
2025-07-26 22:52:45,246 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv1_move_to_p0 response: Can not find path from P0 to P0
2025-07-26 22:52:45,254 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:45,679 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 175.0, 'command_id': 'flow_51_agv2_move_to_p0', 'response': 'Can not find path from P0 to P0'}
2025-07-26 22:52:45,681 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 175.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.7, 'first_pass_rate': 100.0, 'total_production_cost': 283.37, 'material_costs': 145.0, 'energy_costs': 122.37, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.08, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:45,681 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51_agv2_move_to_p0 response: Can not find path from P0 to P0
2025-07-26 22:52:45,682 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 175.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.95, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 48.59, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:45,682 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 175.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.7, 'first_pass_rate': 100.0, 'total_production_cost': 283.37, 'material_costs': 145.0, 'energy_costs': 122.37, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.08, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:46,138 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:46,139 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 175.7, 'order_completion_rate': 5.88, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.95, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 48.59, 'total_orders': 34, 'completed_orders': 2, 'active_orders': 32, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:46,435 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:46,436 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2']
2025-07-26 22:52:47,792 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:47,985 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[] 

Explanation:  
Both AGVs are currently in MOVING status (not IDLE), so no new command can be issued. Commands may only be sent to AGVs that are both available and idle. Wait until at least one AGV becomes idle before sending load, move, or unload instructions for raw materials or finished product handling.'
2025-07-26 22:52:47,985 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 312
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[] 

Explanation:  
Both AGVs are currently in MOVING status (not IDLE), so no new command can be issued. Commands may only be sent to AGVs that are both available and idle. Wait until at least one AG...'
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 51, Finished products: 2
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P0, battery 32.320000588%
2025-07-26 22:52:47,986 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P0, battery 32.320000588%
2025-07-26 22:52:47,987 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_available (severity: low)
2025-07-26 22:52:47,987 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_available (severity: low)
2025-07-26 22:52:47,987 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:47,987 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2']
2025-07-26 22:52:48,497 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:48,498 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_53.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is idle at P0 (RawMaterial warehouse), carrying one payload ("prod_1_f6d59d66"). According to the workflow, its next step is to deliver this raw material to StationA (P1) for unloading. Although its battery is close to the critical threshold (20.05%), emergency charging is only triggered if it drops below 20%. AGV_2 is currently busy charging and not available for tasks. Therefore, AGV_1 is assigned a command to move directly to P1 to continue raw material processing. Only one command is issued (one command per available AGV).'
2025-07-26 22:52:48,499 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:48,499 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 662
2025-07-26 22:52:48,499 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_53.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is idle at P0 (RawMaterial warehouse), carrying one payload ("prod_1_f...'
2025-07-26 22:52:48,499 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:48,499 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_53.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]'
2025-07-26 22:52:48,499 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:48,499 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:48,499 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:48,499 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_53.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541568.499274}
2025-07-26 22:52:48,499 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_53.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:52:48,600 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 22:52:48,601 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_loaded_idle (severity: high)
2025-07-26 22:52:48,601 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2']
2025-07-26 22:52:49,905 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2']
2025-07-26 22:52:51,335 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4911922c', 'created_at': 180.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 660.0}
2025-07-26 22:52:51,335 - order - INFO - [order.py:245] - Created order order_4911922c with 1 products
2025-07-26 22:52:51,336 - order - INFO - [order.py:339] - Assigned 1 products from order order_4911922c to line3
2025-07-26 22:52:51,336 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_4911922c with 1 products to line3
2025-07-26 22:52:51,336 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.71, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.74, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.39, 'total_orders': 35, 'completed_orders': 2, 'active_orders': 33, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:51,439 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7d0b2f3a', 'created_at': 180.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 420.0}
2025-07-26 22:52:51,439 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_4911922c', 'created_at': 180.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 660.0}
2025-07-26 22:52:51,440 - order - INFO - [order.py:245] - Created order order_7d0b2f3a with 1 products
2025-07-26 22:52:51,440 - order - INFO - [order.py:339] - Assigned 1 products from order order_7d0b2f3a to line1
2025-07-26 22:52:51,440 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_7d0b2f3a with 1 products to line1
2025-07-26 22:52:51,440 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.32, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.74, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.39, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:51,440 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.71, 'average_production_cycle': 3.25, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.74, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.39, 'total_orders': 35, 'completed_orders': 2, 'active_orders': 33, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:51,441 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.71, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.39, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:51,441 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_7d0b2f3a', 'created_at': 180.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.HIGH: 'high'>, 'deadline': 420.0}
2025-07-26 22:52:51,441 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.32, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.74, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.39, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:51,547 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 180.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.71, 'first_pass_rate': 100.0, 'total_production_cost': 285.31, 'material_costs': 145.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 47.39, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:53,085 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:53,202 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_52_agv1_load_prod_1_d1797ee3","action":"load","target":"AGV_1","params":{"product_id":"prod_1_d1797ee3"}},
  {"command_id":"flow_52_agv2_load_prod_3_fc7fe973","action":"load","target":"AGV_2","params":{"product_id":"prod_3_fc7fe973"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle and available at P0 (RawMaterial warehouse), and there are no higher-priority finished products at P8 requiring handling right now. It is thus optimal to continue supplying the line with fresh raw materials. AGV_1 is assigned to load prod_1_d1797ee3 (P1) and AGV_2 to load prod_3_fc7fe973 (P3) from the buffer. This maintains high throughput and supports pending production orders for both single- and double-pass products. The product IDs are explicitly included as required.'
2025-07-26 22:52:53,203 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:53,203 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 783
2025-07-26 22:52:53,203 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_52_agv1_load_prod_1_d1797ee3","action":"load","target":"AGV_1","params":{"product_id":"prod_1_d1797ee3"}},
  {"command_id":"flow_52_agv2_load_prod_3_fc7fe973","action":"load","...'
2025-07-26 22:52:53,203 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:53,203 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_52_agv1_load_prod_1_d1797ee3","action":"load","target":"AGV_1","params":{"product_id":"prod_1_d1797ee3"}},
  {"command_id":"flow_52_agv2_load_prod_3_fc7fe973","action":"load","target":"AGV_2","params":{"product_id":"prod_3_fc7fe973"}}
]'
2025-07-26 22:52:53,203 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:53,203 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:53,203 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:53,204 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_52_agv1_load_prod_1_d1797ee3', 'action': 'load', 'target': 'AGV_1', 'params': {'product_id': 'prod_1_d1797ee3'}, 'timestamp': 1753541573.203946}
2025-07-26 22:52:53,204 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_52_agv1_load_prod_1_d1797ee3 - load for AGV_1
2025-07-26 22:52:53,305 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_52_agv2_load_prod_3_fc7fe973', 'action': 'load', 'target': 'AGV_2', 'params': {'product_id': 'prod_3_fc7fe973'}, 'timestamp': 1753541573.305399}
2025-07-26 22:52:53,305 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_52_agv2_load_prod_3_fc7fe973 - load for AGV_2
2025-07-26 22:52:53,688 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:53,738 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:53,956 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 183.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.41, 'first_pass_rate': 100.0, 'total_production_cost': 295.31, 'material_costs': 155.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 46.59, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:53,966 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:54,212 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 183.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.41, 'first_pass_rate': 100.0, 'total_production_cost': 295.31, 'material_costs': 155.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 46.59, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:54,212 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_52_agv1_move_to_p8","action":"move","target":"AGV_1","params":{"target_point":"P8"}},
  {"command_id":"flow_52_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle and available at P0, and there are finished products ready in QualityCheck (2 items). According to the decision priority, finished product delivery is the highest priority (after battery and emergencies). Both AGVs should move to P8 (QualityCheck output) to load finished products for delivery. This keeps finished goods flowing, maximizes efficiency, and follows the correct command sequence: MOVE before LOAD.'
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 676
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_52_agv1_move_to_p8","action":"move","target":"AGV_1","params":{"target_point":"P8"}},
  {"command_id":"flow_52_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_52_agv1_move_to_p8","action":"move","target":"AGV_1","params":{"target_point":"P8"}},
  {"command_id":"flow_52_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}
]'
2025-07-26 22:52:54,482 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:52:54,482 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:52:54,482 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:52:54,482 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_52_agv1_move_to_p8', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P8'}, 'timestamp': 1753541574.482823}
2025-07-26 22:52:54,483 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_52_agv1_move_to_p8 - move for AGV_1
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_53.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is idle at P0, loaded with raw material ("prod_1_f6d59d66"). CRITICAL PRIORITY dictates that a loaded, idle AGV must immediately complete delivery. The next step is to move AGV_1 to P1 (StationA) for unloading, since it is not at its unload destination yet. AGV_2 is charging (busy, 0% battery), so AGV_1 is the only one available for assignment. This upholds both the critical loaded AGV rule and proper command sequencing.'
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 554
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_53.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]

Explanation:
AGV_1 is idle at P0, loaded with raw material ("prod_1_f6d59d66"). CRITICAL ...'
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_53.0_agv1_move_p1","action":"move","target":"AGV_1","params":{"target_point":"P1"}}
]'
2025-07-26 22:52:54,483 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:52:54,483 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:52:54,483 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:52:54,483 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_53.0_agv1_move_p1', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P1'}, 'timestamp': 1753541574.483468}
2025-07-26 22:52:54,483 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_53.0_agv1_move_p1 - move for AGV_1
2025-07-26 22:52:54,584 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_52_agv2_move_to_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753541574.584237}
2025-07-26 22:52:54,584 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_52_agv2_move_to_p8 - move for AGV_2
2025-07-26 22:52:54,584 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: agv_loaded_idle (severity: high)
2025-07-26 22:52:54,584 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: agv_loaded_idle (severity: high)
2025-07-26 22:52:54,585 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:52:54,685 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:54,685 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:54,686 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:52:54,686 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:52:54,710 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.37, 'first_pass_rate': 100.0, 'total_production_cost': 315.31, 'material_costs': 175.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 46.32, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:54,710 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.92, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.32, 'first_pass_rate': 100.0, 'total_production_cost': 315.31, 'material_costs': 175.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.71, 'agv_utilization': 46.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:54,742 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.92, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.47, 'first_pass_rate': 100.0, 'total_production_cost': 316.49, 'material_costs': 175.0, 'energy_costs': 125.49, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.71, 'agv_utilization': 46.89, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:54,742 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 184.91666651, 'command_id': 'flow_53.0_agv1_move_p1', 'response': 'Successfully arrived at path point P1, remaining battery: 18.4%'}
2025-07-26 22:52:54,742 - src.line_commander - INFO - [line_commander.py:278] - Command flow_53.0_agv1_move_p1 response: Successfully arrived at path point P1, remaining battery: 18.4%
2025-07-26 22:52:55,150 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.0, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.37, 'first_pass_rate': 100.0, 'total_production_cost': 315.31, 'material_costs': 175.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.64, 'agv_utilization': 46.32, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:55,529 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:55,592 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 184.0, 'command_id': 'flow_52_agv1_load_prod_1_d1797ee3', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_d1797ee3Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 31.8%'}
2025-07-26 22:52:55,592 - src.line_commander - INFO - [line_commander.py:278] - Command flow_52_agv1_load_prod_1_d1797ee3 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_1_d1797ee3Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 31.8%
2025-07-26 22:52:55,592 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.92, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.32, 'first_pass_rate': 100.0, 'total_production_cost': 315.31, 'material_costs': 175.0, 'energy_costs': 124.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.71, 'agv_utilization': 46.09, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:55,593 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 184.92, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.47, 'first_pass_rate': 100.0, 'total_production_cost': 316.49, 'material_costs': 175.0, 'energy_costs': 125.49, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.71, 'agv_utilization': 46.89, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:55,643 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 185.0, 'command_id': 'flow_53.0_agv1_move_p1', 'response': 'Can not find path from P1 to P1'}
2025-07-26 22:52:55,644 - src.line_commander - INFO - [line_commander.py:278] - Command flow_53.0_agv1_move_p1 response: Can not find path from P1 to P1
2025-07-26 22:52:55,644 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 185.54, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.44, 'first_pass_rate': 100.0, 'total_production_cost': 316.49, 'material_costs': 175.0, 'energy_costs': 125.49, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.78, 'agv_utilization': 46.72, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
No commands are issued this cycle because AGV_1 is currently in a MOVING state and cannot accept a new command until it is idle at its destination. AGV_2 is still busy charging (0% battery) and also unavailable for any new instructions. The system will generate commands once an AGV becomes idle and ready for another action.'
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 342
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
No commands are issued this cycle because AGV_1 is currently in a MOVING state and cannot accept a new command until it is idle at its destination. AGV_2 is still busy charging (0% ba...'
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:52:55,673 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:52:55,674 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 51, Finished products: 0
2025-07-26 22:52:55,674 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P1, battery 18.371912681999994%
2025-07-26 22:52:55,674 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.CHARGING at P10, battery 0.0%
2025-07-26 22:52:55,745 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 185.54, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.92, 'first_pass_rate': 100.0, 'total_production_cost': 320.4, 'material_costs': 175.0, 'energy_costs': 129.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.78, 'agv_utilization': 49.36, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:55,745 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 185.54022, 'command_id': 'flow_51.0_agv1_move_p0', 'response': 'Successfully arrived at path point P0, remaining battery: 14.0%'}
2025-07-26 22:52:55,745 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51.0_agv1_move_p0 response: Successfully arrived at path point P0, remaining battery: 14.0%
2025-07-26 22:52:55,846 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 185.0, 'command_id': 'flow_52_agv2_load_prod_3_fc7fe973', 'response': 'Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_fc7fe973Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 31.8%'}
2025-07-26 22:52:55,846 - src.line_commander - INFO - [line_commander.py:278] - Command flow_52_agv2_load_prod_3_fc7fe973 response: Â∑≤‰ªéRawMaterialÂèñÂá∫‰∫ßÂìÅprod_3_fc7fe973Âπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 31.8%
2025-07-26 22:52:55,846 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 185.54, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.44, 'first_pass_rate': 100.0, 'total_production_cost': 316.49, 'material_costs': 175.0, 'energy_costs': 125.49, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.78, 'agv_utilization': 46.72, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:55,846 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 185.54, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.92, 'first_pass_rate': 100.0, 'total_production_cost': 320.4, 'material_costs': 175.0, 'energy_costs': 129.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.78, 'agv_utilization': 49.36, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:56,424 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:57,126 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:52:57,659 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:52:57,775 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
No command is sent in this cycle because AGV_1 is currently in a MOVING state (en route, not idle at P1) and is not eligible to receive a new command until it becomes idle at its destination. AGV_2 is BUSY charging and also unavailable. Commands for completing delivery (unload at P1) will be generated as soon as AGV_1 is next idle at its target location.'
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 373
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
No command is sent in this cycle because AGV_1 is currently in a MOVING state (en route, not idle at P1) and is not eligible to receive a new command until it becomes idle at its dest...'
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 52, Finished products: 0
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.IDLE at P1, battery 18.371912681999994%
2025-07-26 22:52:57,776 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.CHARGING at P10, battery 0.0%
2025-07-26 22:52:57,777 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:52:57,777 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:52:57,777 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:52:57,777 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:52:59,723 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 189.56, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.72, 'first_pass_rate': 100.0, 'total_production_cost': 320.4, 'material_costs': 175.0, 'energy_costs': 129.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 48.28, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:52:59,724 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 189.56, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.72, 'first_pass_rate': 100.0, 'total_production_cost': 320.4, 'material_costs': 175.0, 'energy_costs': 129.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 48.28, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:00,003 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:00,088 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 189.56, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.19, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.86, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:00,088 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 189.56, 'order_completion_rate': 5.56, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.19, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.86, 'total_orders': 36, 'completed_orders': 2, 'active_orders': 34, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[{"command_id":"flow_53_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}]

Explanation:  
AGV_2 is available at P0 and has no payload. The highest priority is to deliver finished products from QualityCheck (P8). The correct command sequence is to move to P8 so that, upon arrival, AGV_2 may load available finished products. Since AGV_1 is currently busy, only AGV_2 receives a command, and only a MOVE command is permitted as the first step in the finished product transfer process.'
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 516
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[{"command_id":"flow_53_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}]

Explanation:  
AGV_2 is available at P0 and has no payload. The highest priority is to deliv...'
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[{"command_id":"flow_53_agv2_move_to_p8","action":"move","target":"AGV_2","params":{"target_point":"P8"}}]'
2025-07-26 22:53:00,253 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:00,253 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:53:00,253 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line3
2025-07-26 22:53:00,253 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_53_agv2_move_to_p8', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P8'}, 'timestamp': 1753541580.253784}
2025-07-26 22:53:00,254 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_53_agv2_move_to_p8 - move for AGV_2
2025-07-26 22:53:00,355 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:00,355 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:00,356 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:00,356 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:00,460 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 189.56022000000002, 'command_id': 'flow_52_agv1_move_to_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 27.4%'}
2025-07-26 22:53:00,461 - src.line_commander - INFO - [line_commander.py:278] - Command flow_52_agv1_move_to_p8 response: Successfully arrived at path point P8, remaining battery: 27.4%
2025-07-26 22:53:00,774 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_af264427', 'created_at': 190.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 670.0}
2025-07-26 22:53:00,774 - order - INFO - [order.py:245] - Created order order_af264427 with 1 products
2025-07-26 22:53:00,774 - order - INFO - [order.py:339] - Assigned 1 products from order order_af264427 to line2
2025-07-26 22:53:00,774 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_af264427 with 1 products to line2
2025-07-26 22:53:00,893 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 5.41, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.17, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.74, 'total_orders': 37, 'completed_orders': 2, 'active_orders': 35, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,110 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_af264427', 'created_at': 190.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 670.0}
2025-07-26 22:53:01,111 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 5.41, 'average_production_cycle': 3.38, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.17, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.74, 'total_orders': 37, 'completed_orders': 2, 'active_orders': 35, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,112 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d8d755ce', 'created_at': 190.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1270.0}
2025-07-26 22:53:01,112 - order - INFO - [order.py:245] - Created order order_d8d755ce with 2 products
2025-07-26 22:53:01,112 - order - INFO - [order.py:339] - Assigned 2 products from order order_d8d755ce to line3
2025-07-26 22:53:01,112 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_d8d755ce with 2 products to line3
2025-07-26 22:53:01,112 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 5.26, 'average_production_cycle': 3.44, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.17, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.74, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,113 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.15, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.74, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,135 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d8d755ce', 'created_at': 190.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1270.0}
2025-07-26 22:53:01,136 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 5.26, 'average_production_cycle': 3.44, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.17, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.74, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,136 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.0, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.15, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 2.84, 'agv_utilization': 50.74, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,136 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.72, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.97, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.06, 'agv_utilization': 53.25, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,408 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:01,408 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:01,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.72, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.33, 'first_pass_rate': 100.0, 'total_production_cost': 327.31, 'material_costs': 175.0, 'energy_costs': 136.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.06, 'agv_utilization': 53.25, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,819 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.72, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 16.97, 'first_pass_rate': 100.0, 'total_production_cost': 324.31, 'material_costs': 175.0, 'energy_costs': 133.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.06, 'agv_utilization': 53.25, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,820 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:01,821 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 190.72, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.33, 'first_pass_rate': 100.0, 'total_production_cost': 327.31, 'material_costs': 175.0, 'energy_costs': 136.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.06, 'agv_utilization': 53.25, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,943 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 190.71523501501503, 'command_id': 'flow_51.0_agv2_move_p9', 'response': 'Battery level is too low to move to P9, emergency charging'}
2025-07-26 22:53:01,943 - src.line_commander - INFO - [line_commander.py:278] - Command flow_51.0_agv2_move_p9 response: Battery level is too low to move to P9, emergency charging
2025-07-26 22:53:01,944 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 191.56, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.29, 'first_pass_rate': 100.0, 'total_production_cost': 327.31, 'material_costs': 175.0, 'energy_costs': 136.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.0, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:01,944 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 191.56, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.75, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 55.55, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:02,101 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 191.56, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.29, 'first_pass_rate': 100.0, 'total_production_cost': 327.31, 'material_costs': 175.0, 'energy_costs': 136.31, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.0, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:02,559 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 191.56, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.75, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 55.55, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 2}
2025-07-26 22:53:02,560 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 191.56022000000002, 'command_id': 'flow_52_agv2_move_to_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 27.4%'}
2025-07-26 22:53:02,561 - src.line_commander - INFO - [line_commander.py:278] - Command flow_52_agv2_move_to_p8 response: Successfully arrived at path point P8, remaining battery: 27.4%
2025-07-26 22:53:03,675 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:53:03,675 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:04,015 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 193.1889727057057, 'command_id': 'flow_50.0_agv2_charge_80', 'response': 'ÂÖÖÁîµÂÆåÊàêÔºåÂΩìÂâçÁîµÈáè: 80.0%'}
2025-07-26 22:53:04,016 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv2_charge_80 response: ÂÖÖÁîµÂÆåÊàêÔºåÂΩìÂâçÁîµÈáè: 80.0%
2025-07-26 22:53:04,691 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 194.0, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.62, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 54.79, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:04,691 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 194.0, 'order_completion_rate': 5.26, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.62, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 54.79, 'total_orders': 38, 'completed_orders': 2, 'active_orders': 36, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:04,966 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:06,228 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:06,241 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}}
]

Explanation:
AGV_1 is idle at P1, carrying a payload ("prod_1_f6d59d66"), but its battery level is 18.37%, which is below the 20% emergency threshold. According to the decision logic, emergency charging takes absolute priority over delivery or any other actions. Therefore, AGV_1 should be immediately sent to charge up to 80% before proceeding with any further raw material delivery or movement. AGV_2 is still BUSY charging and cannot be assigned a command this step. Only one command is issued (charge for AGV_1) per the rules.'
2025-07-26 22:53:06,242 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:06,242 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 644
2025-07-26 22:53:06,242 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}}
]

Explanation:
AGV_1 is idle at P1, carrying a payload ("prod_1_f6d59d66"), but its batt...'
2025-07-26 22:53:06,243 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:06,243 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}}
]'
2025-07-26 22:53:06,243 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:06,243 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:53:06,243 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:53:06,244 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60.0_agv1_charge_80', 'action': 'charge', 'target': 'AGV_1', 'params': {'target_level': 80}, 'timestamp': 1753541586.243788}
2025-07-26 22:53:06,244 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60.0_agv1_charge_80 - charge for AGV_1
2025-07-26 22:53:06,345 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:06,346 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:06,346 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:53:06,347 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:06,679 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:06,819 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60_agv1_load_p8_finished","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_60_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:  
AGV_1 is at P8 (QualityCheck output) and able to load more finished products‚Äîthis is the highest priority. It should issue a load command to pick up another finished product if available. AGV_2 is at P0 with a raw material payload (prod_3_fc7fe973) and must proceed to P1 for delivery, following the critical rule that AGVs with payload must deliver their cargo before other operations. This maximizes throughput for both outbound and inbound material flows.'
2025-07-26 22:53:06,820 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:06,820 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 693
2025-07-26 22:53:06,820 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60_agv1_load_p8_finished","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_60_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:53:06,820 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:06,820 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60_agv1_load_p8_finished","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_60_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:53:06,820 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:06,820 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:53:06,820 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:53:06,820 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60_agv1_load_p8_finished', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541586.820352}
2025-07-26 22:53:06,820 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60_agv1_load_p8_finished - load for AGV_1
2025-07-26 22:53:06,922 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60_agv2_move_to_p1_with_payload', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541586.921881}
2025-07-26 22:53:06,923 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60_agv2_move_to_p1_with_payload - move for AGV_2
2025-07-26 22:53:07,024 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:07,025 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:07,025 - src.product_flow_agent - WARNING - [product_flow_agent.py:957] - AGV_2 has low battery (27.407956587999998%) but needed for P3 second processing
2025-07-26 22:53:07,025 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:07,026 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:07,169 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_54_agv1_load_p8_finished","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_54_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]

Explanation:  
AGV_1 is at P8 (QualityCheck output) and already carrying one finished product. According to the logic, if there are more finished products in the output buffer (products: 2), AGV_1 should load more before departing. AGV_2 is idle at P0 with a raw material payload and must now deliver it to StationA (P1) as per raw material delivery flow. Thus, AGV_1 receives the LOAD command for more finished products at P8, and AGV_2 receives a MOVE command to P1 to unload its cargo. This dual action maximizes throughput and keeps both materials and finished goods moving efficiently.'
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 810
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_54_agv1_load_p8_finished","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_54_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"targ...'
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_54_agv1_load_p8_finished","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_54_agv2_move_to_p1_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P1"}}
]'
2025-07-26 22:53:07,172 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:07,173 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:53:07,173 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:53:07,173 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_54_agv1_load_p8_finished', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541587.173171}
2025-07-26 22:53:07,173 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_54_agv1_load_p8_finished - load for AGV_1
2025-07-26 22:53:07,275 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_54_agv2_move_to_p1_with_payload', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P1'}, 'timestamp': 1753541587.274731}
2025-07-26 22:53:07,275 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_54_agv2_move_to_p1_with_payload - move for AGV_2
2025-07-26 22:53:09,361 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 198.0, 'command_id': 'flow_60_agv1_load_p8_finished', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_1_fa0a15baÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 26.9%'}
2025-07-26 22:53:09,361 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60_agv1_load_p8_finished response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_1_fa0a15baÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 26.9%
2025-07-26 22:53:10,209 - src.mqtt_listener_manager - WARNING - [mqtt_listener_manager.py:306] - Factory alert: {'timestamp': 199.42107579851552, 'device_id': 'StationC', 'alert_type': 'fault_recovered', 'symptom': 'Station Vibration', 'fault_type': 'unknown', 'estimated_duration': 0.0, 'message': 'Device StationC fault has been automatically recovered'}
2025-07-26 22:53:10,576 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}},
  {"command_id":"flow_60.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:
- AGV_1 is idle at P1, carrying a payload with a battery level of 18.37%, which is below the 20% threshold. Emergency charging takes priority over all other actions. AGV_1 is sent to charge up to 80%.
- AGV_2 is idle at P10, carrying two finished products. Following the workflow, and since AGV_2 is not at the warehouse (P9), it should move to P9 to unload its finished products. 

This keeps both AGVs operating safely and efficiently: AGV_1 prioritizes charging for reliability, and AGV_2 ensures prompt delivery of finished goods. Only one command per AGV, per rules.'
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 805
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}},
  {"command_id":"flow_60.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"tar...'
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}},
  {"command_id":"flow_60.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:53:10,580 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:10,581 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:53:10,581 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:53:10,581 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60.0_agv1_charge_80', 'action': 'charge', 'target': 'AGV_1', 'params': {'target_level': 80}, 'timestamp': 1753541590.581224}
2025-07-26 22:53:10,581 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60.0_agv1_charge_80 - charge for AGV_1
2025-07-26 22:53:10,682 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60.0_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541590.682014}
2025-07-26 22:53:10,682 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60.0_agv2_move_p9 - move for AGV_2
2025-07-26 22:53:10,783 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:10,784 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:10,784 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1']
2025-07-26 22:53:10,784 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:11,078 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d8d54685', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 680.0}
2025-07-26 22:53:11,078 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_d8d54685', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 680.0}
2025-07-26 22:53:11,078 - order - INFO - [order.py:245] - Created order order_d8d54685 with 1 products
2025-07-26 22:53:11,079 - order - INFO - [order.py:339] - Assigned 1 products from order order_d8d54685 to line1
2025-07-26 22:53:11,079 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_d8d54685 with 1 products to line1
2025-07-26 22:53:11,079 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.13, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.32, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 39, 'completed_orders': 2, 'active_orders': 37, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:11,080 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.13, 'average_production_cycle': 3.57, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.32, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 39, 'completed_orders': 2, 'active_orders': 37, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:11,080 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a2d9f012', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 680.0}
2025-07-26 22:53:11,081 - order - INFO - [order.py:245] - Created order order_a2d9f012 with 1 products
2025-07-26 22:53:11,081 - order - INFO - [order.py:339] - Assigned 1 products from order order_a2d9f012 to line2
2025-07-26 22:53:11,081 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_a2d9f012 with 1 products to line2
2025-07-26 22:53:11,519 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.0, 'average_production_cycle': 3.63, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.32, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:11,519 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.3, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:11,519 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.18, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:11,548 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_a2d9f012', 'created_at': 200.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 680.0}
2025-07-26 22:53:11,548 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.0, 'average_production_cycle': 3.63, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.32, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:11,548 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.3, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 1}
2025-07-26 22:53:11,548 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 200.0, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.18, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.09, 'agv_utilization': 53.01, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:11,782 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.1, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.11, 'agv_utilization': 52.54, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:11,782 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.1, 'first_pass_rate': 100.0, 'total_production_cost': 331.22, 'material_costs': 175.0, 'energy_costs': 140.22, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.11, 'agv_utilization': 52.54, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:11,783 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.47, 'first_pass_rate': 100.0, 'total_production_cost': 334.55, 'material_costs': 175.0, 'energy_costs': 143.55, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.11, 'agv_utilization': 54.6, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:11,895 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.47, 'first_pass_rate': 100.0, 'total_production_cost': 334.55, 'material_costs': 175.0, 'energy_costs': 143.55, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 54.6, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:11,895 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.85, 'first_pass_rate': 100.0, 'total_production_cost': 337.88, 'material_costs': 175.0, 'energy_costs': 146.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 56.66, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:12,005 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:12,427 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.47, 'first_pass_rate': 100.0, 'total_production_cost': 334.55, 'material_costs': 175.0, 'energy_costs': 143.55, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.11, 'agv_utilization': 54.6, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:12,427 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.47, 'first_pass_rate': 100.0, 'total_production_cost': 334.55, 'material_costs': 175.0, 'energy_costs': 143.55, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 54.6, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:12,428 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 201.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.85, 'first_pass_rate': 100.0, 'total_production_cost': 337.88, 'material_costs': 175.0, 'energy_costs': 146.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 56.66, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:12,445 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:13,355 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 201.65022, 'command_id': 'flow_52_agv1_move_to_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 23.1%'}
2025-07-26 22:53:13,355 - src.line_commander - INFO - [line_commander.py:278] - Command flow_52_agv1_move_to_p8 response: Successfully arrived at path point P8, remaining battery: 23.1%
2025-07-26 22:53:13,356 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 201.65022, 'command_id': 'flow_52_agv2_move_to_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 23.6%'}
2025-07-26 22:53:13,356 - src.line_commander - INFO - [line_commander.py:278] - Command flow_52_agv2_move_to_p8 response: Successfully arrived at path point P8, remaining battery: 23.6%
2025-07-26 22:53:13,356 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_53.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}},
  {"command_id":"flow_53.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:
- AGV_1 is idle at P1 with a payload and a battery at 18.37%, which is below the emergency threshold of 20%. Per decision logic, emergency charging always takes the highest priority. AGV_1 is immediately instructed to charge to 80%. (Payload will be delivered when charging is complete‚Äîsafety first.)
- AGV_2 is idle at P10, loaded with two finished products. Following CRITICAL FLOW and high-priority delivery, it must move directly to P9 (Warehouse) to unload. Command: move AGV_2 to P9.

Each AGV receives one valid action based on priorities: safety for AGV_1, critical delivery for AGV_2. This keeps the line compliant and safe.'
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 867
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_53.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}},
  {"command_id":"flow_53.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"tar...'
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_53.0_agv1_charge_80","action":"charge","target":"AGV_1","params":{"target_level": 80}},
  {"command_id":"flow_53.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:53:13,359 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:13,359 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:53:13,359 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:53:13,359 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_53.0_agv1_charge_80', 'action': 'charge', 'target': 'AGV_1', 'params': {'target_level': 80}, 'timestamp': 1753541593.359862}
2025-07-26 22:53:13,360 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_53.0_agv1_charge_80 - charge for AGV_1
2025-07-26 22:53:13,461 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_53.0_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541593.461277}
2025-07-26 22:53:13,461 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_53.0_agv2_move_p9 - move for AGV_2
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60_agv1_load_more_finished_p8","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_60_agv2_load_more_finished_p8","action":"load","target":"AGV_2","params":{}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at P8 (QualityCheck output), and both have capacity to load more finished products. There are 2 finished products present, so, following the decision logic and critical flow, both AGVs should immediately attempt to load another finished product. This maximizes shipment efficiency before sending AGVs to the warehouse for unloading. Only "load" commands are given, per sequence rules, as the AGVs must complete loading before being sent to P9.'
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 692
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60_agv1_load_more_finished_p8","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_60_agv2_load_more_finished_p8","action":"load","target":"AGV_2","params":{}}...'
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60_agv1_load_more_finished_p8","action":"load","target":"AGV_1","params":{}},
  {"command_id":"flow_60_agv2_load_more_finished_p8","action":"load","target":"AGV_2","params":{}}
]'
2025-07-26 22:53:13,475 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:13,475 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:53:13,475 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:53:13,475 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60_agv1_load_more_finished_p8', 'action': 'load', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541593.475429}
2025-07-26 22:53:13,475 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60_agv1_load_more_finished_p8 - load for AGV_1
2025-07-26 22:53:13,576 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60_agv2_load_more_finished_p8', 'action': 'load', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541593.57601}
2025-07-26 22:53:13,577 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60_agv2_load_more_finished_p8 - load for AGV_2
2025-07-26 22:53:13,678 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:13,678 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:13,678 - src.product_flow_agent - WARNING - [product_flow_agent.py:957] - AGV_2 has low battery (23.577912587999997%) but needed for P3 second processing
2025-07-26 22:53:13,679 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:13,679 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:14,727 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.5, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.88, 'first_pass_rate': 100.0, 'total_production_cost': 338.88, 'material_costs': 175.0, 'energy_costs': 147.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 55.82, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:15,028 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.7, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.66, 'first_pass_rate': 100.0, 'total_production_cost': 339.88, 'material_costs': 175.0, 'energy_costs': 148.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 55.76, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:15,029 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.65, 'first_pass_rate': 100.0, 'total_production_cost': 339.88, 'material_costs': 175.0, 'energy_costs': 148.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.17, 'agv_utilization': 55.68, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:15,029 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.85, 'first_pass_rate': 100.0, 'total_production_cost': 341.67, 'material_costs': 175.0, 'energy_costs': 150.67, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.17, 'agv_utilization': 56.78, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:15,377 - src.product_flow_agent - WARNING - [product_flow_agent.py:957] - AGV_2 has low battery (23.577912587999997%) but needed for P3 second processing
2025-07-26 22:53:15,378 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:15,379 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:15,450 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 204.0, 'command_id': 'flow_60_agv1_load_more_finished_p8', 'response': 'Can not load. AGV AGV_1 is not available or payload is full.'}
2025-07-26 22:53:15,450 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60_agv1_load_more_finished_p8 response: Can not load. AGV AGV_1 is not available or payload is full.
2025-07-26 22:53:15,451 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.5, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.88, 'first_pass_rate': 100.0, 'total_production_cost': 338.88, 'material_costs': 175.0, 'energy_costs': 147.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 55.82, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:15,451 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.7, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.66, 'first_pass_rate': 100.0, 'total_production_cost': 339.88, 'material_costs': 175.0, 'energy_costs': 148.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.14, 'agv_utilization': 55.76, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:15,451 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.65, 'first_pass_rate': 100.0, 'total_production_cost': 339.88, 'material_costs': 175.0, 'energy_costs': 148.88, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.17, 'agv_utilization': 55.68, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:16,160 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 204.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.85, 'first_pass_rate': 100.0, 'total_production_cost': 341.67, 'material_costs': 175.0, 'energy_costs': 150.67, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.17, 'agv_utilization': 56.78, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:16,161 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 205.0, 'command_id': 'flow_60_agv2_load_more_finished_p8', 'response': 'QualityCheck output_buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß'}
2025-07-26 22:53:16,161 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60_agv2_load_more_finished_p8 response: QualityCheck output_buffer‰∏∫Á©∫ÔºåÊó†Ê≥ïÂèñË¥ß
2025-07-26 22:53:16,555 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:
- AGV_1 is currently in a MOVING state, even though its battery level is critically low (13.96% < 20%). No command can be sent until it becomes idle. Once it is idle, emergency charging will be the next top priority action.
- AGV_2 is idle at P10, carrying two finished products. According to the CRITICAL FLOW and workflow priorities, since AGV_2 is not at P9 (Warehouse), it must first move to P9 to deliver its finished products.

Only one command can be issued to the available AGV, and here AGV_2 is assigned its required next action. The system will issue an emergency charge command to AGV_1 as soon as it is next idle.'
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 750
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:
- AGV_1 is currently in a MOVING state, even though its battery level is cri...'
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60.0_agv2_move_p9","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:53:16,557 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:16,557 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:53:16,557 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:53:16,557 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60.0_agv2_move_p9', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541596.557673}
2025-07-26 22:53:16,557 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60.0_agv2_move_p9 - move for AGV_2
2025-07-26 22:53:16,659 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:53:16,659 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:53:16,659 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1']
2025-07-26 22:53:16,659 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:17,744 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 207.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.71, 'first_pass_rate': 100.0, 'total_production_cost': 341.67, 'material_costs': 175.0, 'energy_costs': 150.67, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 55.98, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:17,744 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 207.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 17.71, 'first_pass_rate': 100.0, 'total_production_cost': 341.67, 'material_costs': 175.0, 'energy_costs': 150.67, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 55.98, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:17,856 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 207.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.08, 'first_pass_rate': 100.0, 'total_production_cost': 345.0, 'material_costs': 175.0, 'energy_costs': 154.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 57.99, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:17,856 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 207.65, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.08, 'first_pass_rate': 100.0, 'total_production_cost': 345.0, 'material_costs': 175.0, 'energy_costs': 154.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 57.99, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:17,857 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 207.65022, 'command_id': 'flow_53_agv2_move_to_p8', 'response': 'Successfully arrived at path point P8, remaining battery: 19.7%'}
2025-07-26 22:53:17,857 - src.line_commander - INFO - [line_commander.py:278] - Command flow_53_agv2_move_to_p8 response: Successfully arrived at path point P8, remaining battery: 19.7%
2025-07-26 22:53:19,756 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.6, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.09, 'first_pass_rate': 100.0, 'total_production_cost': 346.0, 'material_costs': 175.0, 'energy_costs': 155.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 57.41, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:19,757 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.6, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.09, 'first_pass_rate': 100.0, 'total_production_cost': 346.0, 'material_costs': 175.0, 'energy_costs': 155.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 57.41, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:19,905 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:19,951 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.7, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.2, 'first_pass_rate': 100.0, 'total_production_cost': 347.0, 'material_costs': 175.0, 'energy_costs': 156.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 57.38, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:19,952 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.17, 'first_pass_rate': 100.0, 'total_production_cost': 347.0, 'material_costs': 175.0, 'energy_costs': 156.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 57.31, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:19,978 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.7, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.2, 'first_pass_rate': 100.0, 'total_production_cost': 347.0, 'material_costs': 175.0, 'energy_costs': 156.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.19, 'agv_utilization': 57.38, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:20,172 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.36, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.37, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:20,177 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60_agv1_move_to_p9_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_60_agv2_move_to_p9_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:  
Both AGV_1 and AGV_2 are idle at P8 (QualityCheck output) with finished products loaded and QualityCheck is now idle (no products to load). According to the critical flow, AGVs with payload at P8 must promptly deliver to P9 (Warehouse). Sending both AGVs to P9 allows for immediate unloading and keeps the outbound finished goods flow moving efficiently. This also clears the AGVs for the next pick/load cycle. No more load commands are required at P8 for now, as all available finished product payloads are already carried by AGVs.'
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 793
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60_agv1_move_to_p9_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_60_agv2_move_to_p9_with_payload","action":"move","targe...'
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60_agv1_move_to_p9_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_60_agv2_move_to_p9_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:53:20,181 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:20,181 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:53:20,182 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:53:20,182 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60_agv1_move_to_p9_with_payload', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753541600.182308}
2025-07-26 22:53:20,182 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60_agv1_move_to_p9_with_payload - move for AGV_1
2025-07-26 22:53:20,182 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
No command is issued this cycle because AGV_2 is currently in a MOVING state (with finished products, heading to P9) and cannot receive a new instruction until it is idle at its destination. AGV_1 is BUSY charging and also not available for any new command. The next actions will be determined when either AGV becomes idle and available for their next task.'
2025-07-26 22:53:20,182 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:20,182 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 374
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
No command is issued this cycle because AGV_2 is currently in a MOVING state (with finished products, heading to P9) and cannot receive a new instruction until it is idle at its desti...'
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 56, Finished products: 0
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.CHARGING at P10, battery 9.883869081999993%
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.MOVING at P10, battery 80.0%
2025-07-26 22:53:20,183 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:20,183 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1']
2025-07-26 22:53:20,184 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:20,283 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60_agv2_move_to_p9_with_payload', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541600.28382}
2025-07-26 22:53:20,284 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60_agv2_move_to_p9_with_payload - move for AGV_2
2025-07-26 22:53:20,311 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:20,385 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:53:20,385 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:53:20,385 - src.product_flow_agent - WARNING - [product_flow_agent.py:957] - AGV_2 has low battery (23.577912587999997%) but needed for P3 second processing
2025-07-26 22:53:20,386 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:20,386 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:20,695 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.17, 'first_pass_rate': 100.0, 'total_production_cost': 347.0, 'material_costs': 175.0, 'energy_costs': 156.0, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 57.31, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:20,695 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 209.95, 'order_completion_rate': 5.0, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.36, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.37, 'total_orders': 40, 'completed_orders': 2, 'active_orders': 38, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:20,724 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:21,032 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_00dd2ca6', 'created_at': 210.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 810.0}
2025-07-26 22:53:21,032 - order - INFO - [order.py:245] - Created order order_00dd2ca6 with 1 products
2025-07-26 22:53:21,032 - order - INFO - [order.py:339] - Assigned 1 products from order order_00dd2ca6 to line3
2025-07-26 22:53:21,032 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_00dd2ca6 with 1 products to line3
2025-07-26 22:53:21,032 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 4.88, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.36, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.36, 'total_orders': 41, 'completed_orders': 2, 'active_orders': 39, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:21,344 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_abc612d0', 'created_at': 210.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 530.0}
2025-07-26 22:53:21,345 - order - INFO - [order.py:245] - Created order order_abc612d0 with 1 products
2025-07-26 22:53:21,345 - order - INFO - [order.py:339] - Assigned 1 products from order order_abc612d0 to line1
2025-07-26 22:53:21,345 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_abc612d0 with 1 products to line1
2025-07-26 22:53:21,346 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 4.76, 'average_production_cycle': 3.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.36, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.36, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:21,347 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.34, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.36, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:21,564 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:53:21,564 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:21,587 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:22,030 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:22,544 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 211.95, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.12, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.24, 'agv_utilization': 57.79, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:22,545 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 211.95, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.31, 'first_pass_rate': 100.0, 'total_production_cost': 350.58, 'material_costs': 175.0, 'energy_costs': 159.58, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.24, 'agv_utilization': 58.84, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:22,816 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_00dd2ca6', 'created_at': 210.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 810.0}
2025-07-26 22:53:22,816 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 4.88, 'average_production_cycle': 3.69, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.36, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.36, 'total_orders': 41, 'completed_orders': 2, 'active_orders': 39, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:22,816 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_abc612d0', 'created_at': 210.0, 'items': [{'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 530.0}
2025-07-26 22:53:22,982 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:23,316 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 4.76, 'average_production_cycle': 3.75, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.36, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.36, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:23,319 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 210.0, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.34, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.22, 'agv_utilization': 58.36, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:23,319 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 211.95, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.12, 'first_pass_rate': 100.0, 'total_production_cost': 348.79, 'material_costs': 175.0, 'energy_costs': 157.79, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.24, 'agv_utilization': 57.79, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:23,434 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 211.95, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.31, 'first_pass_rate': 100.0, 'total_production_cost': 350.58, 'material_costs': 175.0, 'energy_costs': 159.58, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.24, 'agv_utilization': 58.84, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:23,842 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 213.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.23, 'first_pass_rate': 100.0, 'total_production_cost': 350.58, 'material_costs': 175.0, 'energy_costs': 159.58, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 58.36, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:24,099 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_61_agv1_move_to_p9_with_finished","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_61_agv2_move_to_p9_with_finished","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:  
Both AGVs are idle at P8 (QualityCheck output) and have loaded finished products (AGV_1: 2, AGV_2: 1). According to the critical flow, when AGVs are at P8 with payload, they must immediately move to P9 (Warehouse) to unload finished products. This action clears them for the next loading/unloading cycles and maintains continuous delivery of finished goods to the warehouse, keeping product flow efficient and uninterrupted.'
2025-07-26 22:53:24,100 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:24,100 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 687
2025-07-26 22:53:24,100 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_61_agv1_move_to_p9_with_finished","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_61_agv2_move_to_p9_with_finished","action":"move","tar...'
2025-07-26 22:53:24,100 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:24,100 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_61_agv1_move_to_p9_with_finished","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_61_agv2_move_to_p9_with_finished","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:53:24,100 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:24,100 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:53:24,100 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:53:24,100 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_61_agv1_move_to_p9_with_finished', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753541604.100443}
2025-07-26 22:53:24,100 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_61_agv1_move_to_p9_with_finished - move for AGV_1
2025-07-26 22:53:24,109 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 213.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.23, 'first_pass_rate': 100.0, 'total_production_cost': 350.58, 'material_costs': 175.0, 'energy_costs': 159.58, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 58.36, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:24,202 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_61_agv2_move_to_p9_with_finished', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541604.201808}
2025-07-26 22:53:24,202 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_61_agv2_move_to_p9_with_finished - move for AGV_2
2025-07-26 22:53:24,365 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 213.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.5, 'first_pass_rate': 100.0, 'total_production_cost': 353.1, 'material_costs': 175.0, 'energy_costs': 162.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 60.17, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:24,366 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 213.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.82, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.5, 'first_pass_rate': 100.0, 'total_production_cost': 353.1, 'material_costs': 175.0, 'energy_costs': 162.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 60.17, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 5, 'active_faults': 0}
2025-07-26 22:53:24,390 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:24,506 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:
No command is issued in this cycle because AGV_2 is currently in a MOVING state and cannot receive any new instruction until it arrives and is idle. AGV_1 is BUSY charging and also not available for command assignment. As soon as either AGV becomes idle and available, the system will generate the next appropriate command according to the priority rules.'
2025-07-26 22:53:24,506 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 372
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:
No command is issued in this cycle because AGV_2 is currently in a MOVING state and cannot receive any new instruction until it arrives and is idle. AGV_1 is BUSY charging and also no...'
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 56, Finished products: 0
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.CHARGING at P10, battery 7.093869281999993%
2025-07-26 22:53:24,507 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P9, battery 66.9097805%
2025-07-26 22:53:24,507 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:24,508 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:24,508 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:53:24,508 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:26,089 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 213.5902195, 'command_id': 'flow_60.0_agv2_move_p9', 'response': 'Successfully arrived at path point P9, remaining battery: 66.9%'}
2025-07-26 22:53:26,090 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60.0_agv2_move_p9 response: Successfully arrived at path point P9, remaining battery: 66.9%
2025-07-26 22:53:26,091 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 214.6, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.6, 'first_pass_rate': 100.0, 'total_production_cost': 354.1, 'material_costs': 175.0, 'energy_costs': 163.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 59.87, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,092 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 214.8, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.54, 'first_pass_rate': 100.0, 'total_production_cost': 355.1, 'material_costs': 175.0, 'energy_costs': 164.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 59.81, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,543 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 214.6, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.6, 'first_pass_rate': 100.0, 'total_production_cost': 354.1, 'material_costs': 175.0, 'energy_costs': 163.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 59.87, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,660 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 214.8, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.54, 'first_pass_rate': 100.0, 'total_production_cost': 355.1, 'material_costs': 175.0, 'energy_costs': 164.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.27, 'agv_utilization': 59.81, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,800 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.45, 'first_pass_rate': 100.0, 'total_production_cost': 355.1, 'material_costs': 175.0, 'energy_costs': 164.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.29, 'agv_utilization': 59.29, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,988 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.45, 'first_pass_rate': 100.0, 'total_production_cost': 355.1, 'material_costs': 175.0, 'energy_costs': 164.1, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.29, 'agv_utilization': 59.29, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,989 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.86, 'first_pass_rate': 100.0, 'total_production_cost': 359.01, 'material_costs': 175.0, 'energy_costs': 168.01, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.29, 'agv_utilization': 61.54, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:26,990 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.86, 'first_pass_rate': 100.0, 'total_production_cost': 359.01, 'material_costs': 175.0, 'energy_costs': 168.01, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.32, 'agv_utilization': 61.54, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,095 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.27, 'first_pass_rate': 100.0, 'total_production_cost': 362.93, 'material_costs': 175.0, 'energy_costs': 171.93, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.32, 'agv_utilization': 63.8, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,096 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 216.56022000000002, 'command_id': 'flow_60_agv2_move_to_p1_with_payload', 'response': 'Successfully arrived at path point P1, remaining battery: 15.3%'}
2025-07-26 22:53:27,096 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60_agv2_move_to_p1_with_payload response: Successfully arrived at path point P1, remaining battery: 15.3%
2025-07-26 22:53:27,096 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 216.56022000000002, 'command_id': 'flow_54_agv2_move_to_p1_with_payload', 'response': 'Successfully arrived at path point P1, remaining battery: 10.9%'}
2025-07-26 22:53:27,096 - src.line_commander - INFO - [line_commander.py:278] - Command flow_54_agv2_move_to_p1_with_payload response: Successfully arrived at path point P1, remaining battery: 10.9%
2025-07-26 22:53:27,097 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.27, 'first_pass_rate': 100.0, 'total_production_cost': 362.93, 'material_costs': 175.0, 'energy_costs': 171.93, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.34, 'agv_utilization': 63.79, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,097 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.53, 'first_pass_rate': 100.0, 'total_production_cost': 365.44, 'material_costs': 175.0, 'energy_costs': 174.44, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.34, 'agv_utilization': 65.57, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,098 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.52, 'first_pass_rate': 100.0, 'total_production_cost': 365.44, 'material_costs': 175.0, 'energy_costs': 174.44, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.37, 'agv_utilization': 65.47, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,098 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.62, 'first_pass_rate': 100.0, 'total_production_cost': 366.42, 'material_costs': 175.0, 'energy_costs': 175.42, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.37, 'agv_utilization': 66.04, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,206 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.62, 'first_pass_rate': 100.0, 'total_production_cost': 366.42, 'material_costs': 175.0, 'energy_costs': 175.42, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.39, 'agv_utilization': 66.04, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,509 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.86, 'first_pass_rate': 100.0, 'total_production_cost': 359.01, 'material_costs': 175.0, 'energy_costs': 168.01, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.29, 'agv_utilization': 61.54, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,510 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.86, 'first_pass_rate': 100.0, 'total_production_cost': 359.01, 'material_costs': 175.0, 'energy_costs': 168.01, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.32, 'agv_utilization': 61.54, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,511 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.56, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.27, 'first_pass_rate': 100.0, 'total_production_cost': 362.93, 'material_costs': 175.0, 'energy_costs': 171.93, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.32, 'agv_utilization': 63.8, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,620 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.27, 'first_pass_rate': 100.0, 'total_production_cost': 362.93, 'material_costs': 175.0, 'energy_costs': 171.93, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.34, 'agv_utilization': 63.79, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,621 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.53, 'first_pass_rate': 100.0, 'total_production_cost': 365.44, 'material_costs': 175.0, 'energy_costs': 174.44, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.34, 'agv_utilization': 65.57, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,621 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 216.5902195, 'command_id': 'flow_53.0_agv2_move_p9', 'response': 'Successfully arrived at path point P9, remaining battery: 53.8%'}
2025-07-26 22:53:27,621 - src.line_commander - INFO - [line_commander.py:278] - Command flow_53.0_agv2_move_p9 response: Successfully arrived at path point P9, remaining battery: 53.8%
2025-07-26 22:53:27,621 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.52, 'first_pass_rate': 100.0, 'total_production_cost': 365.44, 'material_costs': 175.0, 'energy_costs': 174.44, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.37, 'agv_utilization': 65.47, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,621 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.62, 'first_pass_rate': 100.0, 'total_production_cost': 366.42, 'material_costs': 175.0, 'energy_costs': 175.42, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.37, 'agv_utilization': 66.04, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:27,622 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.62, 'first_pass_rate': 100.0, 'total_production_cost': 366.42, 'material_costs': 175.0, 'energy_costs': 175.42, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.39, 'agv_utilization': 66.04, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:28,035 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.72, 'first_pass_rate': 100.0, 'total_production_cost': 367.4, 'material_costs': 175.0, 'energy_costs': 176.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.39, 'agv_utilization': 66.6, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:28,036 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 216.88999939, 'command_id': 'flow_60_agv1_move_to_p9_with_payload', 'response': 'Successfully arrived at path point P9, remaining battery: 21.6%'}
2025-07-26 22:53:28,036 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60_agv1_move_to_p9_with_payload response: Successfully arrived at path point P9, remaining battery: 21.6%
2025-07-26 22:53:28,036 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 216.88999939, 'command_id': 'flow_60_agv2_move_to_p9_with_payload', 'response': 'Successfully arrived at path point P9, remaining battery: 9.4%'}
2025-07-26 22:53:28,036 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60_agv2_move_to_p9_with_payload response: Successfully arrived at path point P9, remaining battery: 9.4%
2025-07-26 22:53:28,062 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 216.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.72, 'first_pass_rate': 100.0, 'total_production_cost': 367.4, 'material_costs': 175.0, 'energy_costs': 176.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.39, 'agv_utilization': 66.6, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:28,720 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:28,723 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_61_agv1_move_to_p9_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_61_agv2_move_to_p9_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]

Explanation:  
Both AGVs are idle at P8 (QualityCheck output) and each is carrying finished products (AGV_1: 2; AGV_2: 1). The highest-priority action is to move these AGVs to P9 (Warehouse) for unloading. This prioritizes finished goods transfer per critical flow: whenever an AGV at P8 has payload, it should be sent to P9 immediately. This keeps warehouse product throughput high and ensures AGVs will soon be available for new raw material/order handling.'
2025-07-26 22:53:28,723 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:28,723 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 705
2025-07-26 22:53:28,724 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_61_agv1_move_to_p9_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_61_agv2_move_to_p9_with_payload","action":"move","targe...'
2025-07-26 22:53:28,724 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:28,724 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_61_agv1_move_to_p9_with_payload","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_61_agv2_move_to_p9_with_payload","action":"move","target":"AGV_2","params":{"target_point":"P9"}}
]'
2025-07-26 22:53:28,724 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:28,724 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line3
2025-07-26 22:53:28,724 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line3
2025-07-26 22:53:28,724 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_61_agv1_move_to_p9_with_payload', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753541608.724302}
2025-07-26 22:53:28,724 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_61_agv1_move_to_p9_with_payload - move for AGV_1
2025-07-26 22:53:28,810 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 218.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.61, 'first_pass_rate': 100.0, 'total_production_cost': 367.4, 'material_costs': 175.0, 'energy_costs': 176.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.42, 'agv_utilization': 65.95, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:28,811 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 218.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.61, 'first_pass_rate': 100.0, 'total_production_cost': 367.4, 'material_costs': 175.0, 'energy_costs': 176.4, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.42, 'agv_utilization': 65.95, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:28,825 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_61_agv2_move_to_p9_with_payload', 'action': 'move', 'target': 'AGV_2', 'params': {'target_point': 'P9'}, 'timestamp': 1753541608.825749}
2025-07-26 22:53:28,826 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_61_agv2_move_to_p9_with_payload - move for AGV_2
2025-07-26 22:53:28,925 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 218.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.71, 'first_pass_rate': 100.0, 'total_production_cost': 368.38, 'material_costs': 175.0, 'energy_costs': 177.38, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.42, 'agv_utilization': 66.51, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:28,927 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:28,927 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:28,927 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.IDLE, battery: 9.945780709999996%)
2025-07-26 22:53:28,927 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:28,928 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:53:29,088 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 218.88999939, 'command_id': 'flow_61_agv1_move_to_p9_with_finished', 'response': 'Successfully arrived at path point P9, remaining battery: 20.1%'}
2025-07-26 22:53:29,088 - src.line_commander - INFO - [line_commander.py:278] - Command flow_61_agv1_move_to_p9_with_finished response: Successfully arrived at path point P9, remaining battery: 20.1%
2025-07-26 22:53:29,089 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:29,262 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 218.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.71, 'first_pass_rate': 100.0, 'total_production_cost': 368.38, 'material_costs': 175.0, 'energy_costs': 177.38, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.42, 'agv_utilization': 66.51, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:29,719 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:29,812 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 219.0, 'command_id': 'flow_61_agv1_move_to_p9_with_payload', 'response': 'Can not find path from P9 to P9'}
2025-07-26 22:53:29,812 - src.line_commander - INFO - [line_commander.py:278] - Command flow_61_agv1_move_to_p9_with_payload response: Can not find path from P9 to P9
2025-07-26 22:53:29,813 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.67, 'first_pass_rate': 100.0, 'total_production_cost': 368.38, 'material_costs': 175.0, 'energy_costs': 177.38, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.44, 'agv_utilization': 66.28, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:29,813 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.67, 'first_pass_rate': 100.0, 'total_production_cost': 368.38, 'material_costs': 175.0, 'energy_costs': 177.38, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.44, 'agv_utilization': 66.28, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:29,814 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.93, 'first_pass_rate': 100.0, 'total_production_cost': 370.9, 'material_costs': 175.0, 'energy_costs': 179.9, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.44, 'agv_utilization': 68.03, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:29,814 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.59, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.93, 'first_pass_rate': 100.0, 'total_production_cost': 370.9, 'material_costs': 175.0, 'energy_costs': 179.9, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.44, 'agv_utilization': 68.03, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:29,814 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.92, 'first_pass_rate': 100.0, 'total_production_cost': 370.9, 'material_costs': 175.0, 'energy_costs': 179.9, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 67.93, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
AGV_2 is idle at P9 (Warehouse) with a payload of two finished products ("prod_1_495dbb33" and "prod_2_de59ee53"). According to the workflow, when an AGV with a payload arrives at the warehouse (P9), it must immediately unload. AGV_1 is still charging and not available for assignment. Therefore, AGV_2 receives the unload command at P9 to promptly complete delivery of finished goods. Only one command is issued because only one AGV is available for a new action.'
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 573
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
AGV_2 is idle at P9 (Warehouse) with a payload of two finished products ("prod_1_495dbb33" ...'
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:53:29,848 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:29,848 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:53:29,848 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:53:29,848 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60.0_agv2_unload_p9', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541609.84874}
2025-07-26 22:53:29,848 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60.0_agv2_unload_p9 - unload for AGV_2
2025-07-26 22:53:29,950 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:53:29,950 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:53:29,950 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:53:29,950 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:29,983 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.02, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.49, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:30,132 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 219.5902195, 'command_id': 'flow_60.0_agv2_move_p9', 'response': 'Successfully arrived at path point P9, remaining battery: 40.7%'}
2025-07-26 22:53:30,132 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60.0_agv2_move_p9 response: Successfully arrived at path point P9, remaining battery: 40.7%
2025-07-26 22:53:30,133 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.92, 'first_pass_rate': 100.0, 'total_production_cost': 370.9, 'material_costs': 175.0, 'energy_costs': 179.9, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 67.93, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:30,244 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 219.89, 'order_completion_rate': 4.76, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.02, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.49, 'total_orders': 42, 'completed_orders': 2, 'active_orders': 40, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:30,415 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 219.88999939, 'command_id': 'flow_61_agv2_move_to_p9_with_finished', 'response': 'Successfully arrived at path point P9, remaining battery: 8.0%'}
2025-07-26 22:53:30,415 - src.line_commander - INFO - [line_commander.py:278] - Command flow_61_agv2_move_to_p9_with_finished response: Successfully arrived at path point P9, remaining battery: 8.0%
2025-07-26 22:53:30,678 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:31,301 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_f5ba618f', 'created_at': 220.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 820.0}
2025-07-26 22:53:31,302 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_f5ba618f', 'created_at': 220.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 820.0}
2025-07-26 22:53:31,302 - order - INFO - [order.py:245] - Created order order_f5ba618f with 1 products
2025-07-26 22:53:31,303 - order - INFO - [order.py:339] - Assigned 1 products from order order_f5ba618f to line2
2025-07-26 22:53:31,303 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_f5ba618f with 1 products to line2
2025-07-26 22:53:31,304 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 4.65, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.01, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.45, 'total_orders': 43, 'completed_orders': 2, 'active_orders': 41, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:31,304 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 4.65, 'average_production_cycle': 3.18, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.01, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.45, 'total_orders': 43, 'completed_orders': 2, 'active_orders': 41, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:31,549 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:32,305 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.IDLE, battery: 9.945780709999996%)
2025-07-26 22:53:32,305 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:32,305 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1', 'P2']
2025-07-26 22:53:33,642 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8b9c9218', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1780.0}
2025-07-26 22:53:33,642 - order - INFO - [order.py:245] - Created order order_8b9c9218 with 3 products
2025-07-26 22:53:33,643 - order - INFO - [order.py:339] - Assigned 3 products from order order_8b9c9218 to line3
2025-07-26 22:53:33,643 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_8b9c9218 with 3 products to line3
2025-07-26 22:53:33,643 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 4.55, 'average_production_cycle': 3.23, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.01, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.45, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:33,644 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 4.55, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.0, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.45, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:34,462 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[]

Explanation:  
Although two actions are needed, no commands can be issued at this step because AGV_2 is in a MOVING state (on its way to deliver finished products to P9) and AGV_1 is BUSY charging (battery < 20%). Per the rules, commands can only be sent to AGVs that are idle and available for new actions. The next commands will be generated once either AGV completes its current operation and becomes idle.'
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 413
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[]

Explanation:  
Although two actions are needed, no commands can be issued at this step because AGV_2 is in a MOVING state (on its way to deliver finished products to P9) and AGV_1 is BUSY charging...'
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[]'
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:800] - No commands in parsed output
2025-07-26 22:53:34,467 - src.product_flow_agent - INFO - [product_flow_agent.py:801] - Parsed data was: []
2025-07-26 22:53:34,468 - src.product_flow_agent - INFO - [product_flow_agent.py:186] - No commands generated - no action needed for this line
2025-07-26 22:53:34,468 - src.product_flow_agent - INFO - [product_flow_agent.py:197] - Factory summary: Raw materials: 58, Finished products: 0
2025-07-26 22:53:34,468 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_1: DeviceStatus.CHARGING at P10, battery 7.093869281999993%
2025-07-26 22:53:34,468 - src.product_flow_agent - INFO - [product_flow_agent.py:204] - AGV_2: DeviceStatus.IDLE at P9, battery 66.9097805%
2025-07-26 22:53:35,374 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:35,376 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:36,431 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_60.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
AGV_2 is idle at P9 (Warehouse) and still loaded with two finished products. According to the critical flow rules, if an AGV with payload is at the warehouse, it must immediately unload. AGV_1 is busy charging and cannot receive a new command. Therefore, AGV_2 is commanded to unload at P9, ensuring fast and efficient completion of finished product delivery. Only one command issued because only one AGV is available.'
2025-07-26 22:53:36,431 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:36,431 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 527
2025-07-26 22:53:36,431 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_60.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
AGV_2 is idle at P9 (Warehouse) and still loaded with two finished products. According to t...'
2025-07-26 22:53:36,431 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:36,431 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_60.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:53:36,432 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:36,432 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:53:36,432 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:53:36,432 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_60.0_agv2_unload_p9', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541616.432307}
2025-07-26 22:53:36,433 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_60.0_agv2_unload_p9 - unload for AGV_2
2025-07-26 22:53:36,534 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:36,534 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:36,534 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:53:36,534 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:36,571 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 224.0, 'command_id': 'flow_50.0_agv2_load_finished_p8', 'response': 'Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_ee0e250fÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 40.2%'}
2025-07-26 22:53:36,571 - src.line_commander - INFO - [line_commander.py:278] - Command flow_50.0_agv2_load_finished_p8 response: Â∑≤‰ªéQualityCheck output_bufferÂèñÂá∫‰∫ßÂìÅprod_2_ee0e250fÂπ∂Ë£ÖËΩΩÂà∞AGVÔºåÂâ©‰ΩôÁîµÈáè: 40.2%
2025-07-26 22:53:36,571 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 225.0, 'command_id': 'flow_60.0_agv2_unload_p9', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_1_495dbb33Âç∏ËΩΩÂà∞WarehouseÔºåÂâ©‰ΩôÁîµÈáè: 39.7%'}
2025-07-26 22:53:36,571 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60.0_agv2_unload_p9 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_1_495dbb33Âç∏ËΩΩÂà∞WarehouseÔºåÂâ©‰ΩôÁîµÈáè: 39.7%
2025-07-26 22:53:36,571 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 225.47, 'order_completion_rate': 4.55, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.58, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 68.64, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:36,571 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 225.47, 'order_completion_rate': 4.55, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.12, 'first_pass_rate': 100.0, 'total_production_cost': 375.98, 'material_costs': 175.0, 'energy_costs': 184.98, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 68.64, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:36,665 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 225.46835669309309, 'command_id': 'flow_60.0_agv1_charge_80', 'response': 'ÂÖÖÁîµÂÆåÊàêÔºåÂΩìÂâçÁîµÈáè: 80.0%'}
2025-07-26 22:53:36,665 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60.0_agv1_charge_80 response: ÂÖÖÁîµÂÆåÊàêÔºåÂΩìÂâçÁîµÈáè: 80.0%
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[{"command_id":"flow_61_agv1_unload_at_p9","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is currently at P9 (Warehouse) with a payload of two finished products. Per the decision logic and critical flow, an AGV at the warehouse with finished product must unload immediately. AGV_2 is unavailable for additional commands since it is busy/charging and also requires attention for low battery (below 20%). Only AGV_1 receives an unload command as it is the only available AGV for the current cycle.'
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 519
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[{"command_id":"flow_61_agv1_unload_at_p9","action":"unload","target":"AGV_1","params":{}}]

Explanation:  
AGV_1 is currently at P9 (Warehouse) with a payload of two finished products. Per the decisi...'
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[{"command_id":"flow_61_agv1_unload_at_p9","action":"unload","target":"AGV_1","params":{}}]'
2025-07-26 22:53:37,108 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:37,109 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line3
2025-07-26 22:53:37,109 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line3
2025-07-26 22:53:37,109 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_61_agv1_unload_at_p9', 'action': 'unload', 'target': 'AGV_1', 'params': {}, 'timestamp': 1753541617.109139}
2025-07-26 22:53:37,109 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_61_agv1_unload_at_p9 - unload for AGV_1
2025-07-26 22:53:37,211 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:37,211 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:37,212 - src.product_flow_agent - WARNING - [product_flow_agent.py:963] - AGV_2 not available for P3 second processing (status: DeviceStatus.IDLE, battery: 9.945780709999996%)
2025-07-26 22:53:37,212 - src.product_flow_agent - WARNING - [product_flow_agent.py:504] - P3 products found in lower_buffer: ['prod_3_63af60ae'] - this is unusual!
2025-07-26 22:53:37,212 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line3 needs product types: ['P3', 'P1', 'P1', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P2', 'P1', 'P2', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1', 'P2', 'P1']
2025-07-26 22:53:37,844 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:37,997 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 227.0, 'command_id': 'flow_60.0_agv2_unload_p9', 'response': 'Â∑≤Â∞Ü‰∫ßÂìÅprod_2_de59ee53Âç∏ËΩΩÂà∞WarehouseÔºåÂâ©‰ΩôÁîµÈáè: 39.2%'}
2025-07-26 22:53:37,997 - src.line_commander - INFO - [line_commander.py:278] - Command flow_60.0_agv2_unload_p9 response: Â∑≤Â∞Ü‰∫ßÂìÅprod_2_de59ee53Âç∏ËΩΩÂà∞WarehouseÔºåÂâ©‰ΩôÁîµÈáè: 39.2%
2025-07-26 22:53:38,874 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:40,831 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_70.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
AGV_2 is idle at P9 (Warehouse) with a payload of two products ("prod_2_de59ee53" and "prod_2_ee0e250f"). According to the plant workflow and critical flow rules, any AGV at P9 with a payload should immediately unload. AGV_1 is still BUSY charging and cannot accept commands. Only AGV_2 can receive a command, so it is instructed to unload at P9 to promptly deliver its cargo and maintain production flow.'
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 514
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_70.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
AGV_2 is idle at P9 (Warehouse) with a payload of two products ("prod_2_de59ee53" and "prod...'
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_70.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:53:40,860 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 1 commands for available AGVs
2025-07-26 22:53:40,860 - src.line_commander - INFO - [line_commander.py:395] - Generated 1 commands for available AGVs for for line1
2025-07-26 22:53:40,860 - src.line_commander - INFO - [line_commander.py:413] - Executing 1 commands for different AGVs for line1
2025-07-26 22:53:40,860 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_70.0_agv2_unload_p9', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541620.860595}
2025-07-26 22:53:40,860 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_70.0_agv2_unload_p9 - unload for AGV_2
2025-07-26 22:53:40,961 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: new_order (severity: high)
2025-07-26 22:53:40,961 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: new_order (severity: high)
2025-07-26 22:53:40,961 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1']
2025-07-26 22:53:40,961 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:42,343 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_6bf95337', 'created_at': 230.0, 'items': [{'product_type': 'P2', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 830.0}
2025-07-26 22:53:42,344 - order - INFO - [order.py:245] - Created order order_6bf95337 with 1 products
2025-07-26 22:53:42,344 - order - INFO - [order.py:339] - Assigned 1 products from order order_6bf95337 to line1
2025-07-26 22:53:42,345 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_6bf95337 with 1 products to line1
2025-07-26 22:53:42,345 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 4.44, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.88, 'first_pass_rate': 100.0, 'total_production_cost': 375.98, 'material_costs': 175.0, 'energy_costs': 184.98, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 67.16, 'total_orders': 45, 'completed_orders': 2, 'active_orders': 43, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:42,469 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1', 'P2']
2025-07-26 22:53:42,470 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:42,829 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_62886fa9', 'created_at': 230.0, 'items': [{'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.MEDIUM: 'medium'>, 'deadline': 1270.0}
2025-07-26 22:53:42,829 - order - INFO - [order.py:245] - Created order order_62886fa9 with 3 products
2025-07-26 22:53:42,829 - order - INFO - [order.py:339] - Assigned 3 products from order order_62886fa9 to line2
2025-07-26 22:53:42,829 - shared_order_manager - INFO - [shared_order_manager.py:67] - Assigned order order_62886fa9 with 3 products to line2
2025-07-26 22:53:43,607 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 4.35, 'average_production_cycle': 3.39, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.88, 'first_pass_rate': 100.0, 'total_production_cost': 375.98, 'material_costs': 175.0, 'energy_costs': 184.98, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 67.16, 'total_orders': 46, 'completed_orders': 2, 'active_orders': 44, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:43,608 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 230.0, 'order_completion_rate': 4.35, 'average_production_cycle': 3.49, 'on_time_delivery_rate': 100.0, 'device_utilization': 18.87, 'first_pass_rate': 100.0, 'total_production_cost': 375.98, 'material_costs': 175.0, 'energy_costs': 184.98, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 67.16, 'total_orders': 46, 'completed_orders': 2, 'active_orders': 44, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:45,336 - httpx - INFO - [_client.py:1740] - HTTP Request: POST https://api.openai.com/v1/responses "HTTP/1.1 200 OK"
2025-07-26 22:53:45,367 - src.product_flow_agent - INFO - [product_flow_agent.py:171] - Raw AI output: '[
  {"command_id":"flow_70.0_agv1_move_p9","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_70.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]

Explanation:
- AGV_1 is idle at P10 with a payload ("prod_1_f6d59d66"). According to the workflow and CRITICAL PRIORITY, a loaded AGV must complete delivery immediately. Since AGV_1 is not at the warehouse (P9), the first step is for it to move to P9.
- AGV_2 is idle at P9 with a payload of one product ("prod_2_ee0e250f"). When an AGV with load is at the warehouse (P9), it must immediately unload. AGV_2 is thus instructed to unload at P9.

This combo keeps finished product/material logistics moving and strictly follows the sequence and critical delivery priorities. Each AGV gets exactly one appropriate command.'
2025-07-26 22:53:45,367 - src.product_flow_agent - INFO - [product_flow_agent.py:172] - AI output type: <class 'str'>
2025-07-26 22:53:45,368 - src.product_flow_agent - INFO - [product_flow_agent.py:173] - AI output length: 821
2025-07-26 22:53:45,368 - src.product_flow_agent - INFO - [product_flow_agent.py:768] - Attempting to parse string output: '[
  {"command_id":"flow_70.0_agv1_move_p9","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_70.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
...'
2025-07-26 22:53:45,368 - src.product_flow_agent - INFO - [product_flow_agent.py:782] - Extracting JSON from mixed content
2025-07-26 22:53:45,368 - src.product_flow_agent - INFO - [product_flow_agent.py:787] - Extracted JSON: '[
  {"command_id":"flow_70.0_agv1_move_p9","action":"move","target":"AGV_1","params":{"target_point":"P9"}},
  {"command_id":"flow_70.0_agv2_unload_p9","action":"unload","target":"AGV_2","params":{}}
]'
2025-07-26 22:53:45,368 - src.product_flow_agent - INFO - [product_flow_agent.py:183] - Generated 2 commands for available AGVs
2025-07-26 22:53:45,368 - src.line_commander - INFO - [line_commander.py:395] - Generated 2 commands for available AGVs for for line1
2025-07-26 22:53:45,368 - src.line_commander - INFO - [line_commander.py:413] - Executing 2 commands for different AGVs for line1
2025-07-26 22:53:45,368 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_70.0_agv1_move_p9', 'action': 'move', 'target': 'AGV_1', 'params': {'target_point': 'P9'}, 'timestamp': 1753541625.368353}
2025-07-26 22:53:45,368 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_70.0_agv1_move_p9 - move for AGV_1
2025-07-26 22:53:45,402 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:45,470 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:418] - Published command: {'command_id': 'flow_70.0_agv2_unload_p9', 'action': 'unload', 'target': 'AGV_2', 'params': {}, 'timestamp': 1753541625.469878}
2025-07-26 22:53:45,471 - src.line_commander - INFO - [line_commander.py:439] - Executed command: flow_70.0_agv2_unload_p9 - unload for AGV_2
2025-07-26 22:53:45,572 - src.line_commander - INFO - [line_commander.py:375] - Processing reactive event: raw_materials_available (severity: high)
2025-07-26 22:53:45,573 - src.product_flow_agent - INFO - [product_flow_agent.py:148] - Processing reactive event in ProductFlowAgent: raw_materials_available (severity: high)
2025-07-26 22:53:45,573 - src.product_flow_agent - INFO - [product_flow_agent.py:652] - Line line1 needs product types: ['P1', 'P2', 'P3', 'P3', 'P1', 'P3', 'P2', 'P3', 'P1', 'P1', 'P3', 'P1', 'P1', 'P3', 'P2', 'P1', 'P3', 'P1', 'P2', 'P2', 'P1', 'P1', 'P2', 'P1', 'P1', 'P1', 'P2']
2025-07-26 22:53:45,573 - src.product_flow_agent - INFO - [product_flow_agent.py:676] - Line line1 still needs ['P3'] but no matching raw materials found
2025-07-26 22:53:45,860 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:46,714 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
2025-07-26 22:53:46,892 - __main__ - INFO - [main.py:207] - Received signal 2, initiating shutdown...
2025-07-26 22:53:46,993 - __main__ - INFO - [main.py:136] - Initiating graceful shutdown of all production lines...
2025-07-26 22:53:46,994 - __main__ - INFO - [main.py:144] - Stopping line1...
2025-07-26 22:53:46,994 - src.utils.mqtt_client - INFO - [mqtt_client.py:73] - Disconnecting from MQTT Broker.
2025-07-26 22:53:51,101 - src.utils.mqtt_client - WARNING - [mqtt_client.py:40] - Disconnected from MQTT Broker with reason code: 0. Reconnecting...
2025-07-26 22:53:51,101 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:428] - MQTT listener manager stopped
2025-07-26 22:53:51,101 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line1 stopped
2025-07-26 22:53:51,101 - __main__ - INFO - [main.py:146] - ‚úÖ line1 stopped
2025-07-26 22:53:51,101 - __main__ - INFO - [main.py:144] - Stopping line2...
2025-07-26 22:53:51,101 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line2 stopped
2025-07-26 22:53:51,101 - __main__ - INFO - [main.py:146] - ‚úÖ line2 stopped
2025-07-26 22:53:51,101 - __main__ - INFO - [main.py:144] - Stopping line3...
2025-07-26 22:53:51,101 - src.utils.mqtt_client - INFO - [mqtt_client.py:73] - Disconnecting from MQTT Broker.
2025-07-26 22:53:52,960 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:326] - New order received: {'order_id': 'order_8b9c9218', 'created_at': 220.0, 'items': [{'product_type': 'P1', 'quantity': 1}, {'product_type': 'P2', 'quantity': 1}, {'product_type': 'P1', 'quantity': 1}], 'priority': <OrderPriority.LOW: 'low'>, 'deadline': 1780.0}
2025-07-26 22:53:52,961 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 4.55, 'average_production_cycle': 3.23, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.01, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.45, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:52,962 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 220.0, 'order_completion_rate': 4.55, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 20.0, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 1.47, 'agv_utilization': 68.45, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:52,962 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:345] - Command response: {'timestamp': 224.0, 'command_id': 'flow_61_agv2_move_to_p9_with_payload', 'response': 'Can not find path from P9 to P9'}
2025-07-26 22:53:52,963 - src.line_commander - INFO - [line_commander.py:278] - Command flow_61_agv2_move_to_p9_with_payload response: Can not find path from P9 to P9
2025-07-26 22:53:52,963 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 225.47, 'order_completion_rate': 4.55, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.58, 'first_pass_rate': 100.0, 'total_production_cost': 371.87, 'material_costs': 175.0, 'energy_costs': 180.87, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 68.64, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:55,499 - __main__ - INFO - [main.py:207] - Received signal 2, initiating shutdown...
2025-07-26 22:53:56,362 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:364] - KPI update: {'timestamp': 225.47, 'order_completion_rate': 4.55, 'average_production_cycle': 3.34, 'on_time_delivery_rate': 100.0, 'device_utilization': 19.12, 'first_pass_rate': 100.0, 'total_production_cost': 375.98, 'material_costs': 175.0, 'energy_costs': 184.98, 'maintenance_costs': 16.0, 'scrap_costs': 0.0, 'charge_strategy_efficiency': 100.0, 'agv_energy_efficiency': 0.94, 'agv_utilization': 68.64, 'total_orders': 44, 'completed_orders': 2, 'active_orders': 42, 'total_products': 6, 'active_faults': 0}
2025-07-26 22:53:56,364 - src.utils.mqtt_client - WARNING - [mqtt_client.py:40] - Disconnected from MQTT Broker with reason code: 0. Reconnecting...
2025-07-26 22:53:56,364 - src.mqtt_listener_manager - INFO - [mqtt_listener_manager.py:428] - MQTT listener manager stopped
2025-07-26 22:53:56,364 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line3 stopped
2025-07-26 22:53:56,365 - __main__ - INFO - [main.py:146] - ‚úÖ line3 stopped
2025-07-26 22:53:56,365 - __main__ - INFO - [main.py:152] - Cancelling 2 running tasks...
2025-07-26 22:53:56,365 - __main__ - INFO - [main.py:136] - Initiating graceful shutdown of all production lines...
2025-07-26 22:53:56,365 - __main__ - INFO - [main.py:144] - Stopping line1...
2025-07-26 22:53:56,365 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line1 stopped
2025-07-26 22:53:56,366 - __main__ - INFO - [main.py:146] - ‚úÖ line1 stopped
2025-07-26 22:53:56,366 - __main__ - INFO - [main.py:144] - Stopping line2...
2025-07-26 22:53:56,366 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line2 stopped
2025-07-26 22:53:56,366 - __main__ - INFO - [main.py:146] - ‚úÖ line2 stopped
2025-07-26 22:53:56,366 - __main__ - INFO - [main.py:144] - Stopping line3...
2025-07-26 22:53:56,366 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line3 stopped
2025-07-26 22:53:56,366 - __main__ - INFO - [main.py:146] - ‚úÖ line3 stopped
2025-07-26 22:53:56,366 - __main__ - INFO - [main.py:152] - Cancelling 2 running tasks...
2025-07-26 22:53:56,371 - __main__ - INFO - [main.py:136] - Initiating graceful shutdown of all production lines...
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:144] - Stopping line1...
2025-07-26 22:53:56,372 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line1 stopped
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:146] - ‚úÖ line1 stopped
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:144] - Stopping line2...
2025-07-26 22:53:56,372 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line2 stopped
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:146] - ‚úÖ line2 stopped
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:144] - Stopping line3...
2025-07-26 22:53:56,372 - src.line_commander - INFO - [line_commander.py:453] - Line Commander line3 stopped
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:146] - ‚úÖ line3 stopped
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:152] - Cancelling 2 running tasks...
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:163] - üõë All production lines have been shut down
2025-07-26 22:53:56,372 - __main__ - INFO - [main.py:163] - üõë All production lines have been shut down
2025-07-26 22:53:56,373 - __main__ - INFO - [main.py:163] - üõë All production lines have been shut down
2025-07-26 22:53:58,443 - httpx - INFO - [_client.py:1025] - HTTP Request: POST https://api.openai.com/v1/traces/ingest "HTTP/1.1 204 No Content"
